<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-12-06T15:22:31.834Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Javaè®¾è®¡æ¨¡å¼</title>
    <link href="http://example.com/2021/12/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    <id>http://example.com/2021/12/01/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/</id>
    <published>2021-11-30T16:02:17.000Z</published>
    <updated>2021-12-06T15:22:31.834Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Javaè®¾è®¡æ¨¡å¼å­¦ä¹ "><a href="#Javaè®¾è®¡æ¨¡å¼å­¦ä¹ " class="headerlink" title="Javaè®¾è®¡æ¨¡å¼å­¦ä¹ "></a>Javaè®¾è®¡æ¨¡å¼å­¦ä¹ </h2><h2 id="åˆ›å»ºå‹æ¨¡å¼"><a href="#åˆ›å»ºå‹æ¨¡å¼" class="headerlink" title="åˆ›å»ºå‹æ¨¡å¼"></a>åˆ›å»ºå‹æ¨¡å¼</h2><h3 id="ç®€å•å·¥å‚æ¨¡å¼"><a href="#ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="ç®€å•å·¥å‚æ¨¡å¼"></a>ç®€å•å·¥å‚æ¨¡å¼</h3><p>ç®€å•å·¥å‚æ¨¡å¼ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´ï¼Œå¹¶ä¸å±äºè®¾è®¡æ¨¡å¼ä¸­çš„ä¸€ç§ï¼Œä¸è¿‡è¿™é‡Œè¿˜æ˜¯ç®€å•è®°å½•ä¸‹ã€‚</p><p><strong>å®šä¹‰</strong>ï¼šç”±ä¸€ä¸ªå·¥å‚å¯¹è±¡å†³å®šåˆ›å»ºå‡ºå“ªä¸€ç§ç±»å‹å®ä¾‹ã€‚å®¢æˆ·ç«¯åªéœ€ä¼ å…¥å·¥å‚ç±»çš„å‚æ•°ï¼Œæ— å¿ƒå…³å¿ƒåˆ›å»ºè¿‡ç¨‹ã€‚</p><p><strong>ä¼˜ç‚¹</strong>ï¼šå…·ä½“äº§å“ä»å®¢æˆ·ç«¯ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œè§£è€¦ã€‚</p><p><strong>ç¼ºç‚¹</strong>ï¼šå·¥å‚ç±»èŒè´£è¿‡é‡ï¼Œå¢åŠ æ–°çš„ç±»å‹æ—¶ï¼Œå¾—ä¿®æ”¹å·¥ç¨‹ç±»å¾—ä»£ç ï¼Œè¿èƒŒå¼€é—­åŸåˆ™ã€‚</p><p>ä¸¾ä¾‹ï¼šæ–°å»ºFruitæ°´æœæŠ½è±¡ç±»ï¼ŒåŒ…å«eatæŠ½è±¡æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public abstract class Fruit &#123;</span><br><span class="line"></span><br><span class="line">    public abstract void eat();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®ç°ç±»Appleï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Apple extends Fruit&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void eat() &#123;</span><br><span class="line">        System.out.println(&quot;åƒğŸ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºåˆ›å»ºFruitçš„å·¥å‚ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class FruitFactory &#123;</span><br><span class="line"></span><br><span class="line">    public Fruit produce(String name) &#123;</span><br><span class="line">        if (&quot;apple&quot;.equals(name)) &#123;</span><br><span class="line">            return new Apple();</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸ªå®¢æˆ·ç«¯æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        FruitFactory factory &#x3D; new FruitFactory();</span><br><span class="line">        Fruit fruit &#x3D; factory.produce(&quot;apple&quot;);</span><br><span class="line">        fruit.eat();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œmainæ–¹æ³•ï¼Œè¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åƒğŸ</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå®¢æˆ·ç«¯Applicationå¹¶æœªä¾èµ–å…·ä½“çš„æ°´æœç±»å‹ï¼Œåªå…³å¿ƒFruitFactoryçš„å…¥å‚ï¼Œè¿™å°±æ˜¯å®¢æˆ·ç«¯å’Œå…·ä½“äº§å“è§£è€¦çš„ä½“ç°ï¼ŒUMLå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191216103019.png" alt="QQæˆªå›¾20191216103019.png"></p><h3 id="å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="å·¥å‚æ–¹æ³•æ¨¡å¼"></a>å·¥å‚æ–¹æ³•æ¨¡å¼</h3><p>ä¸ºäº†è§£å†³ç®€å•å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹ï¼Œè¯ç”Ÿäº†å·¥å‚æ–¹æ³•æ¨¡å¼ï¼ˆFactory method patternï¼‰ã€‚</p><p><strong>å®šä¹‰</strong>ï¼šå®šä¹‰åˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å®ç°è¿™ä¸ªæ¥å£çš„ç±»æ¥å†³å®šå®ä¾‹åŒ–å“ªä¸ªç±»ï¼Œå·¥å‚æ–¹æ³•è®©ç±»çš„å®ä¾‹åŒ–æ¨è¿Ÿåˆ°äº†å­ç±»è¿›è¡Œã€‚</p><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ol><li>å…·ä½“äº§å“ä»å®¢æˆ·ç«¯ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œè§£è€¦ã€‚</li><li>åŠ å…¥æ–°çš„ç±»å‹æ—¶ï¼Œåªéœ€æ·»åŠ æ–°çš„å·¥å‚æ–¹æ³•ï¼ˆæ— éœ€ä¿®æ”¹æ—§çš„å·¥å‚æ–¹æ³•ä»£ç ï¼‰ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ol><p><strong>ç¼ºç‚¹</strong>ï¼šç±»çš„ä¸ªæ•°å®¹æ˜“è¿‡å¤šï¼Œå¢åŠ å¤æ‚åº¦ã€‚</p><p>ä¸¾ä¾‹ï¼šæ–°å»ºFruitæŠ½è±¡ç±»ï¼ŒåŒ…å«eatæŠ½è±¡æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public abstract class Fruit &#123;</span><br><span class="line"></span><br><span class="line">    public abstract void eat();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºFruitFactoryæŠ½è±¡å·¥å‚ï¼Œå®šä¹‰produceFruitæŠ½è±¡æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public abstract class FruitFactory &#123;</span><br><span class="line"></span><br><span class="line">    public abstract Fruit produceFruit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºFruitçš„å®ç°ç±»ï¼ŒAppleï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Apple extends Fruit &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void eat() &#123;</span><br><span class="line">        System.out.println(&quot;åƒğŸ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºFruitFactoryçš„å®ç°ç±»AppleFruitFactoryï¼Œç”¨äºç”Ÿäº§å…·ä½“ç±»å‹çš„æ°´æœ â€”â€” è‹¹æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class AppleFruitFactory extends FruitFactory&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Fruit produceFruit() &#123;</span><br><span class="line">        return new Apple();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºå®¢æˆ·ç«¯Applicationæµ‹è¯•ä¸€æ³¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        FruitFactory factory &#x3D; new AppleFruitFactory();</span><br><span class="line">        Fruit fruit &#x3D; factory.produceFruit();</span><br><span class="line">        fruit.eat();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œmainæ–¹æ³•ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åƒğŸ</span><br></pre></td></tr></table></figure><p>ç°åœ¨è¦æ–°å¢Bananaç±»å‹çš„æ°´æœï¼Œåªéœ€è¦æ–°å¢Bananaç±»å‹çš„å·¥å‚ç±»å³å¯ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰çš„AppleFruitFactoryä»£ç ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ã€‚ä½†æ˜¯è¿™ç§æ¨¡å¼çš„ç¼ºç‚¹ä¹Ÿæ˜¾è€Œæ˜“è§ï¼Œå°±æ˜¯ç±»çš„ä¸ªæ•°å®¹æ˜“è¿‡å¤šï¼Œå¢åŠ å¤æ‚åº¦ã€‚</p><p>ä¸Šé¢ä¾‹å­UMLå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191216105317.png" alt="QQæˆªå›¾20191216105317.png"></p><h3 id="æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="æŠ½è±¡å·¥å‚æ¨¡å¼"></a>æŠ½è±¡å·¥å‚æ¨¡å¼</h3><p>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract factory patternï¼‰æä¾›äº†<strong>ä¸€ç³»åˆ—</strong>ç›¸å…³æˆ–è€…ç›¸äº’ä¾èµ–çš„å¯¹è±¡çš„æ¥å£ï¼Œå…³é”®å­—æ˜¯â€œä¸€ç³»åˆ—â€ã€‚</p><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ol><li>å…·ä½“äº§å“ä»å®¢æˆ·ç«¯ä»£ç ä¸­æŠ½ç¦»å‡ºæ¥ï¼Œè§£è€¦ã€‚</li><li>å°†ä¸€ä¸ªç³»åˆ—çš„äº§å“æ—ç»Ÿä¸€åˆ°ä¸€èµ·åˆ›å»ºã€‚</li></ol><p><strong>ç¼ºç‚¹</strong>ï¼šæ‹“å±•æ–°çš„åŠŸèƒ½å›°éš¾ï¼Œéœ€è¦ä¿®æ”¹æŠ½è±¡å·¥å‚çš„æ¥å£ï¼›</p><p>ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼é€‚åˆé‚£äº›åŠŸèƒ½ç›¸å¯¹å›ºå®šçš„äº§å“æ—çš„åˆ›å»ºã€‚</p><p>ä¸¾ä¾‹ï¼šæ–°å»ºæ°´æœæŠ½è±¡ç±»Fruitï¼ŒåŒ…å«buyæŠ½è±¡æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public abstract class Fruit &#123;</span><br><span class="line"></span><br><span class="line">    public abstract void buy();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºä»·æ ¼æŠ½è±¡ç±»Priceï¼ŒåŒ…å«payæŠ½è±¡æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public abstract class Price &#123;</span><br><span class="line"></span><br><span class="line">    public abstract void pay();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºæ°´æœåˆ›å»ºå·¥å‚æ¥å£FruitFactoryï¼ŒåŒ…å«è·å–æ°´æœå’Œä»·æ ¼æŠ½è±¡æ–¹æ³•ï¼ˆäº§å“æ—çš„ä½“ç°æ˜¯ï¼Œä¸€ç»„äº§å“åŒ…å«æ°´æœå’Œå¯¹åº”çš„ä»·æ ¼ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public interface FruitFactory &#123;</span><br><span class="line"></span><br><span class="line">    Fruit getFruit();</span><br><span class="line">    Price getPrice();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å¼€å§‹åˆ›å»ºğŸè¿™ä¸ªâ€œäº§å“æ—â€ã€‚æ–°å»ºFruitå®ç°ç±»AppleFruitï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class AppleFruit extends Fruit&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void buy() &#123;</span><br><span class="line">        System.out.println(&quot;è´­ä¹°ğŸ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºå¯¹åº”çš„è‹¹æœä»·æ ¼å®ç°ApplePriceï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class ApplePrice extends Price&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void pay() &#123;</span><br><span class="line">        System.out.println(&quot;ğŸå•ä»·2å…ƒ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå®¢æˆ·ç«¯Applicationï¼Œæµ‹è¯•ä¸€æ³¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        FruitFactory factory &#x3D; new AppleFruitFactory();</span><br><span class="line">        factory.getFruit().buy();</span><br><span class="line">        factory.getPrice().pay();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è´­ä¹°ğŸ</span><br><span class="line">ğŸå•ä»·2å…ƒ</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯åªéœ€è¦é€šè¿‡åˆ›å»ºAppleFruitFactoryå°±å¯ä»¥è·å¾—è‹¹æœè¿™ä¸ªäº§å“æ—çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬è‹¹æœå¯¹è±¡ï¼Œè‹¹æœä»·æ ¼ã€‚è¦æ–°å»ºğŸŒçš„äº§å“æ—ï¼Œåªéœ€è¦å®ç°FruitFactoryã€Priceå’ŒFruitæ¥å£å³å¯ã€‚è¿™ç§æ¨¡å¼çš„ç¼ºç‚¹å’Œå·¥å‚æ–¹æ³•å·®ä¸å¤šï¼Œå°±æ˜¯ç±»çš„ä¸ªæ•°å®¹æ˜“è¿‡å¤šï¼Œå¢åŠ å¤æ‚åº¦ã€‚</p><p>ä¸Šé¢ä¾‹å­UMLå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191216112922.png" alt="QQæˆªå›¾20191216112922.png"></p><h3 id="å»ºé€ è€…æ¨¡å¼"><a href="#å»ºé€ è€…æ¨¡å¼" class="headerlink" title="å»ºé€ è€…æ¨¡å¼"></a>å»ºé€ è€…æ¨¡å¼</h3><p>å»ºé€ è€…æ¨¡å¼ä¹Ÿç§°ä¸ºç”Ÿæˆå™¨æ¨¡å¼ï¼ˆBuilder Patternï¼‰ï¼Œå°†å¤æ‚å¯¹è±¡çš„å»ºé€ è¿‡ç¨‹æŠ½è±¡å‡ºæ¥ï¼ˆæŠ½è±¡ç±»åˆ«ï¼‰ï¼Œä½¿è¿™ä¸ªæŠ½è±¡è¿‡ç¨‹çš„ä¸åŒå®ç°æ–¹æ³•å¯ä»¥æ„é€ å‡ºä¸åŒè¡¨ç°ï¼ˆå±æ€§ï¼‰çš„å¯¹è±¡ã€‚ç®€å•æ¥è¯´å°±æ˜¯ï¼Œç›¸åŒçš„è¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“ã€‚</p><p>å°†å¤æ‚å¯¹è±¡çš„å»ºé€ è¿‡ç¨‹æŠ½è±¡å‡ºæ¥ï¼ˆæŠ½è±¡ç±»åˆ«ï¼‰ï¼Œä½¿è¿™ä¸ªæŠ½è±¡è¿‡ç¨‹çš„ä¸åŒå®ç°æ–¹æ³•å¯ä»¥æ„é€ å‡ºä¸åŒè¡¨ç°ï¼ˆå±æ€§ï¼‰çš„å¯¹è±¡ã€‚</p><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼Œç›¸åŒçš„è¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“ã€‚</p><p>é€‚ç”¨äºï¼š</p><ol><li>ä¸€ä¸ªå¯¹è±¡æœ‰éå¸¸å¤æ‚çš„å†…éƒ¨ç»“æ„ï¼ˆå¾ˆå¤šå±æ€§ï¼‰</li><li>æƒ³å°†å¤æ‚å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»ã€‚</li></ol><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ol><li>å°è£…æ€§å¥½ï¼Œåˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»</li><li>æ‹“å±•æ€§å¥½ï¼Œå»ºé€ ç±»ä¹‹é—´ç‹¬ç«‹ï¼Œä¸€å®šç¨‹åº¦ä¸Šè§£è€¦ã€‚</li></ol><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ol><li>äº§ç”Ÿå¤šä½™çš„Builderå¯¹è±¡ï¼›</li><li>äº§å“å†…éƒ¨å‘ç”Ÿå˜åŒ–ï¼Œå»ºé€ è€…éœ€è¦æ›´æ”¹ï¼Œæˆæœ¬è¾ƒå¤§ã€‚</li></ol><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><p>æ–°å¢å•†é“ºç±»Shopï¼ŒåŒ…å«åç§°ï¼Œåœ°ç‚¹å’Œç±»å‹å±æ€§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">public class Shop &#123;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line">    private String location;</span><br><span class="line">    private String type;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Shop&#123;&quot; +</span><br><span class="line">                &quot;name&#x3D;&#39;&quot; + name + &#39;\&#39;&#39; +</span><br><span class="line">                &quot;, location&#x3D;&#39;&quot; + location + &#39;\&#39;&#39; +</span><br><span class="line">                &quot;, type&#x3D;&#39;&quot; + type + &#39;\&#39;&#39; +</span><br><span class="line">                &#39;&#125;&#39;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getLocation() &#123;</span><br><span class="line">        return location;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setLocation(String location) &#123;</span><br><span class="line">        this.location &#x3D; location;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getType() &#123;</span><br><span class="line">        return type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setType(String type) &#123;</span><br><span class="line">        this.type &#x3D; type;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€åˆ›å»ºShopæŠ½è±¡ç”Ÿæˆå™¨ShopBuilderï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public abstract class ShopBuilder &#123;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line">    private String location;</span><br><span class="line">    private String type;</span><br><span class="line"></span><br><span class="line">    public abstract void name(String name);</span><br><span class="line">    public abstract void location(String location);</span><br><span class="line">    public abstract void type(String type);</span><br><span class="line"></span><br><span class="line">    public abstract Shop build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ…å«å’ŒShopç›¸åŒçš„å±æ€§åŠå¯¹åº”çš„æŠ½è±¡æ„å»ºæ–¹æ³•ã€‚</p><p>ç»§ç»­åˆ›å»ºShopBuilderçš„å®ç°ï¼Œæ°´æœåº—æ„é€ å™¨FruitShopBuilderï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public class FruitShopBuilder extends ShopBuilder&#123;</span><br><span class="line"></span><br><span class="line">    private Shop shop &#x3D; new Shop();</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void name(String name) &#123;</span><br><span class="line">        this.shop.setName(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void location(String location) &#123;</span><br><span class="line">        this.shop.setLocation(location);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void type(String type) &#123;</span><br><span class="line">        this.shop.setType(type);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Shop build() &#123;</span><br><span class="line">        return shop;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸ªç»é”€å•†ç±»Dealerï¼Œç”¨äºé€šè¿‡ShopBuilderæ„å»ºå…·ä½“çš„å•†åº—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class Dealer &#123;</span><br><span class="line"></span><br><span class="line">    private ShopBuilder builder;</span><br><span class="line"></span><br><span class="line">    public void setBuilder(ShopBuilder builder) &#123;</span><br><span class="line">        this.builder &#x3D; builder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Shop build(String name, String location, String type) &#123;</span><br><span class="line">        this.builder.name(name);</span><br><span class="line">        this.builder.location(location);</span><br><span class="line">        this.builder.type(type);</span><br><span class="line">        return builder.build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸ªå®¢æˆ·ç«¯Applicationæµ‹è¯•ä¸€æ³¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        ShopBuilder builder &#x3D; new FruitShopBuilder();</span><br><span class="line">        Dealer dealer &#x3D; new Dealer();</span><br><span class="line">        dealer.setBuilder(builder);</span><br><span class="line"></span><br><span class="line">        Shop shop &#x3D; dealer.build(&quot;XXæ°´æœåº—&quot;, &quot;ç¦å·å¸‚XXåŒºXXè¡—XXå·&quot;, &quot;æ°´æœç»è¥&quot;);</span><br><span class="line">        System.out.println(shop);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Shop&#123;name&#x3D;&#39;XXæ°´æœåº—&#39;, location&#x3D;&#39;ç¦å·å¸‚XXåŒºXXè¡—XXå·&#39;, type&#x3D;&#39;æ°´æœç»è¥&#39;&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­æ˜¯å…¸å‹çš„å»ºé€ è€…æ¨¡å¼ï¼ŒUMLå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191216162813.png" alt="QQæˆªå›¾20191216162813.png"></p><p>å…¶å®å»ºé€ è€…æ¨¡å¼æ›´ä¸ºå¸¸ç”¨çš„ä¾‹å­æ˜¯ä¸‹é¢è¿™ä¸ªï¼š</p><p>åˆ›å»ºä¸€ä¸ªåº—é“ºç±»Shopï¼ŒShopé‡ŒåŒ…å«æ„é€ è¯¥Shopçš„å†…éƒ¨ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">public class Shop &#123;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line">    private String location;</span><br><span class="line">    private String type;</span><br><span class="line"></span><br><span class="line">    public Shop(ShopBuilder builder) &#123;</span><br><span class="line">        this.name &#x3D; builder.name;</span><br><span class="line">        this.location &#x3D; builder.location;</span><br><span class="line">        this.type &#x3D; builder.type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Shop&#123;&quot; +</span><br><span class="line">                &quot;name&#x3D;&#39;&quot; + name + &#39;\&#39;&#39; +</span><br><span class="line">                &quot;, location&#x3D;&#39;&quot; + location + &#39;\&#39;&#39; +</span><br><span class="line">                &quot;, type&#x3D;&#39;&quot; + type + &#39;\&#39;&#39; +</span><br><span class="line">                &#39;&#125;&#39;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static class ShopBuilder &#123;</span><br><span class="line">        private String name;</span><br><span class="line">        private String location;</span><br><span class="line">        private String type;</span><br><span class="line"></span><br><span class="line">        public ShopBuilder name(String name) &#123;</span><br><span class="line">            this.name &#x3D; name;</span><br><span class="line">            return this;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public ShopBuilder location(String location) &#123;</span><br><span class="line">            this.location &#x3D; location;</span><br><span class="line">            return this;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public ShopBuilder type(String type) &#123;</span><br><span class="line">            this.type &#x3D; type;</span><br><span class="line">            return this;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public Shop build() &#123;</span><br><span class="line">            return new Shop(this);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å®¢æˆ·ç«¯æ„å»ºShopåªéœ€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Shop shop &#x3D; new Shop.ShopBuilder()</span><br><span class="line">                .name(&quot;XXæ°´æœåº—&quot;)</span><br><span class="line">                .location(&quot;ç¦å·å¸‚XXåŒºXXè¡—XXå·&quot;)</span><br><span class="line">                .type(&quot;æ°´æœç»è¥&quot;)</span><br><span class="line">                .build();</span><br><span class="line">        System.out.println(shop);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§ç”¨æ³•å’ŒLombokçš„@Builderæ³¨è§£æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</p><p>è¿™ä¸ªä¾‹å­çš„UMLå›¾ï¼š</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191216163308.png" alt="QQæˆªå›¾20191216163308.png"></p><h3 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h3><p>å•ä¾‹æ¨¡å¼ç›®çš„æ˜¯ä¸ºäº†ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ol><li>å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå‡å°‘äº†å†…å­˜å¼€é”€ï¼›</li><li>å¯ä»¥é¿å…å¯¹èµ„æºçš„å¤šé‡å ç”¨ï¼›</li><li>è®¾ç½®å…¨å±€è®¿é—®ç‚¹ï¼Œä¸¥æ ¼æ§åˆ¶è®¿é—®ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>æ²¡æœ‰æ¥å£ï¼Œæ‹“å±•å›°éš¾ã€‚</li></ol><h4 id="æ‡’æ±‰æ¨¡å¼"><a href="#æ‡’æ±‰æ¨¡å¼" class="headerlink" title="æ‡’æ±‰æ¨¡å¼"></a>æ‡’æ±‰æ¨¡å¼</h4><p>æ‡’æ±‰æ¨¡å¼ä¸‹çš„å•ä¾‹å†™æ³•æ˜¯æœ€ç®€å•çš„ï¼Œä½†å®ƒæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public class LazySingleton &#123;</span><br><span class="line"></span><br><span class="line">    private static LazySingleton lazySingleton &#x3D; null;</span><br><span class="line"></span><br><span class="line">    private LazySingleton() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static LazySingleton getInstance() &#123;</span><br><span class="line">        if (lazySingleton &#x3D;&#x3D; null) &#123;</span><br><span class="line">            lazySingleton &#x3D; new LazySingleton();</span><br><span class="line">        &#125;</span><br><span class="line">        return lazySingleton;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯åŠ åŒæ­¥é”è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class LazySingleton &#123;</span><br><span class="line"></span><br><span class="line">    private static LazySingleton lazySingleton &#x3D; null;</span><br><span class="line"></span><br><span class="line">    private LazySingleton() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static LazySingleton getInstance() &#123;</span><br><span class="line">        synchronized (LazySingleton.class) &#123;</span><br><span class="line">            if (lazySingleton &#x3D;&#x3D; null) &#123;</span><br><span class="line">                lazySingleton &#x3D; new LazySingleton();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return lazySingleton;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯åŒæ­¥é”é”çš„æ˜¯æ•´ä¸ªç±»ï¼Œæ¯”è¾ƒæ¶ˆè€—èµ„æºï¼Œå¹¶ä¸”å³ä½¿è¿è¡Œå†…å­˜ä¸­å·²ç»å­˜åœ¨LazySingletonï¼Œè°ƒç”¨å…¶getInstanceè¿˜æ˜¯ä¼šä¸Šé”ï¼Œæ‰€ä»¥è¿™ç§å†™æ³•ä¹Ÿä¸æ˜¯å¾ˆå¥½ã€‚</p><h4 id="åŒé‡åŒæ­¥é”å•ä¾‹æ¨¡å¼"><a href="#åŒé‡åŒæ­¥é”å•ä¾‹æ¨¡å¼" class="headerlink" title="åŒé‡åŒæ­¥é”å•ä¾‹æ¨¡å¼"></a>åŒé‡åŒæ­¥é”å•ä¾‹æ¨¡å¼</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class LazyDoubleCheckSingleton &#123;</span><br><span class="line"></span><br><span class="line">    private static LazyDoubleCheckSingleton instance &#x3D; null;</span><br><span class="line"></span><br><span class="line">    private LazyDoubleCheckSingleton() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static LazyDoubleCheckSingleton getInstance() &#123;</span><br><span class="line">        if (instance &#x3D;&#x3D; null) &#123;</span><br><span class="line">            synchronized (LazyDoubleCheckSingleton.class) &#123;</span><br><span class="line">                if (instance &#x3D;&#x3D; null) &#123;</span><br><span class="line">                    instance &#x3D; new LazyDoubleCheckSingleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä¾‹å­è™½ç„¶åŠ äº†åŒæ­¥é”ï¼Œä½†å®ƒè¿˜æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚è™½ç„¶ä¸Šé¢çš„ä¾‹å­ä¸ä¼šå‡ºç°å¤šæ¬¡åˆå§‹åŒ–LazyDoubleCheckSingletonå®ä¾‹çš„æƒ…å†µï¼Œä½†æ˜¯ç”±äºæŒ‡ä»¤é‡æ’çš„åŸå› ï¼ŒæŸäº›çº¿ç¨‹å¯èƒ½ä¼šè·å–åˆ°ç©ºå¯¹è±¡ï¼Œåç»­å¯¹è¯¥å¯¹è±¡çš„æ“ä½œå°†è§¦å‘ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p><p>è¦ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦é˜»æ­¢æŒ‡ä»¤é‡æ’å³å¯ï¼Œæ‰€ä»¥å¯ä»¥ç»™instanceå±æ€§åŠ ä¸Švolatileå…³é”®å­—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class LazyDoubleCheckSingleton &#123;</span><br><span class="line"></span><br><span class="line">    private volatile static LazyDoubleCheckSingleton instance &#x3D; null;</span><br><span class="line"></span><br><span class="line">    private LazyDoubleCheckSingleton() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static LazyDoubleCheckSingleton getInstance() &#123;</span><br><span class="line">        if (instance &#x3D;&#x3D; null) &#123;</span><br><span class="line">            synchronized (LazyDoubleCheckSingleton.class) &#123;</span><br><span class="line">                if (instance &#x3D;&#x3D; null) &#123;</span><br><span class="line">                    instance &#x3D; new LazyDoubleCheckSingleton();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›¸å…³åšæ–‡ï¼š<a href="https://mrbird.cc/volatile.html">æ·±å…¥ç†è§£volatileå…³é”®å­—</a>ã€‚</p><p>ä¸Šé¢è¿™ç§å†™æ³•æ˜¯ä¸ä½†ç¡®ä¿äº†çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸”å½“LazyDoubleCheckSingletonå®ä¾‹åˆ›å»ºå¥½åï¼Œåç»­å†è°ƒç”¨å…¶getInstanceæ–¹æ³•ä¸ä¼šä¸Šé”ã€‚</p><h4 id="é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼"><a href="#é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼" class="headerlink" title="é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼"></a>é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼</h4><p>çœ‹ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class StaticInnerClassSingleton &#123;</span><br><span class="line"></span><br><span class="line">    private StaticInnerClassSingleton() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static class InnerClass &#123;</span><br><span class="line">        private static StaticInnerClassSingleton instance &#x3D; new StaticInnerClassSingleton();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static StaticInnerClassSingleton getInstance() &#123;</span><br><span class="line">        return InnerClass.instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¿™ä¸ªä¾‹å­æ˜¯å¯è¡Œçš„å‘¢ï¼Ÿä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ï¼š</p><ol><li>JVMåœ¨ç±»çš„åˆå§‹åŒ–é˜¶æ®µä¼šåŠ Classå¯¹è±¡åˆå§‹åŒ–åŒæ­¥é”ï¼ŒåŒæ­¥å¤šä¸ªçº¿ç¨‹å¯¹è¯¥ç±»çš„åˆå§‹åŒ–æ“ä½œï¼›</li><li>é™æ€å†…éƒ¨ç±»InnerClassçš„é™æ€æˆå‘˜å˜é‡instanceåœ¨æ–¹æ³•åŒºä¸­åªä¼šæœ‰ä¸€ä¸ªå®ä¾‹ã€‚</li></ol><p>åœ¨Javaè§„èŒƒä¸­ï¼Œå½“ä»¥ä¸‹è¿™äº›æƒ…å†µé¦–æ¬¡å‘ç”Ÿæ—¶ï¼ŒAç±»å°†ä¼šç«‹åˆ»è¢«åˆå§‹åŒ–ï¼š</p><ol><li>Aç±»å‹å®ä¾‹è¢«åˆ›å»ºï¼›</li><li>Aç±»ä¸­å£°æ˜çš„é™æ€æ–¹æ³•è¢«è°ƒç”¨ï¼›</li><li>Aç±»ä¸­çš„é™æ€æˆå‘˜å˜é‡è¢«èµ‹å€¼ï¼›</li><li>Aç±»ä¸­çš„é™æ€æˆå‘˜è¢«ä½¿ç”¨ï¼ˆéå¸¸é‡ï¼‰ï¼›</li></ol><h4 id="é¥¿æ±‰å•ä¾‹æ¨¡å¼"><a href="#é¥¿æ±‰å•ä¾‹æ¨¡å¼" class="headerlink" title="é¥¿æ±‰å•ä¾‹æ¨¡å¼"></a>é¥¿æ±‰å•ä¾‹æ¨¡å¼</h4><p>â€œé¥¿æ±‰â€æ„æŒ‡åœ¨ç±»åŠ è½½çš„æ—¶å€™å°±åˆå§‹åŒ–ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class HungrySingleton &#123;</span><br><span class="line"></span><br><span class="line">    private final static HungrySingleton instance &#x3D; new HungrySingleton();</span><br><span class="line"></span><br><span class="line">    private HungrySingleton() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static HungrySingleton getInstance() &#123;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ¨¡å¼åœ¨ç±»åŠ è½½çš„æ—¶å€™å°±å®Œæˆäº†åˆå§‹åŒ–ï¼Œæ‰€ä»¥å¹¶ä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨æ€§é—®é¢˜ï¼›ä½†ç”±äºä¸æ˜¯æ‡’åŠ è½½ï¼Œé¥¿æ±‰æ¨¡å¼ä¸ç®¡éœ€ä¸éœ€è¦ç”¨åˆ°å®ä¾‹éƒ½è¦å»åˆ›å»ºå®ä¾‹ï¼Œå¦‚æœåˆ›å»ºäº†ä¸ä½¿ç”¨ï¼Œåˆ™ä¼šé€ æˆå†…å­˜æµªè´¹ã€‚</p><h4 id="åºåˆ—åŒ–ç ´åå•ä¾‹æ¨¡å¼"><a href="#åºåˆ—åŒ–ç ´åå•ä¾‹æ¨¡å¼" class="headerlink" title="åºåˆ—åŒ–ç ´åå•ä¾‹æ¨¡å¼"></a>åºåˆ—åŒ–ç ´åå•ä¾‹æ¨¡å¼</h4><p>å‰é¢çš„å•ä¾‹ä¾‹å­åœ¨å®ç°åºåˆ—åŒ–æ¥å£åéƒ½èƒ½è¢«åºåˆ—åŒ–çš„æ–¹å¼ç ´åï¼Œæ¯”å¦‚HungrySingletonï¼Œè®©å…¶å®ç°åºåˆ—åŒ–æ¥å£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class HungrySingleton implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">    private static final long serialVersionUID &#x3D; -8073288969651806838L;</span><br><span class="line"></span><br><span class="line">    private final static HungrySingleton instance &#x3D; new HungrySingleton();</span><br><span class="line"></span><br><span class="line">    private HungrySingleton() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static HungrySingleton getInstance() &#123;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ›å»ºApplicationæµ‹è¯•ä¸€ä¸‹å¦‚ä½•ç ´åï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws IOException, ClassNotFoundException &#123;</span><br><span class="line">        &#x2F;&#x2F; æ¼”ç¤ºåºåˆ—åŒ–ç ´åå•ä¾‹</span><br><span class="line">        HungrySingleton instance &#x3D; HungrySingleton.getInstance();</span><br><span class="line">        ObjectOutputStream outputStream &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;file&quot;));</span><br><span class="line">        outputStream.writeObject(instance);</span><br><span class="line"></span><br><span class="line">        ObjectInputStream inputStream &#x3D; new ObjectInputStream(new FileInputStream(&quot;file&quot;));</span><br><span class="line">        HungrySingleton newInstance &#x3D; (HungrySingleton) inputStream.readObject();</span><br><span class="line"></span><br><span class="line">        System.out.println(instance);</span><br><span class="line">        System.out.println(newInstance);</span><br><span class="line">        System.out.println(instance &#x3D;&#x3D; newInstance);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cc.mrbird.design.pattern.creational.singleton.HungrySingleton@7f31245a</span><br><span class="line">cc.mrbird.design.pattern.creational.singleton.HungrySingleton@6d03e736</span><br><span class="line">false</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æ˜¯å•ä¾‹æ¨¡å¼ï¼Œä½†å´æˆåŠŸåˆ›å»ºå‡ºäº†ä¸¤ä¸ªä¸ä¸€æ ·çš„å®ä¾‹ï¼Œå•ä¾‹é­åˆ°äº†ç ´åã€‚</p><p>è¦è®©ååºåˆ—åŒ–åçš„å¯¹è±¡å’Œåºåˆ—åŒ–å‰çš„å¯¹è±¡æ˜¯åŒä¸€ä¸ªå¯¹è±¡çš„è¯ï¼Œå¯ä»¥åœ¨HungrySingletoné‡ŒåŠ ä¸ŠreadResolveæ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public class HungrySingleton implements Serializable &#123;</span><br><span class="line"></span><br><span class="line">    private static final long serialVersionUID &#x3D; -8073288969651806838L;</span><br><span class="line"></span><br><span class="line">    private final static HungrySingleton instance &#x3D; new HungrySingleton();</span><br><span class="line"></span><br><span class="line">    private HungrySingleton() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static HungrySingleton getInstance() &#123;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F; æ–°å¢</span><br><span class="line">    private Object readResolve() &#123;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡è¿è¡ŒApplicationçš„mainæ–¹æ³•åï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cc.mrbird.design.pattern.creational.singleton.HungrySingleton@7f31245a</span><br><span class="line">cc.mrbird.design.pattern.creational.singleton.HungrySingleton@7f31245a</span><br><span class="line">true</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§æ–¹å¼æœ€ç»ˆååºåˆ—åŒ–å‡ºæ¥çš„å¯¹è±¡å’Œåºåˆ—åŒ–å¯¹è±¡æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚ä½†è¿™ç§æ–¹å¼ååºåˆ—åŒ–è¿‡ç¨‹å†…éƒ¨è¿˜æ˜¯ä¼šé‡æ–°åˆ›å»ºHungrySingletonå®ä¾‹ï¼Œåªä¸è¿‡å› ä¸ºHungrySingletonç±»å®šä¹‰äº†readResolveæ–¹æ³•ï¼ˆæ–¹æ³•å†…éƒ¨è¿”å›instanceå¼•ç”¨ï¼‰ï¼Œååºåˆ—åŒ–è¿‡ç¨‹ä¼šåˆ¤æ–­ç›®æ ‡ç±»æ˜¯å¦å®šä¹‰äº†readResolveè¯¥æ–¹æ³•ï¼Œæ˜¯çš„è¯åˆ™é€šè¿‡åå°„è°ƒç”¨è¯¥æ–¹æ³•ã€‚</p><h4 id="åå°„ç ´åå•ä¾‹æ¨¡å¼"><a href="#åå°„ç ´åå•ä¾‹æ¨¡å¼" class="headerlink" title="åå°„ç ´åå•ä¾‹æ¨¡å¼"></a>åå°„ç ´åå•ä¾‹æ¨¡å¼</h4><p>é™¤äº†åºåˆ—åŒ–èƒ½ç ´åå•ä¾‹å¤–ï¼Œåå°„ä¹Ÿå¯ä»¥ï¼Œä¸¾ä¸ªåå°„ç ´åHungrySingletonçš„ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        HungrySingleton instance &#x3D; HungrySingleton.getInstance();</span><br><span class="line">        &#x2F;&#x2F; åå°„åˆ›å»ºå®ä¾‹</span><br><span class="line">        Class&lt;HungrySingleton&gt; c &#x3D; HungrySingleton.class;</span><br><span class="line">        &#x2F;&#x2F; è·å–æ„é€ å™¨</span><br><span class="line">        Constructor&lt;HungrySingleton&gt; constructor &#x3D; c.getDeclaredConstructor();</span><br><span class="line">        &#x2F;&#x2F; æ‰“å¼€æ„é€ å™¨æƒé™</span><br><span class="line">        constructor.setAccessible(true);</span><br><span class="line">        HungrySingleton newInstance &#x3D; constructor.newInstance();</span><br><span class="line"></span><br><span class="line">        System.out.println(instance);</span><br><span class="line">        System.out.println(newInstance);</span><br><span class="line">        System.out.println(instance &#x3D;&#x3D; newInstance);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cc.mrbird.design.pattern.creational.singleton.HungrySingleton@1b6d3586</span><br><span class="line">cc.mrbird.design.pattern.creational.singleton.HungrySingleton@4554617c</span><br><span class="line">false</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡åå°„ç ´åäº†ç§æœ‰æ„é€ å™¨æƒé™ï¼ŒæˆåŠŸåˆ›å»ºäº†æ–°çš„å®ä¾‹ã€‚</p><p>å¯¹äºè¿™ç§æƒ…å†µï¼Œé¥¿æ±‰æ¨¡å¼ä¸‹çš„ä¾‹å­å¯ä»¥åœ¨æ„é€ å™¨ä¸­æ·»åŠ åˆ¤æ–­é€»è¾‘æ¥é˜²å¾¡ï¼ˆæ‡’æ±‰æ¨¡å¼çš„å°±æ²¡æœ‰åŠæ³•äº†ï¼‰ï¼Œæ¯”å¦‚ä¿®æ”¹HungrySingletonçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class HungrySingleton &#123;</span><br><span class="line"></span><br><span class="line">    private final static HungrySingleton instance &#x3D; new HungrySingleton();</span><br><span class="line"></span><br><span class="line">    private HungrySingleton() &#123;</span><br><span class="line">        if (instance !&#x3D; null) &#123;</span><br><span class="line">            throw new RuntimeException(&quot;forbidden&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static HungrySingleton getInstance() &#123;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†æ¬¡è¿è¡ŒApplicationçš„mainæ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.lang.reflect.InvocationTargetException</span><br><span class="line">    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)</span><br><span class="line">    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)</span><br><span class="line">    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)</span><br><span class="line">    at java.lang.reflect.Constructor.newInstance(Constructor.java:423)</span><br><span class="line">    at cc.mrbird.design.pattern.creational.singleton.Application.main(Application.java:33)</span><br><span class="line">Caused by: java.lang.RuntimeException: forbidden</span><br><span class="line">    at cc.mrbird.design.pattern.creational.singleton.HungrySingleton.&lt;init&gt;(HungrySingleton.java:16)</span><br><span class="line">    ... 5 more</span><br></pre></td></tr></table></figure><h4 id="æšä¸¾å•ä¾‹æ¨¡å¼"><a href="#æšä¸¾å•ä¾‹æ¨¡å¼" class="headerlink" title="æšä¸¾å•ä¾‹æ¨¡å¼"></a>æšä¸¾å•ä¾‹æ¨¡å¼</h4><p>æšä¸¾å•ä¾‹æ¨¡å¼æ˜¯æ¨èçš„å•ä¾‹æ¨¡å¼ï¼Œå®ƒä¸ä»…å¯ä»¥é˜²å¾¡åºåˆ—åŒ–æ”»å‡»ï¼Œä¹Ÿå¯ä»¥é˜²å¾¡åå°„æ”»å‡»ã€‚ä¸¾ä¸ªæšä¸¾å•ä¾‹æ¨¡å¼çš„ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public enum EnumSingleton &#123;</span><br><span class="line"></span><br><span class="line">    INSTANCE;</span><br><span class="line"></span><br><span class="line">    private Object data;</span><br><span class="line"></span><br><span class="line">    public Object getData() &#123;</span><br><span class="line">        return data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setData(Object data) &#123;</span><br><span class="line">        this.data &#x3D; data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static EnumSingleton getInstance()&#123;</span><br><span class="line">        return INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éªŒè¯ä¸‹æ˜¯å¦æ˜¯å•ä¾‹çš„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line"></span><br><span class="line">        EnumSingleton instance &#x3D; EnumSingleton.getInstance();</span><br><span class="line">        instance.setData(new Object());</span><br><span class="line">        EnumSingleton newInstance &#x3D; EnumSingleton.getInstance();</span><br><span class="line"></span><br><span class="line">        System.out.println(instance);</span><br><span class="line">        System.out.println(newInstance);</span><br><span class="line">        System.out.println(instance.getData());</span><br><span class="line">        System.out.println(newInstance.getData());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSTANCE</span><br><span class="line">INSTANCE</span><br><span class="line">java.lang.Object@1b6d3586</span><br><span class="line">java.lang.Object@1b6d3586</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä¸‹åºåˆ—åŒ–æ”»å‡»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        EnumSingleton instance &#x3D; EnumSingleton.getInstance();</span><br><span class="line">        instance.setData(new Object());</span><br><span class="line">        ObjectOutputStream outputStream &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;file&quot;));</span><br><span class="line">        outputStream.writeObject(instance);</span><br><span class="line">       </span><br><span class="line">        ObjectInputStream inputStream &#x3D; new ObjectInputStream(new FileInputStream(&quot;file&quot;));</span><br><span class="line">        EnumSingleton newInstance &#x3D; (EnumSingleton) inputStream.readObject();</span><br><span class="line"></span><br><span class="line">        System.out.println(instance);</span><br><span class="line">        System.out.println(newInstance);</span><br><span class="line">        System.out.println(instance &#x3D;&#x3D; newInstance);</span><br><span class="line"></span><br><span class="line">        System.out.println(instance.getData());</span><br><span class="line">        System.out.println(newInstance.getData());</span><br><span class="line">        System.out.println(instance.getData() &#x3D;&#x3D; newInstance.getData());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">INSTANCE</span><br><span class="line">INSTANCE</span><br><span class="line">true</span><br><span class="line">java.lang.Object@568db2f2</span><br><span class="line">java.lang.Object@568db2f2</span><br><span class="line">true</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åºåˆ—åŒ–å’Œååºåˆ—åŒ–åçš„å¯¹è±¡æ˜¯åŒä¸€ä¸ªã€‚</p><p>åŸç†ï¼šè·Ÿè¸ªObjectInputStream#readObjectæºç ï¼Œå…¶ä¸­å½“åç¼–è¯‘å¯¹è±¡ä¸ºæšä¸¾ç±»å‹æ—¶ï¼Œå°†è°ƒç”¨readEnumæ–¹æ³•ï¼š</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191217155448.png" alt="QQæˆªå›¾20191217155448.png"></p><p>nameä¸ºæšä¸¾ç±»é‡Œçš„æšä¸¾å¸¸é‡ï¼Œå¯¹äºçº¿ç¨‹æ¥è¯´å®ƒæ˜¯å”¯ä¸€çš„ï¼Œå­˜åœ¨æ–¹æ³•åŒºï¼Œæ‰€ä»¥é€šè¿‡<code>Enum.valueOf((Class)cl, name)</code>æ–¹æ³•å¾—åˆ°çš„æšä¸¾å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªã€‚</p><p>å†æµ‹è¯•ä¸€ä¸‹åå°„æ”»å‡»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        EnumSingleton instance &#x3D; EnumSingleton.getInstance();</span><br><span class="line"></span><br><span class="line">        Class&lt;EnumSingleton&gt; c &#x3D; EnumSingleton.class;</span><br><span class="line">        &#x2F;&#x2F; æšä¸¾ç±»åªåŒ…å«ä¸€ä¸ª(String,int)ç±»å‹æ„é€ å™¨</span><br><span class="line">        Constructor&lt;EnumSingleton&gt; constructor &#x3D; c.getDeclaredConstructor(String.class, int.class);</span><br><span class="line">        constructor.setAccessible(true);</span><br><span class="line">        EnumSingleton newInstance &#x3D; constructor.newInstance(&quot;hello&quot;, 1);</span><br><span class="line"></span><br><span class="line">        System.out.println(instance &#x3D;&#x3D; newInstance);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œè¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: Cannot reflectively create enum objects</span><br><span class="line">    at java.lang.reflect.Constructor.newInstance(Constructor.java:417)</span><br><span class="line">    at cc.mrbird.design.pattern.creational.singleton.Application.main(Application.java:71)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æŠ›å¼‚å¸¸äº†ï¼ŒæŸ¥çœ‹Constructorç±»çš„417è¡Œä»£ç å¯ä»¥å‘ç°åŸå› ï¼š<img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191217160647.png" alt="QQæˆªå›¾20191217160647.png"></p><p>Javaç¦æ­¢é€šè¿‡åå°„åˆ›å»ºæšä¸¾å¯¹è±¡ã€‚</p><p>æ­£æ˜¯å› ä¸ºæšä¸¾ç±»å‹æ‹¥æœ‰è¿™äº›å¤©ç„¶çš„ä¼˜åŠ¿ï¼Œæ‰€ä»¥ç”¨å®ƒåˆ›å»ºå•ä¾‹æ˜¯ä¸é”™çš„é€‰æ‹©ï¼Œè¿™ä¹Ÿæ˜¯Effective Javaæ¨èçš„æ–¹å¼ã€‚</p><h3 id="åŸå‹æ¨¡å¼"><a href="#åŸå‹æ¨¡å¼" class="headerlink" title="åŸå‹æ¨¡å¼"></a>åŸå‹æ¨¡å¼</h3><p>åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œé€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</p><p>é€‚ç”¨äºï¼š</p><ol><li>ç±»åˆå§‹åŒ–æ¶ˆè€—è¾ƒå¤šèµ„æºï¼›</li><li>å¾ªç¯ä½“ä¸­ç”Ÿäº§å¤§é‡å¯¹è±¡çš„æ—¶å€™ã€‚</li></ol><p>ä¼˜ç‚¹ï¼š</p><ol><li>åŸå‹æ¨¡å¼æ€§èƒ½æ¯”ç›´æ¥newä¸€ä¸ªå¯¹è±¡æ€§èƒ½å¥½ï¼›</li><li>ç®€åŒ–åˆ›å»ºå¯¹è±¡è¿‡ç¨‹ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>å¯¹è±¡å¿…é¡»é‡å†™Objectå…‹éš†æ–¹æ³•ï¼›</li><li>å¤æ‚å¯¹è±¡çš„å…‹éš†æ–¹æ³•å†™èµ·æ¥è¾ƒéº»çƒ¦ï¼ˆæ·±å…‹éš†ã€æµ…å…‹éš†ï¼‰</li></ol><p>ä¸¾ä¾‹ï¼šæ–°å»ºä¸€ä¸ªå­¦ç”Ÿç±»Studentï¼Œå®ç°å…‹éš†æ¥å£ï¼Œå¹¶é‡å†™Objectçš„å…‹éš†æ–¹æ³•ï¼ˆå› ä¸ºéƒ½æ˜¯ç®€å•å±æ€§ï¼Œæ‰€ä»¥æµ…å…‹éš†å³å¯ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">public class Student implements Cloneable &#123;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(int age) &#123;</span><br><span class="line">        this.age &#x3D; age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Student&#123;&quot; +</span><br><span class="line">                &quot;name&#x3D;&#39;&quot; + name + &#39;\&#39;&#39; +</span><br><span class="line">                &quot;, age&#x3D;&quot; + age +</span><br><span class="line">                &#39;&#125;&#39;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line">        return super.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨Applicationä¸­æµ‹è¯•ä¸€æ³¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws CloneNotSupportedException &#123;</span><br><span class="line">        Student student &#x3D; new Student();</span><br><span class="line">        ArrayList&lt;Student&gt; list &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">        for (int i &#x3D; 0; i &lt; 3; i++) &#123;</span><br><span class="line">            Student s &#x3D; (Student) student.clone();</span><br><span class="line">            s.setName(&quot;å­¦ç”Ÿ&quot; + i);</span><br><span class="line">            s.setAge(20 + i);</span><br><span class="line">            list.add(s);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(list);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Student&#123;name&#x3D;&#39;å­¦ç”Ÿ0&#39;, age&#x3D;20&#125;, Student&#123;name&#x3D;&#39;å­¦ç”Ÿ1&#39;, age&#x3D;21&#125;, Student&#123;name&#x3D;&#39;å­¦ç”Ÿ2&#39;, age&#x3D;22&#125;]</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼ä¼šæ¯”ç›´æ¥åœ¨å¾ªç¯ä¸­åˆ›å»ºStudentæ€§èƒ½å¥½ã€‚</p><p>å½“å¯¹è±¡åŒ…å«å¼•ç”¨ç±»å‹å±æ€§æ—¶ï¼Œéœ€è¦ä½¿ç”¨æ·±å…‹éš†ï¼Œæ¯”å¦‚StudentåŒ…å«Dateå±æ€§æ—¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">public class Student implements Cloneable &#123;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line">    private int age;</span><br><span class="line">    private Date birthday;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(int age) &#123;</span><br><span class="line">        this.age &#x3D; age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Date getBirthday() &#123;</span><br><span class="line">        return birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setBirthday(Date birthday) &#123;</span><br><span class="line">        this.birthday &#x3D; birthday;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;Student&#123;&quot; +</span><br><span class="line">                &quot;name&#x3D;&#39;&quot; + name + &#39;\&#39;&#39; +</span><br><span class="line">                &quot;, age&#x3D;&quot; + age +</span><br><span class="line">                &quot;, birthday&#x3D;&quot; + birthday +</span><br><span class="line">                &#39;&#125;&#39;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line">        Student student &#x3D; (Student) super.clone();</span><br><span class="line">        &#x2F;&#x2F; å¼•ç”¨ç±»å‹æ·±å…‹éš†</span><br><span class="line">        Date birthday &#x3D; (Date) student.getBirthday().clone();</span><br><span class="line">        student.setBirthday(birthday);</span><br><span class="line">        return student;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå…‹éš†ä¼šç ´åå®ç°äº†Cloneableæ¥å£çš„å•ä¾‹å¯¹è±¡ã€‚</p><h2 id="ç»“æ„å‹æ¨¡å¼"><a href="#ç»“æ„å‹æ¨¡å¼" class="headerlink" title="ç»“æ„å‹æ¨¡å¼"></a>ç»“æ„å‹æ¨¡å¼</h2><h3 id="å¤–è§‚æ¨¡å¼"><a href="#å¤–è§‚æ¨¡å¼" class="headerlink" title="å¤–è§‚æ¨¡å¼"></a>å¤–è§‚æ¨¡å¼</h3><p>å¤–è§‚æ¨¡å¼åˆå«é—¨é¢æ¨¡å¼ï¼Œæä¾›äº†ç»Ÿä¸€å¾—æ¥å£ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æ¥å£ã€‚</p><p>é€‚ç”¨äºï¼š</p><ol><li>å­ç³»ç»Ÿè¶Šæ¥è¶Šå¤æ‚ï¼Œå¢åŠ å¤–è§‚æ¨¡å¼æä¾›ç®€å•æ¥å£è°ƒç”¨ï¼›</li><li>æ„å»ºå¤šå±‚ç³»ç»Ÿç»“æ„ï¼Œåˆ©ç”¨å¤–è§‚å¯¹è±¡ä½œä¸ºæ¯å±‚çš„å…¥å£ï¼Œç®€åŒ–å±‚é—´è°ƒç”¨ã€‚</li></ol><p>ä¼˜ç‚¹ï¼š</p><ol><li>ç®€åŒ–äº†è°ƒç”¨è¿‡ç¨‹ï¼Œæ— éœ€äº†è§£æ·±å…¥å­ç³»ç»Ÿï¼›</li><li>å‡ä½è€¦åˆåº¦ï¼›</li><li>æ›´å¥½çš„å±‚æ¬¡åˆ’åˆ†ï¼›</li><li>ç¬¦åˆè¿ªç±³ç‰¹æ³•åˆ™ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>å¢åŠ å­ç³»ç»Ÿï¼Œæ‹“å±•å­ç³»ç»Ÿè¡Œä¸ºå®¹æ˜“å¼•å…¥é£é™©ï¼›</li><li>ä¸ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ol><p>ä¸¾ä¸ªè®¢å¤–å–çš„ä¾‹å­ã€‚</p><p>åˆ›å»ºä¸€ä¸ªå¤–å–å®ä½“ç±»Takeawayï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Takeaway &#123;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¢å¤–å–è¿‡ç¨‹ä¸€èˆ¬åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šä¸‹å•ã€æ”¯ä»˜å’Œé…é€ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ›å»ºä¸‰ä¸ªServiceå¯¹åº”è¿™ä¸‰ä¸ªè¿‡ç¨‹ã€‚æ–°å»ºä¸‹å•æœåŠ¡OrderServiceï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class OrderService &#123;</span><br><span class="line"></span><br><span class="line">    public boolean placeAnOrder(Takeaway takeaway) &#123;</span><br><span class="line">        System.out.println(takeaway.getName() + &quot;ä¸‹å•æˆåŠŸ&quot;);</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºæ”¯ä»˜æœåŠ¡PayServiceï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class PayService &#123;</span><br><span class="line"></span><br><span class="line">    public boolean pay(Takeaway takeaway) &#123;</span><br><span class="line">        System.out.println(&quot;å•†å“&quot; + takeaway.getName() + &quot;æ”¯ä»˜æˆåŠŸ&quot;);</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºé…é€æœåŠ¡DeliveryServiceï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class DeliveryService &#123;</span><br><span class="line"></span><br><span class="line">    public void delivery(Takeaway takeaway) &#123;</span><br><span class="line">        System.out.println(takeaway.getName() + &quot;å·²ç”±éª‘æ‰‹XXæ¥å•ï¼Œè®¢å•æ´¾é€ä¸­&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŸºäºå¤–è§‚æ¨¡å¼æ³•åˆ™ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªServiceæ¥èšåˆè¿™ä¸‰ä¸ªæœåŠ¡ï¼Œå®¢æˆ·ç«¯åªéœ€è¦å’Œè¿™ä¸ªServiceäº¤äº’å³å¯ã€‚æ–°å»ºå¤–å–æœåŠ¡TakeawayServiceï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class TakeawayService &#123;</span><br><span class="line"></span><br><span class="line">    private OrderService orderService &#x3D; new OrderService();</span><br><span class="line">    private PayService payService &#x3D; new PayService();</span><br><span class="line">    private DeliveryService deliveryService &#x3D; new DeliveryService();</span><br><span class="line"></span><br><span class="line">    public void takeOrder(Takeaway takeaway) &#123;</span><br><span class="line">        if (orderService.placeAnOrder(takeaway)) &#123;</span><br><span class="line">            if (payService.pay(takeaway)) &#123;</span><br><span class="line">                deliveryService.delivery(takeaway);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸ªå®¢æˆ·ç«¯æµ‹è¯•ä¸€æ³¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Takeaway takeaway &#x3D; new Takeaway();</span><br><span class="line">        takeaway.setName(&quot;æ³¡æ¤’ğŸ¸&quot;);</span><br><span class="line"></span><br><span class="line">        TakeawayService takeawayService &#x3D; new TakeawayService();</span><br><span class="line">        takeawayService.takeOrder(takeaway);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå®¢æˆ·ç«¯åªéœ€è¦è°ƒç”¨TakeawayServiceå³å¯ï¼Œæ— éœ€å…³ç³»å†…éƒ¨å…·ä½“ç»å†äº†å¤šå°‘ä¸ªæ­¥éª¤ï¼Œè¿è¡Œmainæ–¹æ³•è¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ³¡æ¤’ğŸ¸ä¸‹å•æˆåŠŸ</span><br><span class="line">å•†å“æ³¡æ¤’ğŸ¸æ”¯ä»˜æˆåŠŸ</span><br><span class="line">æ³¡æ¤’ğŸ¸å·²ç”±éª‘æ‰‹XXæ¥å•ï¼Œè®¢å•æ´¾é€ä¸­</span><br></pre></td></tr></table></figure><p>è¯¥ä¾‹å­çš„UMLå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191218151629.png" alt="QQæˆªå›¾20191218151629.png"></p><h3 id="è£…é¥°è€…æ¨¡å¼"><a href="#è£…é¥°è€…æ¨¡å¼" class="headerlink" title="è£…é¥°è€…æ¨¡å¼"></a>è£…é¥°è€…æ¨¡å¼</h3><p>åœ¨ä¸æ”¹å˜åŸæœ‰å¯¹è±¡çš„åŸºç¡€ä¹‹ä¸Šï¼Œå°†åŠŸèƒ½é™„åŠ åˆ°å¯¹è±¡ä¸Šï¼Œæä¾›äº†æ¯”ç»§æ‰¿æ›´æœ‰å¼¹æ€§çš„æ›¿ä»£æ–¹æ¡ˆã€‚</p><p>é€‚ç”¨äºï¼š</p><ol><li>æ‹“å±•ä¸€ä¸ªç±»çš„åŠŸèƒ½ï¼›</li><li>åŠ¨æ€ç»™å¯¹è±¡æ·»åŠ åŠŸèƒ½ï¼Œå¹¶ä¸”åŠ¨æ€æ’¤é”€ã€‚</li></ol><p>ä¼˜ç‚¹ï¼š</p><ol><li>ç»§æ‰¿çš„æœ‰åŠ›è¡¥å……ï¼Œä¸æ”¹å˜åŸæœ‰å¯¹è±¡çš„æƒ…å†µä¸‹ç»™å¯¹è±¡æ‹“å±•åŠŸèƒ½ï¼›</li><li>é€šè¿‡ä½¿ç”¨ä¸åŒçš„è£…é¥°ç±»ã€ä¸åŒçš„ç»„åˆæ–¹å¼ï¼Œå®ç°ä¸åŒçš„æ•ˆæœã€‚</li><li>ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>å¢åŠ ç¨‹åºå¤æ‚æ€§ï¼›</li></ol><p>ä¸¾ä¸ªæ°´æœæ²™æ‹‰çš„ä¾‹å­ã€‚</p><p>æ¯”å¦‚åœ¨ç‚¹æ°´æœæ²™æ‹‰å¤–å–æ—¶ï¼Œå¯ä»¥å¾€æ°´æœæ²™æ‹‰é‡ŒåŠ å„ç§æ°´æœï¼Œä»·æ ¼ä¹Ÿä¼šç›¸åº”çš„è°ƒæ•´ï¼Œè¦è®©ç¨‹åºæ”¯æŒä¸åŒæ°´æœè‡ªç”±ç»„åˆï¼Œå¹¶è®¡ç®—ç›¸åº”çš„ä»·æ ¼ï¼Œåˆ™å¯ä»¥ä½¿ç”¨è£…é¥°è€…æ¨¡å¼æ¥å®Œæˆã€‚</p><p>å®šä¹‰ä¸€ä¸ªæŠ½è±¡çš„æ°´æœæ²™æ‹‰ç±»AbstractFruitSaladï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public abstract class AbstractFruitSalad &#123;</span><br><span class="line">    public abstract String remark();</span><br><span class="line">    public abstract int price();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ…å«å¤‡æ³¨å’Œä»·æ ¼æŠ½è±¡æ–¹æ³•ã€‚</p><p>æ¥ç€åˆ›å»ºä¸€ä¸ªæŠ½è±¡çš„è£…é¥°å™¨AbstractDecoratorï¼ˆå…³é”®ç‚¹ï¼Œç»§æ‰¿æŠ½è±¡æ°´æœæ²™æ‹‰ç±»ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public class AbstractDecorator extends AbstractFruitSalad&#123;</span><br><span class="line"></span><br><span class="line">    private AbstractFruitSalad fruitSalad;</span><br><span class="line"></span><br><span class="line">    public AbstractDecorator(AbstractFruitSalad fruitSalad)&#123;</span><br><span class="line">        this.fruitSalad &#x3D; fruitSalad;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String remark() &#123;</span><br><span class="line">        return fruitSalad.remark();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int price() &#123;</span><br><span class="line">        return fruitSalad.price();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå…·ä½“çš„æ°´æœæ²™æ‹‰ç±»FruitSaladï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class FruitSalad extends AbstractFruitSalad&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public String remark() &#123;</span><br><span class="line">        return &quot;æ°´æœğŸ¥—ï¼ˆæ ‡å‡†ï¼‰\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int price() &#123;</span><br><span class="line">        return 9;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ²™æ‹‰æ˜¯æ ‡å‡†çš„æ°´æœæ²™æ‹‰ï¼Œä»·æ ¼æ˜¯9å…ƒã€‚</p><p>å¦‚æœæˆ‘ä»¬çš„æ°´æœæ²™æ‹‰è¿˜å…è®¸å®¢æˆ·æ·»åŠ çŒ•çŒ´æ¡ƒå’Œè¥¿ç“œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸¤ä¸ªæ–°çš„è£…é¥°å™¨ã€‚æ·»åŠ çŒ•çŒ´æ¡ƒè£…é¥°å™¨KiwiDecoratorï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class KiwiDecorator extends AbstractDecorator &#123;</span><br><span class="line"></span><br><span class="line">    public KiwiDecorator(AbstractFruitSalad fruitSalad) &#123;</span><br><span class="line">        super(fruitSalad);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String remark() &#123;</span><br><span class="line">        return super.remark() + &quot;åŠ ä»½ğŸ¥åˆ‡\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int price() &#123;</span><br><span class="line">        return super.price() + 2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒåŠ ä¸€ä»½çŒ•çŒ´æ¡ƒéœ€è¦åœ¨åŸæœ‰åŸºç¡€ä¸ŠåŠ 2å…ƒã€‚</p><p>æ¥ç€ç»§ç»­åˆ›å»ºè¥¿ç“œè£…é¥°å™¨WaterMelonDecoratorï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class WaterMelonDecorator extends AbstractDecorator &#123;</span><br><span class="line"></span><br><span class="line">    public WaterMelonDecorator(AbstractFruitSalad fruitSalad) &#123;</span><br><span class="line">        super(fruitSalad);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String remark() &#123;</span><br><span class="line">        return super.remark() + &quot;åŠ ä»½ğŸ‰åˆ‡\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int price() &#123;</span><br><span class="line">        return super.price() + 3;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ååˆ›å»ºå®¢æˆ·ç«¯Applicationæµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        &#x2F;&#x2F; ç‚¹äº†ä»½æ°´æœæ²™æ‹‰ï¼Œå¹¶åŠ äº†ä¸¤ä»½ğŸ¥å’Œä¸€ä»½ğŸ‰ï¼Œçœ‹çœ‹æœ€ç»ˆä»·æ ¼æ˜¯å¤šå°‘ï¼Ÿ</span><br><span class="line">        AbstractFruitSalad fruitSalad &#x3D; new FruitSalad();</span><br><span class="line">        fruitSalad &#x3D; new KiwiDecorator(fruitSalad);</span><br><span class="line">        fruitSalad &#x3D; new KiwiDecorator(fruitSalad);</span><br><span class="line">        fruitSalad &#x3D; new WaterMelonDecorator(fruitSalad);</span><br><span class="line"></span><br><span class="line">        System.out.println(fruitSalad.remark() + &quot;ä»·æ ¼æ˜¯ï¼š&quot; + fruitSalad.price());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„å†™æ³•ä¹Ÿå¯ä»¥æ”¹ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        &#x2F;&#x2F; ç‚¹äº†ä»½æ°´æœæ²™æ‹‰ï¼Œå¹¶åŠ äº†ä¸¤ä»½ğŸ¥å’Œä¸€ä»½ğŸ‰ï¼Œçœ‹çœ‹æœ€ç»ˆä»·æ ¼æ˜¯å¤šå°‘ï¼Ÿ</span><br><span class="line">        AbstractFruitSalad fruitSalad &#x3D; new FruitSalad();</span><br><span class="line">        fruitSalad &#x3D; new WaterMelonDecorator(new KiwiDecorator(new KiwiDecorator(fruitSalad)));</span><br><span class="line"></span><br><span class="line">        System.out.println(fruitSalad.remark() + &quot;ä»·æ ¼æ˜¯ï¼š&quot; + fruitSalad.price());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ°´æœğŸ¥—ï¼ˆæ ‡å‡†ï¼‰</span><br><span class="line">åŠ ä»½ğŸ¥åˆ‡</span><br><span class="line">åŠ ä»½ğŸ¥åˆ‡</span><br><span class="line">åŠ ä»½ğŸ‰åˆ‡</span><br><span class="line">ä»·æ ¼æ˜¯ï¼š16</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸åŒçš„è£…é¥°å™¨è‡ªç”±ç»„åˆï¼Œæˆ‘ä»¬å¯ä»¥çµæ´»çš„ç»„è£…å‡ºå„å¼å„æ ·çš„æ°´æœæ²™æ‹‰ï¼Œè¿™æ­£æ˜¯è£…é¥°è€…æ¨¡å¼çš„ä¼˜ç‚¹ï¼Œä½†æ˜æ˜¾å¯ä»¥çœ‹å‡ºä»£ç å˜å¤æ‚äº†ã€‚</p><p>è¿™ä¸ªä¾‹å­çš„UMLå›¾å¦‚ä¸‹æ‰€ç¤º:</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191218172739.png" alt="QQæˆªå›¾20191218172739.png"></p><h3 id="é€‚é…å™¨æ¨¡å¼"><a href="#é€‚é…å™¨æ¨¡å¼" class="headerlink" title="é€‚é…å™¨æ¨¡å¼"></a>é€‚é…å™¨æ¨¡å¼</h3><p>å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢ä¸ºæœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£ï¼Œä½¿åŸæœ¬ä¸å…¼å®¹çš„ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚</p><p>é€‚ç”¨äºï¼š</p><ol><li>å·²å­˜åœ¨çš„ç±»ï¼Œå®ƒçš„æ–¹æ³•å’Œéœ€æ±‚ä¸åŒ¹é…æ—¶ï¼ˆæ–¹æ³•ç»“æœç›¸åŒæˆ–è€…ç›¸ä¼¼ï¼‰</li></ol><p>ä¼˜ç‚¹:</p><ol><li>æé«˜ç±»çš„é€æ˜æ€§å’Œå¤ç”¨ï¼Œç°æœ‰çš„ç±»å¤ç”¨ä½†ä¸éœ€æ”¹å˜ï¼›</li><li>ç›®æ ‡ç±»å’Œé€‚é…å™¨ç±»è§£è€¦ï¼Œæé«˜ç¨‹åºæ‹“å±•æ€§ï¼›</li><li>ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>é€‚é…å™¨ç¼–å†™è¿‡ç¨‹éœ€è¦å…¨é¢è€ƒè™‘ï¼Œå¯èƒ½ä¼šå¢åŠ ç³»ç»Ÿçš„å¤æ‚æ€§ï¼›</li><li>é™ä½ä»£ç å¯è¯»æ€§ã€‚</li></ol><p>åˆ†ä¸ºï¼šç±»é€‚é…å™¨æ¨¡å¼å’Œå¯¹è±¡é€‚é…å™¨æ¨¡å¼ã€‚</p><p>å…ˆä¸¾ä¸ªç±»é€‚é…å™¨æ¨¡å¼çš„ä¾‹å­ï¼š</p><p>å‡å¦‚é¡¹ç›®é‡ŒåŸæœ‰ä¸€æ¡æ°´æœçš„äº§å“çº¿ï¼Œæ¯”å¦‚åŒ…å«ä¸€ä¸ªæ ‘è“ç±»Raspberryï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Raspberry &#123;</span><br><span class="line"></span><br><span class="line">    public void addRaspberry() &#123;</span><br><span class="line">        System.out.println(&quot;æ·»åŠ ç‚¹æ ‘è“&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éšç€é¡¹ç›®çš„æ‹“å±•ï¼Œç°åœ¨æ–°å¢äº†æ°´æœæ´¾äº§å“çº¿ï¼Œæ–°å»ºPieæ¥å£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface Pie &#123;</span><br><span class="line"></span><br><span class="line">    void make();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦å°†RaspberryåŠ å…¥åˆ°Pieäº§å“çº¿ï¼Œåˆä¸æƒ³ä¿®æ”¹Raspberryç±»çš„ä»£ç ï¼Œåˆ™å¯ä»¥åˆ›å»ºä¸€ä¸ªé€‚é…å™¨RaspberryPieAdaptorï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class RaspberryPieAdaptor extends Raspberry implements Pie&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void make() &#123;</span><br><span class="line">        System.out.println(&quot;åˆ¶ä½œä¸€ä¸ªæ´¾ğŸ¥§&quot;);</span><br><span class="line">        super.addRaspberry();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€‚é…å™¨ç»§æ‰¿è¢«é€‚é…çš„ç±»ï¼Œå®ç°æ–°çš„äº§å“çº¿æ¥å£ã€‚</p><p>åœ¨Applicationé‡Œæµ‹è¯•ä¸€æ³¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Pie pie &#x3D; new RaspberryPieAdaptor();</span><br><span class="line">        pie.make();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åˆ¶ä½œä¸€ä¸ªæ´¾ğŸ¥§</span><br><span class="line">æ·»åŠ ç‚¹æ ‘è“</span><br></pre></td></tr></table></figure><p>æˆåŠŸé€šè¿‡é€‚é…å™¨åˆ¶é€ äº†æ ‘è“æ´¾ã€‚ç±»é€‚é…å™¨æ¨¡å¼çš„UMLå›¾å¾ˆç®€å•ï¼š</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191219105058.png" alt="QQæˆªå›¾20191219105058.png"></p><p>å¯¹è±¡é€‚é…å™¨æ¨¡å¼åªéœ€è¦å°†RaspberryPieAdaptorä¿®æ”¹ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class RaspberryPieAdaptor implements Pie&#123;</span><br><span class="line"></span><br><span class="line">    private Raspberry raspberry &#x3D; new Raspberry();</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void make() &#123;</span><br><span class="line">        System.out.println(&quot;åˆ¶ä½œä¸€ä¸ªæ´¾ğŸ¥§&quot;);</span><br><span class="line">        raspberry.addRaspberry();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§æ¨¡å¼ä¸ç›´æ¥ç»§æ‰¿è¢«é€‚é…è€…ï¼Œè€Œæ˜¯åœ¨é€‚é…å™¨é‡Œåˆ›å»ºè¢«é€‚é…è€…ã€‚è¿™ç§æ¨¡å¼çš„UMLå›¾ï¼š</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191219110730.png" alt="QQæˆªå›¾20191219110730.png"></p><h3 id="äº«å…ƒæ¨¡å¼"><a href="#äº«å…ƒæ¨¡å¼" class="headerlink" title="äº«å…ƒæ¨¡å¼"></a>äº«å…ƒæ¨¡å¼</h3><p>æä¾›äº†å‡å°‘å¯¹è±¡æ•°é‡ä»è€Œæ”¹å–„åº”ç”¨æ‰€éœ€çš„å¯¹è±¡ç»“æ„çš„æ–¹å¼ï¼Œè¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚</p><p>é€‚ç”¨äºï¼š</p><ol><li>åº•å±‚ç³»ç»Ÿå¼€å‘ï¼Œè§£å†³æ€§èƒ½é—®é¢˜ï¼›</li><li>ç³»ç»Ÿæ‹¥æœ‰å¤§é‡ç›¸ä¼¼å¯¹è±¡ï¼Œéœ€è¦ç¼“å†²æ± çš„åœºæ™¯ã€‚</li></ol><p>ä¼˜ç‚¹ï¼š</p><ol><li>å‡å°‘å¯¹è±¡çš„åˆ›å»ºï¼Œé™ä½å†…å­˜å ç”¨ï¼›</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>å…³æ³¨å†…/å¤–éƒ¨çŠ¶æ€ï¼Œå…³æ³¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼›</li><li>ç¨‹åºçš„é€»è¾‘å¤æ‚åŒ–ã€‚</li></ol><p>å†…éƒ¨çŠ¶æ€ï¼šç®€å•ç†è§£ä¸ºäº«å…ƒå¯¹è±¡çš„å±æ€§çŠ¶æ€ï¼Œä¸ä¼šå› ä¸ºå¤–éƒ¨çš„æ”¹å˜è€Œæ”¹å˜ï¼› å¤–éƒ¨çŠ¶æ€ï¼šç®€å•ç†è§£ä¸ºæ–¹æ³•å‚æ•°ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæ–°å»ºæ´¾ğŸ¥§æ¥å£Pieï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface Pie &#123;</span><br><span class="line"></span><br><span class="line">    void make() throws InterruptedException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®ç°ç±»æ°´æœæ´¾FruitPieï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public class FruitPie implements Pie &#123;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line">    private LocalDateTime productTime;</span><br><span class="line"></span><br><span class="line">    public FruitPie(String name) &#123;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setProductTime(LocalDateTime productTime) &#123;</span><br><span class="line">        this.productTime &#x3D; productTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void make() &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Thread.sleep(100);</span><br><span class="line">            System.out.println(name + &quot;ç”Ÿäº§æ—¶é—´ï¼š&quot; + this.productTime);</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ…å«åç§°å’Œç”Ÿäº§æ—¥æœŸå±æ€§ï¼Œå¹¶ä¸”æœ‰ä¸ªmakeæ–¹æ³•ã€‚</p><p>æ¥ç€åˆ›å»ºç”Ÿäº§FruitPieçš„å·¥å‚FruitPieFactoryï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class FruitPieFactory &#123;</span><br><span class="line"></span><br><span class="line">    private static final HashMap&lt;String, FruitPie&gt; PIE_HASH_MAP &#x3D; new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    public static FruitPie produce(String name) &#123;</span><br><span class="line">        FruitPie fruitPie &#x3D; PIE_HASH_MAP.get(name);</span><br><span class="line">        if (fruitPie &#x3D;&#x3D; null) &#123;</span><br><span class="line">            System.out.println(&quot;æ²¡æœ‰&quot; + name + &quot;åˆ¶ä½œæ–¹æ³•ï¼Œå­¦ä¹ åˆ¶ä½œ...&quot;);</span><br><span class="line">            fruitPie &#x3D; new FruitPie(name);</span><br><span class="line">            PIE_HASH_MAP.put(name, fruitPie);</span><br><span class="line">        &#125;</span><br><span class="line">        return fruitPie;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç å…³é”®æ˜¯é€šè¿‡HashMapå­˜å‚¨å¯¹è±¡ã€‚</p><p>ç¼–å†™ä¸ªæµ‹è¯•ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    private static final String[] PIE &#x3D; &#123;&quot;ğŸ‡æ´¾&quot;, &quot;ğŸˆæ´¾&quot;, &quot;ğŸ“æ´¾&quot;, &quot;ğŸ’æ´¾&quot;&#125;;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        IntStream.range(0, 10).forEach((i) -&gt; &#123;</span><br><span class="line">            String name &#x3D; PIE[(int) (Math.random() * PIE.length)];</span><br><span class="line">            FruitPie fruitPie &#x3D; FruitPieFactory.produce(name);</span><br><span class="line">            fruitPie.setProductTime(LocalDateTime.now());</span><br><span class="line">            fruitPie.make();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">æ²¡æœ‰ğŸ“æ´¾åˆ¶ä½œæ–¹æ³•ï¼Œå­¦ä¹ åˆ¶ä½œ...</span><br><span class="line">ğŸ“æ´¾ç”Ÿäº§æ—¶é—´ï¼š2019-12-19T16:13:26.397</span><br><span class="line">æ²¡æœ‰ğŸ‡æ´¾åˆ¶ä½œæ–¹æ³•ï¼Œå­¦ä¹ åˆ¶ä½œ...</span><br><span class="line">ğŸ‡æ´¾ç”Ÿäº§æ—¶é—´ï¼š2019-12-19T16:13:26.498</span><br><span class="line">ğŸ‡æ´¾ç”Ÿäº§æ—¶é—´ï¼š2019-12-19T16:13:26.599</span><br><span class="line">æ²¡æœ‰ğŸ’æ´¾åˆ¶ä½œæ–¹æ³•ï¼Œå­¦ä¹ åˆ¶ä½œ...</span><br><span class="line">ğŸ’æ´¾ç”Ÿäº§æ—¶é—´ï¼š2019-12-19T16:13:26.700</span><br><span class="line">ğŸ’æ´¾ç”Ÿäº§æ—¶é—´ï¼š2019-12-19T16:13:26.800</span><br><span class="line">ğŸ’æ´¾ç”Ÿäº§æ—¶é—´ï¼š2019-12-19T16:13:26.901</span><br><span class="line">æ²¡æœ‰ğŸˆæ´¾åˆ¶ä½œæ–¹æ³•ï¼Œå­¦ä¹ åˆ¶ä½œ...</span><br><span class="line">ğŸˆæ´¾ç”Ÿäº§æ—¶é—´ï¼š2019-12-19T16:13:27.002</span><br><span class="line">ğŸ“æ´¾ç”Ÿäº§æ—¶é—´ï¼š2019-12-19T16:13:27.103</span><br><span class="line">ğŸ‡æ´¾ç”Ÿäº§æ—¶é—´ï¼š2019-12-19T16:13:27.203</span><br><span class="line">ğŸ‡æ´¾ç”Ÿäº§æ—¶é—´ï¼š2019-12-19T16:13:27.304</span><br></pre></td></tr></table></figure><p>ä»ç»“æœçœ‹ï¼Œåœ¨10æ¬¡å¾ªç¯ä¸­ï¼Œåªç”Ÿäº§äº†4ä¸ªå¯¹è±¡ï¼Œè¿™å¾ˆå¥½çš„æè¿°äº†ç³»ç»Ÿæœ‰å¤§é‡ç›¸ä¼¼å¯¹è±¡ï¼Œéœ€è¦ç¼“å†²æ± çš„åœºæ™¯ã€‚</p><p>JDKä¸­çš„å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œæ•°æ®åº“è¿æ¥æ± ç­‰éƒ½æ˜¯ç”¨çš„äº«å…ƒæ¨¡å¼ã€‚</p><h3 id="ç»„åˆæ¨¡å¼"><a href="#ç»„åˆæ¨¡å¼" class="headerlink" title="ç»„åˆæ¨¡å¼"></a>ç»„åˆæ¨¡å¼</h3><p>å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å®¢æˆ·ç«¯å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡ä¿æŒä¸€è‡´çš„æ–¹å¼å¤„ç†ã€‚</p><p>é€‚ç”¨äºï¼š</p><ol><li>å®¢æˆ·ç«¯å¯ä»¥å¿½ç•¥ç»„åˆå¯¹è±¡ä¸å•ä¸ªå¯¹è±¡çš„å·®å¼‚ï¼›</li><li>å¤„ç†æ ‘å½¢ç»“æ„æ•°æ®ã€‚</li></ol><p>ä¼˜ç‚¹:</p><ol><li>å±‚æ¬¡æ¸…æ™°ï¼›</li><li>å®¢æˆ·ç«¯ä¸å¿…å…³ç³»å±‚æ¬¡å·®å¼‚ï¼Œæ–¹ä¾¿æ§åˆ¶ï¼›</li><li>ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>æ ‘å½¢å¤„ç†è¾ƒä¸ºå¤æ‚ã€‚</li></ol><p>ä¸¾ä¸ªèœå•æŒ‰é’®ç»„æˆçš„æ ‘å½¢ä¾‹å­ã€‚</p><p>æ–°å»ºèœå•æŒ‰é’®çš„ç»„åˆæŠ½è±¡ç±»AbstractMenuButtonï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public abstract class AbstractMenuButton &#123;</span><br><span class="line"></span><br><span class="line">    public void add(AbstractMenuButton abstractMenuButton) &#123;</span><br><span class="line">        throw new UnsupportedOperationException(&quot;ä¸æ”¯æŒåˆ›å»ºæ“ä½œ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        throw new UnsupportedOperationException(&quot;ä¸æ”¯æŒåç§°è·å–&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getType() &#123;</span><br><span class="line">        throw new UnsupportedOperationException(&quot;ä¸æ”¯æŒç±»å‹è·å–&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getIcon() &#123;</span><br><span class="line">        throw new UnsupportedOperationException(&quot;ä¸æ”¯æŒå›¾æ ‡&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void print() &#123;</span><br><span class="line">        throw new UnsupportedOperationException(&quot;ä¸æ”¯æŒæ‰“å°æ“ä½œ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»„åˆäº†èœå•æŒ‰é’®æ“ä½œçš„åŸºæœ¬æ–¹æ³•ã€‚</p><p>æ–°å¢æŒ‰é’®ç±»Buttonï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public class Button extends AbstractMenuButton &#123;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    public Button(String name) &#123;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return this.name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getType() &#123;</span><br><span class="line">        return &quot;æŒ‰é’®&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void print() &#123;</span><br><span class="line">        System.out.println(getName() + &quot;ã€&quot; + getType() + &quot;ã€‘&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‰é’®æ‹¥æœ‰åç§°å±æ€§ï¼Œå¹¶ä¸”æ”¯æŒåç§°è·å–ï¼Œç±»å‹è·å–å’Œæ‰“å°æ–¹æ³•ï¼Œæ‰€ä»¥é‡å†™äº†è¿™ä¸‰ä¸ªçˆ¶ç±»æ–¹æ³•ã€‚</p><p>æ¥ç€æ–°å»ºèœå•ç±»Menuï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">public class Menu extends AbstractMenuButton &#123;</span><br><span class="line"></span><br><span class="line">    private List&lt;AbstractMenuButton&gt; items &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">    private String name;</span><br><span class="line">    private String icon;</span><br><span class="line">    private Integer level;</span><br><span class="line"></span><br><span class="line">    public Menu(String name, String icon, Integer level) &#123;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">        this.icon &#x3D; icon;</span><br><span class="line">        this.level &#x3D; level;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void add(AbstractMenuButton abstractMenuButton) &#123;</span><br><span class="line">        items.add(abstractMenuButton);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return this.name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getType() &#123;</span><br><span class="line">        return &quot;èœå•&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String getIcon() &#123;</span><br><span class="line">        return this.icon;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void print() &#123;</span><br><span class="line">        System.out.println(getIcon() + getName() + &quot;ã€&quot; + getType() + &quot;ã€‘&quot;);</span><br><span class="line">        for (AbstractMenuButton item : items) &#123;</span><br><span class="line">            if (this.level !&#x3D; null) &#123;</span><br><span class="line">                for (int i &#x3D; 0; i &lt; this.level; i++) &#123;</span><br><span class="line">                    System.out.print(&quot;    &quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            item.print();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>èœå•åŒ…å«åç§°ã€å›¾æ ‡å’Œå±‚çº§å±æ€§ï¼Œå¹¶ä¸”èœå•å¯ä»¥åŒ…å«ä¸‹çº§ï¼ˆæ¯”å¦‚ä¸‹çº§èœå•ï¼Œä¸‹çº§æŒ‰é’®ï¼‰ï¼Œæ‰€ä»¥å®ƒåŒ…å«ä¸€ä¸ªListç±»å‹çš„å±æ€§itemsã€‚</p><p>æ­¤å¤–ï¼Œèœå•åŒ…å«æ·»åŠ ä¸‹çº§ã€åç§°è·å–ã€ç±»å‹è·å–ã€å›¾æ ‡è·å–å’Œæ‰“å°æ–¹æ³•ã€‚</p><p>æ–°å»ºä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œæµ‹è¯•èœå•æŒ‰é’®çš„å±‚çº§ç»“æ„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Menu userMenu &#x3D; new Menu(&quot;ç”¨æˆ·ç®¡ç†&quot;, &quot;ğŸ§‘&quot;, 2);</span><br><span class="line">        Button createUser &#x3D; new Button(&quot;æ–°å¢ç”¨æˆ·&quot;);</span><br><span class="line">        Button updateUser &#x3D; new Button(&quot;ä¿®æ”¹ç”¨æˆ·&quot;);</span><br><span class="line">        Button deleteUser &#x3D; new Button(&quot;åˆ é™¤ç”¨æˆ·&quot;);</span><br><span class="line">        userMenu.add(createUser);</span><br><span class="line">        userMenu.add(updateUser);</span><br><span class="line">        userMenu.add(deleteUser);</span><br><span class="line"></span><br><span class="line">        Menu logMenu &#x3D; new Menu(&quot;æ“ä½œæ—¥å¿—&quot;, &quot;ğŸ“ƒ&quot;, 2);</span><br><span class="line">        Button export &#x3D; new Button(&quot;å¯¼å‡ºExcel&quot;);</span><br><span class="line">        logMenu.add(export);</span><br><span class="line"></span><br><span class="line">        Menu systemMenu &#x3D; new Menu(&quot;ç³»ç»Ÿç®¡ç†&quot;, &quot;ğŸ”¨&quot;, 1);</span><br><span class="line">        systemMenu.add(userMenu);</span><br><span class="line">        systemMenu.add(logMenu);</span><br><span class="line"></span><br><span class="line">        systemMenu.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰“å°è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ğŸ”¨ç³»ç»Ÿç®¡ç†ã€èœå•ã€‘</span><br><span class="line">    ğŸ§‘ç”¨æˆ·ç®¡ç†ã€èœå•ã€‘</span><br><span class="line">        æ–°å¢ç”¨æˆ·ã€æŒ‰é’®ã€‘</span><br><span class="line">        ä¿®æ”¹ç”¨æˆ·ã€æŒ‰é’®ã€‘</span><br><span class="line">        åˆ é™¤ç”¨æˆ·ã€æŒ‰é’®ã€‘</span><br><span class="line">    ğŸ“ƒæ“ä½œæ—¥å¿—ã€èœå•ã€‘</span><br><span class="line">        å¯¼å‡ºExcelã€æŒ‰é’®ã€‘</span><br></pre></td></tr></table></figure><p>UMLå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191219190427.png" alt="QQæˆªå›¾20191219190427.png"></p><h3 id="æ¡¥æ¥æ¨¡å¼"><a href="#æ¡¥æ¥æ¨¡å¼" class="headerlink" title="æ¡¥æ¥æ¨¡å¼"></a>æ¡¥æ¥æ¨¡å¼</h3><p>å°†æŠ½è±¡éƒ¨åˆ†å’Œå…·ä½“å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚é€šè¿‡ç»„åˆçš„æ–¹å¼å»ºç«‹ä¸¤ä¸ªç±»ä¹‹é—´çš„å…³ç³»ï¼Œè€Œä¸æ˜¯é€šè¿‡ç»§æ‰¿ã€‚</p><p>é€‚ç”¨äºï¼š</p><ol><li>æŠ½è±¡å’Œå®ä½“å®ç°ä¹‹é—´å¢åŠ æ›´å¤šçš„çµæ´»æ€§ï¼›</li><li>ä¸€ä¸ªç±»å­˜åœ¨å¤šä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œå¹¶ä¸”éœ€è¦ç‹¬ç«‹æ‹“å±•ï¼›</li><li>ä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿ã€‚</li></ol><p>ä¼˜ç‚¹ï¼š</p><ol><li>åˆ†ç¦»æŠ½è±¡éƒ¨åˆ†å’Œå…·ä½“å®ç°éƒ¨åˆ†ï¼›</li><li>æé«˜äº†ç³»ç»Ÿå¯æ‹“å±•æ€§ï¼›</li><li>ç¬¦åˆå¼€é—­åŸåˆ™å’Œåˆæˆå¤ç”¨åŸåˆ™ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>å¢åŠ äº†ç³»ç»Ÿçš„ç†è§£å’Œè®¾è®¡éš¾åº¦ï¼›</li></ol><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><p>ç°æœ‰æ´¾çš„æ¥å£ç±»Pieï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface Pie &#123;</span><br><span class="line"></span><br><span class="line">    Pie makePie();</span><br><span class="line"></span><br><span class="line">    void getType();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ…å«åˆ¶ä½œæ´¾å’Œè·å–æ´¾ç±»å‹æŠ½è±¡æ–¹æ³•ã€‚</p><p>æ¥ç€åˆ›å»ºä¸¤ä¸ªPieçš„å®ç°ç±»ï¼Œè‹¹æœæ´¾AppliePieï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class ApplePie implements Pie &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Pie makePie() &#123;</span><br><span class="line">        System.out.println(&quot;åˆ¶ä½œè‹¹æœæ´¾ğŸğŸ¥§&quot;);</span><br><span class="line">        return new ApplePie();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void getType() &#123;</span><br><span class="line">        System.out.println(&quot;æ°´æœæ´¾&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>èƒ¡èåœæ´¾CarrotPieï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class CarrotPie implements Pie&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Pie makePie() &#123;</span><br><span class="line">        System.out.println(&quot;åˆ¶ä½œèƒ¡èåœæ´¾ğŸ¥•ğŸ¥§&quot;);</span><br><span class="line">        return new CarrotPie();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void getType() &#123;</span><br><span class="line">        System.out.println(&quot;è”¬èœæ²™æ‹‰æ´¾&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€åˆ›å»ºä¸€ä¸ªåº—é“ºæŠ½è±¡ç±»Storeï¼Œé€šè¿‡å±æ€§çš„æ–¹å¼å’ŒPieç›¸å…³è”ï¼Œç›®çš„æ˜¯å¯ä»¥åœ¨ä¸åŒçš„åº—é“ºå®ç°ç±»ä¸­çµæ´»åœ°åˆ¶ä½œå„ç§æ´¾ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public abstract class Store &#123;</span><br><span class="line"></span><br><span class="line">    protected Pie pie;</span><br><span class="line"></span><br><span class="line">    public Store(Pie pie)&#123;</span><br><span class="line">        this.pie &#x3D; pie;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    abstract Pie makePie();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Storeå­ç±»ä¹‹ä¸€ï¼Œå±±å§†å¤§å”çš„å°åº—SamStoreï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class SamStore extends Store&#123;</span><br><span class="line"></span><br><span class="line">    public SamStore(Pie pie) &#123;</span><br><span class="line">        super(pie);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    Pie makePie() &#123;</span><br><span class="line">        System.out.print(&quot;å±±å§†å¤§å”çš„å°åº—ğŸ’’&quot;);</span><br><span class="line">        return pie.makePie();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Storeå­ç±»ä¹‹äºŒï¼Œæ°å…‹çš„å°åº—JackStoreï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class JackStore extends Store &#123;</span><br><span class="line"></span><br><span class="line">    public JackStore(Pie pie) &#123;</span><br><span class="line">        super(pie);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    Pie makePie() &#123;</span><br><span class="line">        System.out.print(&quot;æ°å…‹çš„å°åº—ğŸ’’&quot;);</span><br><span class="line">        return pie.makePie();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œæµ‹è¯•Pieçš„å®ç°ç±»å’ŒStoreçš„ç»§æ‰¿ç±»ä¹‹é—´çš„è‡ªç”±ç»„åˆï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Store samStore &#x3D; new SamStore(new ApplePie());</span><br><span class="line">        Pie samStorePie &#x3D; samStore.makePie();</span><br><span class="line">        samStorePie.getType();</span><br><span class="line"></span><br><span class="line">        Store jackStore &#x3D; new JackStore(new CarrotPie());</span><br><span class="line">        Pie jackStorePie &#x3D; jackStore.makePie();</span><br><span class="line">        jackStorePie.getType();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å±±å§†å¤§å”çš„å°åº—ğŸ’’åˆ¶ä½œè‹¹æœæ´¾ğŸğŸ¥§</span><br><span class="line">æ°´æœæ´¾</span><br><span class="line">æ°å…‹çš„å°åº—ğŸ’’åˆ¶ä½œèƒ¡èåœæ´¾ğŸ¥•ğŸ¥§</span><br><span class="line">è”¬èœæ²™æ‹‰æ´¾</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­å¾ˆå¥½åœ°ä½“ç°äº†æ¡¥æ¥æ¨¡å¼çš„ç‰¹ç‚¹ï¼ŒUMLå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://mrbird.cc/img/QQ%E6%88%AA%E5%9B%BE20191220151943.png" alt="QQæˆªå›¾20191220151943.png"></p><h3 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h3><p>ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ï¼Œä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ï¼Œä»£ç†å¯¹è±¡åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°äº†ä¸­ä»‹çš„ä½œç”¨ã€‚</p><p>é€‚ç”¨äºï¼š</p><ol><li>ä¿æŠ¤ç›®æ ‡å¯¹è±¡ï¼›</li><li>å¢å¼ºç›®æ ‡å¯¹è±¡ã€‚</li></ol><p>ä¼˜ç‚¹ï¼š</p><ol><li>å°†ä»£ç†å¯¹è±¡å’ŒçœŸå®è¢«è°ƒç”¨çš„ç›®æ ‡å¯¹è±¡åˆ†ç¦»ï¼›</li><li>é™ä½è€¦åˆï¼Œæ‹“å±•æ€§å¥½ï¼›</li><li>ä¿æŠ¤ç›®æ ‡å¯¹è±¡ï¼Œå¢å¼ºç›®æ ‡å¯¹è±¡ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>é€ æˆç±»çš„æ•°ç›®å¢åŠ ï¼Œå¢åŠ å¤æ‚åº¦ï¼›</li><li>å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡å¢åŠ ä»£ç†å¯¹è±¡ï¼Œä¼šé€ æˆå¤„ç†é€Ÿåº¦å˜æ…¢ã€‚</li></ol><h4 id="é™æ€ä»£ç†"><a href="#é™æ€ä»£ç†" class="headerlink" title="é™æ€ä»£ç†"></a>é™æ€ä»£ç†</h4><p>é€šè¿‡åœ¨ä»£ç ä¸­æ˜¾å¼åœ°å®šä¹‰äº†ä¸€ä¸ªä»£ç†ç±»ï¼Œåœ¨ä»£ç†ç±»ä¸­é€šè¿‡åŒåçš„æ–¹æ³•å¯¹ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•è¿›è¡ŒåŒ…è£…ï¼Œå®¢æˆ·ç«¯é€šè¿‡è°ƒç”¨ä»£ç†ç±»çš„æ–¹æ³•æ¥è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ã€‚</p><p>ä¸¾ä¸ªé™æ€ä»£ç†çš„ä¾‹å­ï¼š</p><p>æ–°å»ºä¸€ä¸ªæ´¾çš„åˆ¶ä½œæ¥å£PieServiceï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface PieServcie &#123;</span><br><span class="line">    void makePie();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå…¶å®ç°ç±»PieServiceImplï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class PieServiceImpl implements PieServcie&#123;</span><br><span class="line">    public void makePie() &#123;</span><br><span class="line">        System.out.println(&quot;åˆ¶ä½œğŸ¥—æ´¾&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦å¯¹PieServiceImplçš„<code>makePie</code>æ–¹æ³•å¢å¼ºï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡PieServiceProxyï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class PieServiceProxy &#123;</span><br><span class="line"></span><br><span class="line">    private PieServcie pieServcie;</span><br><span class="line"></span><br><span class="line">    public void makePie() &#123;</span><br><span class="line">        beforeMethod();</span><br><span class="line">        pieServcie &#x3D; new PieServiceImpl();</span><br><span class="line">        pieServcie.makePie();</span><br><span class="line">        afterMethod();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void beforeMethod() &#123;</span><br><span class="line">        System.out.println(&quot;å‡†å¤‡ææ–™&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void afterMethod() &#123;</span><br><span class="line">        System.out.println(&quot;ä¿é²œ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨PieServiceProxyä¸­æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå’ŒPieServcieä¸€è‡´çš„åŒåæ–¹æ³•<code>makePie</code>ï¼Œæ–¹æ³•å†…éƒ¨è°ƒç”¨äº†PieServiceImplçš„<code>makePie</code>æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨æ–¹æ³•è°ƒç”¨å‰è°ƒç”¨äº†ä»£ç†ç±»çš„<code>beforeMethod</code>æ–¹æ³•ï¼Œæ–¹æ³•è°ƒç”¨åè°ƒç”¨äº†ä»£ç†ç±»çš„<code>afterMethod</code>æ–¹æ³•ã€‚</p><p>åˆ›å»ºå®¢æˆ·ç«¯Applicationï¼Œæµ‹è¯•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        PieServiceProxy proxy &#x3D; new PieServiceProxy();</span><br><span class="line">        proxy.makePie();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å‡†å¤‡ææ–™</span><br><span class="line">åˆ¶ä½œğŸ¥—æ´¾</span><br><span class="line">ä¿é²œ</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­çš„UMLå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://mrbird.cc/img/QQ20200421-100633@2x.png" alt="QQ20200421-100633@2x"></p><h4 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h4><p>JDKçš„åŠ¨æ€ä»£ç†åªèƒ½ä»£ç†æ¥å£ï¼Œé€šè¿‡æ¥å£çš„æ–¹æ³•ååœ¨åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»ä¸­è°ƒç”¨ä¸šåŠ¡å®ç°ç±»çš„åŒåæ–¹æ³•ã€‚</p><p>é™æ€ä»£ç†çš„ç¼ºç‚¹å°±æ˜¯æ¯éœ€è¦ä»£ç†ä¸€ä¸ªç±»ï¼Œå°±éœ€è¦æ‰‹å†™å¯¹åº”çš„ä»£ç†ç±»ã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥ç”¨åŠ¨æ€ä»£ç†æ¥è§£å†³ã€‚ä¸¾ä¸ªåŠ¨æ€ä»£ç†çš„ä¾‹å­ï¼š</p><p>æ–°å»ºå†°æ·‡æ·‹åˆ¶ä½œæ¥å£IceCreamServiceï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public interface IceCreamService &#123;</span><br><span class="line">    void makeIceCream(String fruit);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ç°ç±»IceCreamServiceImplï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class IceCreamServiceImpl implements IceCreamService &#123;</span><br><span class="line"></span><br><span class="line">    public void makeIceCream(String fruit) &#123;</span><br><span class="line">        System.out.println(&quot;åˆ¶ä½œ&quot; + fruit + &quot;ğŸ¦&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨éœ€è¦å¯¹IceCreamServiceImplè¿›è¡Œä»£ç†å¢å¼ºï¼Œå¦‚æœä½¿ç”¨é™æ€ä»£ç†ï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªIceCreamServiceImplProxyç±»ï¼Œä½¿ç”¨åŠ¨æ€ä»£ç†çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åŠ¨æ€ç”Ÿæˆå¯¹åº”çš„ä»£ç†ç±»ã€‚</p><p>åˆ›å»ºDynamicProxyï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">public class DynamicProxy implements InvocationHandler &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; ä»£ç†çš„ç›®æ ‡å¯¹è±¡</span><br><span class="line">    private Object object;</span><br><span class="line"></span><br><span class="line">    public DynamicProxy(Object object) &#123;</span><br><span class="line">        this.object &#x3D; object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Object proxy() &#123;</span><br><span class="line">        Class&lt;?&gt; clazz &#x3D; object.getClass();</span><br><span class="line">        &#x2F;&#x2F; ç”Ÿæˆä»£ç†å¯¹è±¡</span><br><span class="line">        return Proxy.newProxyInstance(clazz.getClassLoader(),</span><br><span class="line">                clazz.getInterfaces(), this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * @param proxy  åŠ¨æ€ç”Ÿæˆçš„ä»£ç†å¯¹è±¡</span><br><span class="line">     * @param method ä»£ç†æ–¹æ³•</span><br><span class="line">     * @param args   ä»£ç†æ–¹æ³•çš„æ–¹æ³•å‚æ•°</span><br><span class="line">     * @return ç»“æœ</span><br><span class="line">     * @throws Throwable</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;</span><br><span class="line">       return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ¨æ€ä»£ç†ç±»é€šè¿‡å®ç°InvocationHandlerçš„<code>invoke</code>æ–¹æ³•å®ç°ï¼Œ<code>proxy</code>ç”¨äºç”Ÿæˆä»£ç†å¯¹è±¡ã€‚å‰©ä¸‹çš„æ­¥éª¤å’Œé™æ€ä»£ç†ç±»ä¼¼ï¼Œå®Œå–„DynamicProxyï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">public class DynamicProxy implements InvocationHandler &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; ä»£ç†çš„ç›®æ ‡å¯¹è±¡</span><br><span class="line">    private Object object;</span><br><span class="line"></span><br><span class="line">    public DynamicProxy(Object object) &#123;</span><br><span class="line">        this.object &#x3D; object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Object proxy() &#123;</span><br><span class="line">        Class&lt;?&gt; clazz &#x3D; object.getClass();</span><br><span class="line">        &#x2F;&#x2F; ç”Ÿæˆä»£ç†å¯¹è±¡</span><br><span class="line">        return Proxy.newProxyInstance(clazz.getClassLoader(),</span><br><span class="line">                clazz.getInterfaces(), this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * @param proxy  åŠ¨æ€ç”Ÿæˆçš„ä»£ç†å¯¹è±¡</span><br><span class="line">     * @param method ä»£ç†æ–¹æ³•</span><br><span class="line">     * @param args   ä»£ç†æ–¹æ³•çš„æ–¹æ³•å‚æ•°</span><br><span class="line">     * @return ç»“æœ</span><br><span class="line">     * @throws Throwable</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;</span><br><span class="line">        beforeMethod(object);</span><br><span class="line">        &#x2F;&#x2F; åå°„æ‰§è¡Œä»£ç†å¯¹è±¡çš„ç›®æ ‡æ–¹æ³•</span><br><span class="line">        Object result &#x3D; method.invoke(object, args);</span><br><span class="line">        afterMethod(object);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void beforeMethod(Object object) &#123;</span><br><span class="line">        if (object instanceof PieServcie) &#123;</span><br><span class="line">            System.out.println(&quot;å‡†å¤‡æ´¾çš„ææ–™&quot;);</span><br><span class="line">        &#125; else if (object instanceof IceCreamService) &#123;</span><br><span class="line">            System.out.println(&quot;å‡†å¤‡å†°æ·‡æ·‹ææ–™&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            throw new RuntimeException(&quot;æš‚ä¸æ”¯æŒä»£ç†&quot; + object.getClass() + &quot;ç±»å‹&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void afterMethod(Object object) &#123;</span><br><span class="line">        if (object instanceof PieServcie) &#123;</span><br><span class="line">            System.out.println(&quot;ä¿é²œæ´¾&quot;);</span><br><span class="line">        &#125; else if (object instanceof IceCreamService) &#123;</span><br><span class="line">            System.out.println(&quot;ä¿é²œå†°æ·‡æ·‹&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            throw new RuntimeException(&quot;æš‚ä¸æ”¯æŒä»£ç†&quot; + object.getClass() + &quot;ç±»å‹&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå®¢æˆ·ç«¯Applicationæµ‹è¯•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        PieServcie pieServiceDynamicProxy &#x3D; (PieServcie) new DynamicProxy(new PieServiceImpl()).proxy();</span><br><span class="line">        pieServiceDynamicProxy.makePie();</span><br><span class="line">        System.out.println(&quot;-----------------&quot;);</span><br><span class="line">        IceCreamService iceCreamServiceDynamicProxy &#x3D; (IceCreamService) new DynamicProxy(new IceCreamServiceImpl()).proxy();</span><br><span class="line">        iceCreamServiceDynamicProxy.makeIceCream(&quot;ğŸ“&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å‡†å¤‡æ´¾çš„ææ–™</span><br><span class="line">åˆ¶ä½œğŸ¥—æ´¾</span><br><span class="line">ä¿é²œæ´¾</span><br><span class="line">-----------------</span><br><span class="line">å‡†å¤‡å†°æ·‡æ·‹ææ–™</span><br><span class="line">åˆ¶ä½œğŸ“ğŸ¦</span><br><span class="line">ä¿é²œå†°æ·‡æ·‹</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡åŠ¨æ€ä»£ç†æˆ‘ä»¬å®ç°äº†ç›®æ ‡æ–¹æ³•å¢å¼ºï¼Œå¹¶ä¸”ä¸éœ€è¦æ‰‹å†™ç›®æ ‡ç±»çš„ä»£ç†å¯¹è±¡ã€‚</p><h4 id="CGLibä»£ç†"><a href="#CGLibä»£ç†" class="headerlink" title="CGLibä»£ç†"></a>CGLibä»£ç†</h4><p>é€šè¿‡ç»§æ‰¿æ¥å®ç°ï¼Œç”Ÿæˆçš„ä»£ç†ç±»å°±æ˜¯ç›®æ ‡å¯¹è±¡ç±»çš„å­ç±»ï¼Œé€šè¿‡é‡å†™ä¸šåŠ¡æ–¹æ³•æ¥å®ç°ä»£ç†ã€‚</p><h4 id="Springå¯¹ä»£ç†æ¨¡å¼çš„æ‹“å±•"><a href="#Springå¯¹ä»£ç†æ¨¡å¼çš„æ‹“å±•" class="headerlink" title="Springå¯¹ä»£ç†æ¨¡å¼çš„æ‹“å±•"></a>Springå¯¹ä»£ç†æ¨¡å¼çš„æ‹“å±•</h4><ol><li>å½“Beanæœ‰å®ç°æ¥å£æ—¶ï¼Œä½¿ç”¨JDKåŠ¨æ€ä»£ç†ï¼›</li><li>å½“Beanæ²¡æœ‰å®ç°æ¥å£æ—¶ï¼Œä½¿ç”¨CGLibä»£ç†ã€‚</li></ol><p>å¯ä»¥é€šè¿‡ä»¥ä¸‹é…ç½®å¼ºåˆ¶ä½¿ç”¨CGLibä»£ç†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  aop:</span><br><span class="line">    proxy-target-class: true</span><br></pre></td></tr></table></figure><h2 id="è¡Œä¸ºå‹æ¨¡å¼"><a href="#è¡Œä¸ºå‹æ¨¡å¼" class="headerlink" title="è¡Œä¸ºå‹æ¨¡å¼"></a>è¡Œä¸ºå‹æ¨¡å¼</h2><h3 id="æ¨¡æ¿æ–¹æ³•æ¨¡å¼"><a href="#æ¨¡æ¿æ–¹æ³•æ¨¡å¼" class="headerlink" title="æ¨¡æ¿æ–¹æ³•æ¨¡å¼"></a>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h3><p>æ¨¡æ¿æ–¹æ³•æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªæµç¨‹çš„éª¨æ¶ï¼Œç”±å¤šä¸ªæ–¹æ³•ç»„æˆã€‚å¹¶å…è®¸å­ç±»ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªæ­¥éª¤æä¾›å®ç°ã€‚ç®€è€Œè¨€ä¹‹å°±æ˜¯å…¬å…±çš„ä¸å˜çš„éƒ¨åˆ†ç”±çˆ¶ç±»ç»Ÿä¸€å®ç°ï¼Œå˜åŒ–çš„éƒ¨åˆ†ç”±å­ç±»æ¥ä¸ªæ€§åŒ–å®ç°ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ol><li>æé«˜å¤ç”¨æ€§ï¼›</li><li>æé«˜æ‹“å±•æ€§ï¼›</li><li>ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>ç±»çš„æ•°ç›®å¢åŠ ï¼›</li><li>å¢åŠ äº†ç³»ç»Ÿå®ç°çš„å¤æ‚åº¦ï¼›</li><li>çˆ¶ç±»æ·»åŠ æ–°çš„æŠ½è±¡æ–¹æ³•ï¼Œæ‰€æœ‰å­ç±»éƒ½è¦æ”¹ä¸€éã€‚</li></ol><p>ä¸¾ä¸ªæ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„ä¾‹å­ã€‚å®šä¹‰ä¸€ä¸ªå¤–å–çš„æ¥å£ï¼ŒåŒ…å«ä¸‹å•ã€åˆ¶ä½œå’Œæ‰“åŒ…é…é€ä¸‰ä¸ªæ­¥éª¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public abstract class Takeaway &#123;</span><br><span class="line"></span><br><span class="line">    final void order() &#123;</span><br><span class="line">        System.out.println(&quot;ä¸‹å•&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    final void packageSend() &#123;</span><br><span class="line">        System.out.println(&quot;æ‰“åŒ…æ´¾é€&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected abstract void make();</span><br><span class="line"></span><br><span class="line">    protected boolean needTableware() &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    final void flow() &#123;</span><br><span class="line">        this.order();</span><br><span class="line">        this.make();</span><br><span class="line">        if (needTableware()) &#123;</span><br><span class="line">            System.out.println(&quot;èµ é€ä¸€æ¬¡æ€§é¤å…·&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        this.packageSend();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ä¸‹å•å’Œæ‰“åŒ…é…é€è¡Œä¸ºæ˜¯å›ºå®šçš„ï¼Œä¸åŒçš„æ˜¯åˆ¶ä½œè¿‡ç¨‹ï¼Œæ‰€ä»¥<code>order</code>å’Œ<code>packageSend</code>æ–¹æ³•æä¾›äº†é»˜è®¤å®ç°ï¼Œå¹¶ä¸”ç”±finalä¿®é¥°ï¼Œå­ç±»ä¸å¯é‡å†™ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡<code>needTableware</code>è¿™ä¸ªé’©å­æ–¹æ³•æ¥æ§åˆ¶æŸäº›å­ç±»çš„å®šåˆ¶åŒ–éœ€æ±‚ã€‚</p><p>æ–°å¢BarbecueTakeawayç»§æ‰¿Takeawayï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public class BarbecueTakeaway extends Takeaway &#123;</span><br><span class="line"></span><br><span class="line">    private final boolean needTableware;</span><br><span class="line"></span><br><span class="line">    public BarbecueTakeaway(boolean needTableware) &#123;</span><br><span class="line">        this.needTableware &#x3D; needTableware;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void make() &#123;</span><br><span class="line">        System.out.println(&quot;åˆ¶ä½œçƒ¤è‚‰&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected boolean needTableware() &#123;</span><br><span class="line">        return this.needTableware;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å¢FruitTakeawayç»§æ‰¿Takeawayï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class FruitTakeaway extends Takeaway &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void make() &#123;</span><br><span class="line">        System.out.println(&quot;æ°´æœé…è´§&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected boolean needTableware() &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å¢ä¸ªå®¢æˆ·ç«¯Applicationæµ‹è¯•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Takeaway barbecue &#x3D; new BarbecueTakeaway(true);</span><br><span class="line">        barbecue.flow();</span><br><span class="line"></span><br><span class="line">        FruitTakeaway fruit &#x3D; new FruitTakeaway();</span><br><span class="line">        fruit.flow();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹å•</span><br><span class="line">åˆ¶ä½œçƒ¤è‚‰</span><br><span class="line">èµ é€ä¸€æ¬¡æ€§é¤å…·</span><br><span class="line">æ‰“åŒ…æ´¾é€</span><br><span class="line">ä¸‹å•</span><br><span class="line">æ°´æœé…è´§</span><br><span class="line">æ‰“åŒ…æ´¾é€</span><br></pre></td></tr></table></figure><p>UMLï¼š</p><p><img src="https://mrbird.cc/img/QQ20200421-153516@2x.png" alt="QQ20200421-153516@2x"></p><h3 id="è¿­ä»£å™¨æ¨¡å¼"><a href="#è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="è¿­ä»£å™¨æ¨¡å¼"></a>è¿­ä»£å™¨æ¨¡å¼</h3><p>ignore</p><h3 id="ç­–ç•¥æ¨¡å¼"><a href="#ç­–ç•¥æ¨¡å¼" class="headerlink" title="ç­–ç•¥æ¨¡å¼"></a>ç­–ç•¥æ¨¡å¼</h3><p>ç­–ç•¥æ¨¡å¼å®šä¹‰äº†ç®—æ³•å®¶æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©å®ƒä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ã€‚æ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ä¸ä¼šå½±å“åˆ°ä½¿ç”¨ç®—æ³•çš„ç”¨æˆ·ã€‚ç­–ç•¥æ¨¡å¼å¸¸ç”¨äºæ¶ˆé™¤å¤§é‡çš„if elseä»£ç ã€‚</p><p>é€‚ç”¨åœºæ™¯ï¼š</p><ol><li>ç³»ç»Ÿæœ‰å¾ˆå¤šç±»ï¼Œå®ƒä»¬çš„åŒºåˆ«ä»…ä»…åœ¨äºè¡Œä¸ºä¸åŒï¼›</li><li>ä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§ï¼›</li></ol><p>ä¸¾ä¸ªç­–ç•¥æ¨¡å¼çš„ä¾‹å­ï¼ˆä¿ƒé”€æ´»åŠ¨ï¼‰ï¼Œå®šä¹‰ä¸€ä¸ªä¿ƒé”€ç­–ç•¥æ¥å£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public interface PromotionStrategy &#123;</span><br><span class="line"></span><br><span class="line">    void promotion();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ç°ç±»ä¹‹ä¸€ï¼ˆç­–ç•¥ä¹‹ä¸€ï¼‰ï¼Œæ»¡å‡ä¿ƒé”€ç­–ç•¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class FullReductionPromotionStrategy implements PromotionStrategy &#123;</span><br><span class="line">    public void promotion() &#123;</span><br><span class="line">        System.out.println(&quot;æ»¡1000ç«‹å‡1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ç°ç±»ä¹‹ä¸€ï¼ˆç­–ç•¥ä¹‹ä¸€ï¼‰ï¼Œæ‰“æŠ˜ä¿ƒé”€ç­–ç•¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class DiscountPromotionStrategy implements PromotionStrategy &#123;</span><br><span class="line">    public void promotion() &#123;</span><br><span class="line">        System.out.println(&quot;9.9æŠ˜é’œæƒ &quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯æµ‹è¯•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        &#x2F;&#x2F; æ¨¡æ‹Ÿå®¢æˆ·ç«¯ä¼ é€’çš„ä¿ƒé”€ç­–ç•¥key</span><br><span class="line">        String promotionKey &#x3D; &quot;fr&quot;;</span><br><span class="line">        PromotionStrategy strategy;</span><br><span class="line">        if (&quot;fr&quot;.equals(promotionKey)) &#123;</span><br><span class="line">            strategy &#x3D; new FullReductionPromotionStrategy();</span><br><span class="line">        &#125; else if (&quot;ds&quot;.equals(promotionKey)) &#123;</span><br><span class="line">            strategy &#x3D; new DiscountPromotionStrategy();</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            throw new RuntimeException(&quot;æš‚ä¸æ”¯æŒè¯¥ä¿ƒé”€æ´»åŠ¨&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        strategy.promotion();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ»¡1000ç«‹å‡1</span><br></pre></td></tr></table></figure><p>ç­–ç•¥æ¨¡å¼å¸¸ç»“åˆå·¥å‚æ¨¡å¼æ¥æ¶ˆé™¤å¤§é‡çš„if elseä»£ç ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªä¿ƒé”€ç­–ç•¥çš„åˆ›å»ºå·¥å‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public class PromotionStrategyFactory &#123;</span><br><span class="line"></span><br><span class="line">    private static final Map&lt;String, PromotionStrategy&gt; PROMOTION_STRATEGY_MAP &#x3D; new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    private static final PromotionStrategy NON_PROMOTION &#x3D; () -&gt; System.out.println(&quot;æ— ä¿ƒé”€æ´»åŠ¨&quot;);</span><br><span class="line"></span><br><span class="line">    static &#123;</span><br><span class="line">        PROMOTION_STRATEGY_MAP.put(PromotionKey.FR, new FullReductionPromotionStrategy());</span><br><span class="line">        PROMOTION_STRATEGY_MAP.put(PromotionKey.DS, new DiscountPromotionStrategy());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private PromotionStrategyFactory() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static PromotionStrategy getPromotionStrategy(String promotionKey) &#123;</span><br><span class="line">        PromotionStrategy strategy &#x3D; PROMOTION_STRATEGY_MAP.get(promotionKey);</span><br><span class="line">        return strategy &#x3D;&#x3D; null ? NON_PROMOTION : strategy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private interface PromotionKey &#123;</span><br><span class="line">        String FR &#x3D; &quot;fr&quot;;</span><br><span class="line">        String DS &#x3D; &quot;ds&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡Mapæ¥è£…è½½ä¿ƒé”€ç­–ç•¥ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å¯¹è±¡çš„é‡å¤åˆ›å»ºã€‚å¦‚æœä¸å¸Œæœ›åœ¨staticå—ä¸­ä¸€æ¬¡æ€§åˆå§‹åŒ–æ‰€æœ‰ä¿ƒé”€ç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆäº«å…ƒæ¨¡å¼æ¥æ¨è¿Ÿå¯¹è±¡åˆ›å»ºè¿‡ç¨‹ã€‚</p><p>é€šè¿‡è¿™ä¸ªå·¥å‚æ–¹æ³•ï¼Œä¸Šé¢å®¢æˆ·ç«¯ä»£ç å¯ä»¥ç®€å†™ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        &#x2F;&#x2F; æ¨¡æ‹Ÿå®¢æˆ·ç«¯ä¼ é€’çš„ä¿ƒé”€ç­–ç•¥key</span><br><span class="line">        String promotionKey &#x3D; &quot;fr&quot;;</span><br><span class="line">        PromotionStrategy promotionStrategy &#x3D; PromotionStrategyFactory.getPromotionStrategy(promotionKey);</span><br><span class="line">        promotionStrategy.promotion();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è§£é‡Šå™¨æ¨¡å¼"><a href="#è§£é‡Šå™¨æ¨¡å¼" class="headerlink" title="è§£é‡Šå™¨æ¨¡å¼"></a>è§£é‡Šå™¨æ¨¡å¼</h3><p>ç”¨çš„è¾ƒå°‘ï¼Œæš‚ä¸è®°å½•ã€‚</p><h3 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h3><p>è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰äº†å¯¹è±¡ä¹‹é—´çš„ä¸€å¯¹å¤šä¾èµ–ï¼Œè®©å¤šä¸ªè§‚å¯Ÿè€…åŒæ—¶ç›‘å¬æŸä¸ªä¸»é¢˜å¯¹è±¡ï¼Œå½“ä¸»ä½“å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒçš„æ‰€æœ‰è§‚å¯Ÿè€…éƒ½ä¼šæ”¶åˆ°å“åº”çš„é€šçŸ¥ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ol><li>è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä¹‹é—´å»ºç«‹ä¸€ä¸ªæŠ½è±¡çš„è€¦åˆï¼›</li><li>è§‚å¯Ÿè€…æ¨¡å¼æ”¯æŒå¹¿æ’­é€šä¿¡ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>è§‚å¯Ÿè€…ä¹‹é—´æœ‰è¿‡å¤šçš„ç»†èŠ‚ä¾èµ–ï¼Œæé«˜æ—¶é—´æ¶ˆè€—åŠç¨‹åºå¤æ‚åº¦ï¼›</li><li>åº”é¿å…å¾ªç¯è°ƒç”¨ã€‚</li></ol><p>JDKå¯¹è§‚å¯Ÿè€…æ¨¡å¼æä¾›äº†æ”¯æŒã€‚ä¸‹é¢ä¸¾ä¸ªè§‚å¯Ÿè€…æ¨¡å¼çš„ä¾‹å­ã€‚</p><p>åˆ›å»ºä¸€ä¸ªåšå®¢ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**</span><br><span class="line"> * ç»§æ‰¿ Observableç±»ï¼ŒBlogä¸ºè¢«è§‚å¯Ÿå¯¹è±¡</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class Blog extends Observable &#123;</span><br><span class="line"></span><br><span class="line">    private String title;</span><br><span class="line"></span><br><span class="line">    public Blog(String title) &#123;</span><br><span class="line">        this.title &#x3D; title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getTitle() &#123;</span><br><span class="line">        return title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void comment(Comment comment) &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(comment.getNickname() + &quot;è¯„è®ºäº†&lt;&quot; + this.title + &quot;&gt; ï¼Œ&quot; +</span><br><span class="line">                &quot;è¯„è®ºå†…å®¹ï¼š&quot; + comment.getValue());</span><br><span class="line">        &#x2F;&#x2F; è®¾ç½®æ ‡è¯†ä½ changed &#x3D; trueï¼Œè¡¨ç¤ºè¢«è§‚å¯Ÿè€…å‘ç”Ÿäº†æ”¹å˜</span><br><span class="line">        setChanged();</span><br><span class="line">        &#x2F;&#x2F; é€šçŸ¥è§‚å¯Ÿè€…ï¼Œå¯ä»¥ç»™è§‚å¯Ÿè€…ä¼ é€’æ•°æ®</span><br><span class="line">        notifyObservers(comment);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Commentç±»ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public class Comment &#123;</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * è¯„è®ºè€…æ˜µç§°</span><br><span class="line">     *&#x2F;</span><br><span class="line">    private String nickname;</span><br><span class="line">    &#x2F;**</span><br><span class="line">     * è¯„è®ºå†…å®¹</span><br><span class="line">     *&#x2F;</span><br><span class="line">    private String value;</span><br><span class="line"></span><br><span class="line">    public Comment(String nickname, String value) &#123;</span><br><span class="line">        this.nickname &#x3D; nickname;</span><br><span class="line">        this.value &#x3D; value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getValue() &#123;</span><br><span class="line">        return value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getNickname() &#123;</span><br><span class="line">        return nickname;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Blogç±»æ˜¯è¢«è§‚å¯Ÿè€…å¯¹è±¡ï¼Œè¢«è§‚å¯Ÿè€…å¯¹è±¡éœ€è¦ç»§æ‰¿JDKçš„Observableç±»ï¼Œç»§æ‰¿åï¼Œè¢«è§‚å¯Ÿè€…å¯¹è±¡åŒ…å«å¦‚ä¸‹å±æ€§å’Œæ–¹æ³•ï¼š</p><p><img src="https://mrbird.cc/img/QQ20200511-093515@2x.png" alt="QQ20200511-093515@2x"></p><p>è¿™äº›æ–¹æ³•éƒ½æ˜¯çº¿ç¨‹å®‰å…¨æ–¹æ³•ï¼ˆåŠ äº†synchronizedåŒæ­¥é”ï¼‰ã€‚</p><p>Blogçš„commentæ–¹æ³•ä¸­ï¼Œå½“åšå®¢æ”¶åˆ°è¯„è®ºæ—¶ï¼Œé¦–å…ˆè°ƒç”¨çˆ¶ç±»çš„setChanged()æ–¹æ³•ï¼Œè®¾ç½®æ ‡è¯†ä½ changed = trueï¼Œè¡¨ç¤ºè¢«è§‚å¯Ÿè€…å‘ç”Ÿäº†æ”¹å˜ï¼›ç„¶åè°ƒç”¨çˆ¶ç±»çš„notifyObservers(Object)æ–¹æ³•é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…ã€‚</p><p>è¢«è§‚å¯Ÿè€…å¯¹è±¡åˆ›å»ºå¥½åï¼Œæˆ‘ä»¬æ¥ç€åˆ›å»ºè§‚å¯Ÿè€…ã€‚æ–°å»ºä¸€ä¸ªAuthorç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public class Author implements Observer &#123;</span><br><span class="line"></span><br><span class="line">    private String name;</span><br><span class="line"></span><br><span class="line">    public Author(String name) &#123;</span><br><span class="line">        this.name &#x3D; name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * è§‚å¯Ÿè€…è¢«é€šçŸ¥åï¼Œå°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•</span><br><span class="line">     *</span><br><span class="line">     * @param o   è¢«è§‚å¯Ÿè€…å¯¹è±¡</span><br><span class="line">     * @param arg è¢«è§‚å¯Ÿè€…ä¼ é€’è¿‡æ¥çš„æ•°æ®</span><br><span class="line">     *&#x2F;</span><br><span class="line">    @Override</span><br><span class="line">    public void update(Observable o, Object arg) &#123;</span><br><span class="line">        Blog blog &#x3D; (Blog) o;</span><br><span class="line">        Comment comment &#x3D; (Comment) arg;</span><br><span class="line">        System.out.println(&quot;ç³»ç»Ÿæ„ŸçŸ¥åˆ°&quot; + this.name + &quot;æ’°å†™çš„åšæ–‡&lt;&quot; +</span><br><span class="line">                blog.getTitle() + &quot;&gt;æ”¶åˆ°äº†&quot; + comment.getNickname() +</span><br><span class="line">                &quot;çš„è¯„è®ºï¼Œè¯„è®ºå†…å®¹ä¸ºï¼š&quot; + comment.getValue());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿè€…å¯¹è±¡éœ€è¦å®ç°JDKçš„Observerç±»ï¼Œé‡å†™updateæ–¹æ³•ã€‚å½“è¢«è§‚å¯Ÿè€…å¯¹è±¡è°ƒç”¨äº†notifyObserversæ–¹æ³•åï¼Œç›¸åº”çš„è§‚å¯Ÿè€…çš„updateæ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚</p><p>æ–°å»ºä¸€ä¸ªå®¢æˆ·ç«¯æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Blog blog &#x3D; new Blog(&quot;Javaä»å…¥é—¨åˆ°æ”¾å¼ƒ&quot;);</span><br><span class="line">        Author author &#x3D; new Author(&quot;MrBird&quot;);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; æ·»åŠ è§‚å¯Ÿè€…</span><br><span class="line">        blog.addObserver(author);</span><br><span class="line"></span><br><span class="line">        Comment comment &#x3D; new Comment(&quot;Scott&quot;,</span><br><span class="line">                &quot;æ„Ÿè°¢æ¥¼ä¸»çš„æ–‡ç« ï¼Œè®©æˆ‘åŠæ—¶æ”¾å¼ƒJavaï¼Œå›å®¶ç»§æ‰¿äº†åƒä¸‡å®¶äº§ã€‚&quot;);</span><br><span class="line">        blog.comment(comment);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Scottè¯„è®ºäº†&lt;Javaä»å…¥é—¨åˆ°æ”¾å¼ƒ&gt; ï¼Œè¯„è®ºå†…å®¹ï¼šæ„Ÿè°¢æ¥¼ä¸»çš„æ–‡ç« ï¼Œè®©æˆ‘åŠæ—¶æ”¾å¼ƒJavaï¼Œå›å®¶ç»§æ‰¿äº†åƒä¸‡å®¶äº§ã€‚</span><br><span class="line">ç³»ç»Ÿæ„ŸçŸ¥åˆ°MrBirdæ’°å†™çš„åšæ–‡&lt;Javaä»å…¥é—¨åˆ°æ”¾å¼ƒ&gt;æ”¶åˆ°äº†Scottçš„è¯„è®ºï¼Œè¯„è®ºå†…å®¹ä¸ºï¼šæ„Ÿè°¢æ¥¼ä¸»çš„æ–‡ç« ï¼Œè®©æˆ‘åŠæ—¶æ”¾å¼ƒJavaï¼Œå›å®¶ç»§æ‰¿äº†åƒä¸‡å®¶äº§ã€‚</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè§‚å¯Ÿè€…çš„updateæ–¹æ³•é‡Œçš„é€»è¾‘æœ€å¥½è¿›è¡Œå¼‚æ­¥åŒ–ï¼Œè¿™æ ·åœ¨å¹¶å‘ç¯å¢ƒä¸‹å¯ä»¥æå‡ç¨‹åºæ€§èƒ½ã€‚</p><h3 id="å¤‡å¿˜å½•æ¨¡å¼"><a href="#å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="å¤‡å¿˜å½•æ¨¡å¼"></a>å¤‡å¿˜å½•æ¨¡å¼</h3><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/jimoer/p/9537997.html%E3%80%82">https://www.cnblogs.com/jimoer/p/9537997.htmlã€‚</a></p><h3 id="å‘½ä»¤æ¨¡å¼"><a href="#å‘½ä»¤æ¨¡å¼" class="headerlink" title="å‘½ä»¤æ¨¡å¼"></a>å‘½ä»¤æ¨¡å¼</h3><p>æš‚ä¸è®°å½•ã€‚</p><h3 id="ä¸­ä»‹è€…æ¨¡å¼"><a href="#ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="ä¸­ä»‹è€…æ¨¡å¼"></a>ä¸­ä»‹è€…æ¨¡å¼</h3><p>æš‚ä¸è®°å½•ã€‚</p><h3 id="èŒè´£é“¾æ¨¡å¼"><a href="#èŒè´£é“¾æ¨¡å¼" class="headerlink" title="èŒè´£é“¾æ¨¡å¼"></a>èŒè´£é“¾æ¨¡å¼</h3><p>èŒè´£é“¾æ¨¡å¼ä¸ºè¯·æ±‚åˆ›å»ºä¸€ä¸ªæ¥æ”¶æ­¤æ¬¡è¯·æ±‚å¯¹è±¡çš„é“¾ã€‚</p><p>é€‚ç”¨äºï¼š</p><ul><li>ä¸€ä¸ªè¯·æ±‚çš„å¤„ç†éœ€è¦å¤šä¸ªå¯¹è±¡å½“ä¸­çš„ä¸€ä¸ªæˆ–å‡ ä¸ªåä½œå¤„ç†ï¼›</li></ul><p>ä¼˜ç‚¹ï¼š</p><ol><li>è¯·æ±‚çš„å‘é€è€…å’Œæ¥å—è€…ï¼ˆè¯·æ±‚çš„å¤„ç†ï¼‰è§£è€¦ï¼›</li><li>èŒè´£é“¾å¯ä»¥åŠ¨æ€çš„ç»„åˆã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li>èŒè´£é“¾å¤ªé•¿æˆ–è€…å¤„ç†æ—¶é—´è¿‡é•¿ï¼Œå½±å“æ€§èƒ½ï¼›</li><li>èŒè´£é“¾å¯èƒ½è¿‡å¤šã€‚</li></ol><p>ä¸¾ä¸ªå­—ç¬¦ä¸²æ ¡éªŒçš„ä¾‹å­ã€‚æ–°å»ºä¸€ä¸ªå­—ç¬¦ä¸²æ ¡éªŒæŠ½è±¡ç±»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public abstract class StringValidator &#123;</span><br><span class="line"></span><br><span class="line">    protected StringValidator validator;</span><br><span class="line"></span><br><span class="line">    public void setNextValidator(StringValidator validator) &#123;</span><br><span class="line">        this.validator &#x3D; validator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public abstract void check(String value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>StringValidatorç±»åŒ…å«äº†ä¸€ä¸ªè‡ªèº«ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œè¿™ä¹Ÿæ˜¯è¯¥æ¨¡å¼çš„è®¾è®¡æ ¸å¿ƒï¼Œä»¥æ­¤å½¢æˆé“¾æ¡ã€‚</p><p>åˆ›å»ºä¸€ä¸ªæ ¡éªŒå­—ç¬¦ä¸²é•¿åº¦çš„ç±»StringLengthValidatorï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class StringLengthValidator extends StringValidator &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void check(String value) &#123;</span><br><span class="line">        if (value !&#x3D; null &amp;&amp; value.length() !&#x3D; 0) &#123;</span><br><span class="line">            System.out.println(&quot;å­—ç¬¦ä¸²é•¿åº¦åˆæ³•&quot;);</span><br><span class="line">            if (validator !&#x3D; null) &#123;</span><br><span class="line">                validator.check(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            System.out.println(&quot;å­—ç¬¦ä¸²é•¿åº¦ä¸åˆæ³•&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œåœ¨å­—ç¬¦ä¸²é•¿åº¦æ ¡éªŒåˆæ³•åï¼Œæˆ‘ä»¬åˆ¤æ–­çˆ¶ç±»çš„validatorå±æ€§æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºåˆ™è°ƒç”¨å…¶checkæ–¹æ³•ç»§ç»­ä¸‹ä¸€æ­¥æ ¡éªŒã€‚</p><p>æ¥ç€å†æ–°å»ºä¸€ä¸ªæ ¡éªŒå­—ç¬¦ä¸²å†…å®¹çš„ç±»StringValueValidatorï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public class StringValueValidator extends StringValidator &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void check(String value) &#123;</span><br><span class="line">        if (value.contains(&quot;fuck&quot;)) &#123;</span><br><span class="line">            System.out.println(&quot;å­—ç¬¦ä¸²å€¼ä¸åˆæ³•&quot;);</span><br><span class="line">            if (validator !&#x3D; null) &#123;</span><br><span class="line">                validator.check(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            System.out.println(&quot;å­—ç¬¦ä¸²å€¼åˆæ³•&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥—è·¯å’ŒStringLengthValidatorä¸€æ ·ã€‚æ¥ç€åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ç±»ï¼Œæ¼”ç¤ºä¸‹å¦‚ä½•è®©æ ¡éªŒç±»å½¢æˆä¸€ä¸ªé“¾æ¡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class Application &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        StringValidator lengthValidator &#x3D; new StringLengthValidator();</span><br><span class="line">        StringValidator valueValidator &#x3D; new StringValueValidator();</span><br><span class="line"></span><br><span class="line">        lengthValidator.setNextValidator(valueValidator);</span><br><span class="line">        lengthValidator.check(&quot;hello&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­ï¼Œé€šè¿‡StringValidatorçš„setNextValidatoræ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸‹ä¸€ä¸ªæ ¡éªŒç±»ï¼Œä»¥æ­¤å½¢æˆé“¾æ¡ï¼Œç¨‹åºè¾“å‡ºå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å­—ç¬¦ä¸²é•¿åº¦åˆæ³•</span><br><span class="line">å­—ç¬¦ä¸²å€¼åˆæ³•</span><br></pre></td></tr></table></figure><h3 id="è®¿é—®è€…æ¨¡å¼"><a href="#è®¿é—®è€…æ¨¡å¼" class="headerlink" title="è®¿é—®è€…æ¨¡å¼"></a>è®¿é—®è€…æ¨¡å¼</h3><p>æš‚ä¸è®°å½•ğŸŒš</p><h3 id="çŠ¶æ€æ¨¡å¼"><a href="#çŠ¶æ€æ¨¡å¼" class="headerlink" title="çŠ¶æ€æ¨¡å¼"></a>çŠ¶æ€æ¨¡å¼</h3><p>æš‚ä¸è®°å½•ğŸŒš</p><blockquote><p>å‚è€ƒè¿æ¥ï¼š<a href="https://zh.wikipedia.org/wiki/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F_(%E8%AE%A1%E7%AE%97%E6%9C%BA)">https://zh.wikipedia.org/wiki/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F_(%E8%AE%A1%E7%AE%97%E6%9C%BA)</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Javaè®¾è®¡æ¨¡å¼å­¦ä¹ &quot;&gt;&lt;a href=&quot;#Javaè®¾è®¡æ¨¡å¼å­¦ä¹ &quot; class=&quot;headerlink&quot; title=&quot;Javaè®¾è®¡æ¨¡å¼å­¦ä¹ &quot;&gt;&lt;/a&gt;Javaè®¾è®¡æ¨¡å¼å­¦ä¹ &lt;/h2&gt;&lt;h2 id=&quot;åˆ›å»ºå‹æ¨¡å¼&quot;&gt;&lt;a href=&quot;#åˆ›å»ºå‹æ¨¡å¼&quot; class=&quot;he</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Springæºç </title>
    <link href="http://example.com/2021/12/01/Spring%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"/>
    <id>http://example.com/2021/12/01/Spring%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/</id>
    <published>2021-11-30T16:02:17.000Z</published>
    <updated>2021-12-06T15:23:01.852Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h3><p>Spring Framework</p><p><a href="http://static.iocoder.cn/images/Spring/2018-12-24/01.jpg"><img src="http://static.iocoder.cn/images/Spring/2018-12-24/01.jpg" alt="Spring Framework"></a></p><p><strong>Spring æ ¸å¿ƒå®¹å™¨ Core Container</strong></p><ul><li>Spring Core</li><li>Spring Bean</li><li>Spring Context</li><li>SpEL (Spring Expression Language)</li></ul><p><strong>æ•°æ®è®¿é—®</strong> <strong>Data Access</strong></p><ul><li>JDBC</li><li>ORM</li><li>OXM</li><li>Transaction</li></ul><p><strong>Web</strong></p><ul><li>WebMVC</li><li>WebFlux</li><li>WebSocket</li></ul><p><strong>AOP</strong></p><ul><li>AOP</li><li>Aspects</li></ul><p><strong>å…¶ä»–</strong></p><ul><li>JMS (Java Messaging Service)</li><li>Test</li><li>Messaging</li></ul><p><strong>ä½¿ç”¨ Spring æ¡†æ¶å¸¦æ¥çš„ä¸»è¦å¥½å¤„ï¼š</strong></p><ul><li><strong>DI</strong> ï¼š**<a href="http://howtodoinjava.com/2013/03/19/inversion-of-control-ioc-and-dependency-injection-di-patterns-in-spring-framework-and-related-interview-questions/">Dependency Injection(DI)</a>** æ–¹æ³•ï¼Œä½¿å¾—æ„é€ å™¨å’Œ JavaBeanã€properties æ–‡ä»¶ä¸­çš„ä¾èµ–å…³ç³»ä¸€ç›®äº†ç„¶ã€‚</li><li><strong>è½»é‡çº§</strong>ï¼šä¸ EJB å®¹å™¨ç›¸æ¯”è¾ƒï¼ŒIoC å®¹å™¨æ›´åŠ è¶‹å‘äº<strong>è½»é‡çº§</strong>ã€‚è¿™æ ·ä¸€æ¥ IoC å®¹å™¨åœ¨æœ‰é™çš„å†…å­˜å’Œ CPU èµ„æºçš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œåº”ç”¨ç¨‹åºçš„å¼€å‘å’Œå‘å¸ƒå°±å˜å¾—ååˆ†æœ‰åˆ©ã€‚</li><li><strong>é¢å‘åˆ‡é¢ç¼–ç¨‹(AOP)\</strong>ï¼š Spring æ”¯æŒé¢å‘**åˆ‡é¢ç¼–ç¨‹**ï¼ŒåŒæ—¶æŠŠåº”ç”¨çš„ä¸šåŠ¡é€»è¾‘ä¸ç³»ç»Ÿçš„æœåŠ¡åˆ†ç¦»å¼€æ¥ã€‚</li><li><strong>é›†æˆä¸»æµæ¡†æ¶</strong>ï¼šSpring å¹¶æ²¡æœ‰é—­é—¨é€ è½¦ï¼ŒSpring <strong>é›†æˆ</strong>äº†å·²æœ‰çš„æŠ€æœ¯æ ˆï¼Œæ¯”å¦‚ ORM æ¡†æ¶ã€Logging æ—¥æœŸæ¡†æ¶ã€J2EEã€Quartz å’Œ JDK Timer ï¼Œä»¥åŠå…¶ä»–è§†å›¾æŠ€æœ¯ã€‚</li><li>æ¨¡å—åŒ–ï¼šSpring æ¡†æ¶æ˜¯æŒ‰ç…§<strong>æ¨¡å—</strong>çš„å½¢å¼æ¥ç»„ç»‡çš„ã€‚ç”±åŒ…å’Œç±»çš„å‘½åï¼Œå°±å¯ä»¥çœ‹å‡ºå…¶æ‰€å±çš„æ¨¡å—ï¼Œå¼€å‘è€…ä»…ä»…éœ€è¦é€‰ç”¨ä»–ä»¬éœ€è¦çš„æ¨¡å—å³å¯ã€‚</li><li><strong>ä¾¿æ·çš„æµ‹è¯•</strong>ï¼šè¦ <a href="http://howtodoinjava.com/2013/04/19/how-to-unit-test-spring-security-authentication-with-junit/">æµ‹è¯•ä¸€é¡¹ç”¨Springå¼€å‘çš„åº”ç”¨ç¨‹åº</a> ååˆ†ç®€å•ï¼Œå› ä¸º<strong>æµ‹è¯•</strong>ç›¸å…³çš„ç¯å¢ƒä»£ç éƒ½å·²ç»å›Šæ‹¬åœ¨æ¡†æ¶ä¸­äº†ã€‚æ›´åŠ ç®€å•çš„æ˜¯ï¼Œåˆ©ç”¨ JavaBean å½¢å¼çš„ POJO ç±»ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ©ç”¨ä¾èµ–æ³¨å…¥æ¥å†™å…¥æµ‹è¯•æ•°æ®ã€‚</li><li><strong>Web æ¡†æ¶</strong>ï¼šSpring çš„ <strong>Web æ¡†æ¶</strong>äº¦æ˜¯ä¸€ä¸ªç²¾å¿ƒè®¾è®¡çš„ Web MVC æ¡†æ¶ï¼Œä¸ºå¼€å‘è€…ä»¬åœ¨ Web æ¡†æ¶çš„é€‰æ‹©ä¸Šæä¾›äº†ä¸€ä¸ªé™¤äº†ä¸»æµæ¡†æ¶æ¯”å¦‚ Struts ã€è¿‡åº¦è®¾è®¡çš„ã€ä¸æµè¡Œ Web æ¡†æ¶çš„ä»¥å¤–çš„æœ‰åŠ›é€‰é¡¹ã€‚</li><li><strong>äº‹åŠ¡ç®¡ç†</strong>ï¼šSpring æä¾›äº†ä¸€ä¸ªä¾¿æ·çš„<strong>äº‹åŠ¡ç®¡ç†</strong>æ¥å£ï¼Œé€‚ç”¨äºå°å‹çš„æœ¬åœ°äº‹ç‰©å¤„ç†ï¼ˆæ¯”å¦‚åœ¨å• DB çš„ç¯å¢ƒä¸‹ï¼‰å’Œå¤æ‚çš„å…±åŒäº‹ç‰©å¤„ç†ï¼ˆæ¯”å¦‚åˆ©ç”¨ JTA çš„å¤æ‚ DB ç¯å¢ƒï¼‰ã€‚</li><li><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šSpring æä¾›ä¸€ä¸ªæ–¹ä¾¿çš„ API ï¼Œå°†ç‰¹å®šæŠ€æœ¯çš„å¼‚å¸¸(ç”±JDBC, Hibernate, æˆ– JDO æŠ›å‡º)è½¬åŒ–ä¸ºä¸€è‡´çš„ã€Unchecked å¼‚å¸¸ã€‚</li></ul><p><strong>è®¾è®¡æ¨¡å¼</strong></p><ul><li>ä»£ç†æ¨¡å¼ â€” åœ¨ AOP å’Œ remoting ä¸­è¢«ç”¨çš„æ¯”è¾ƒå¤šã€‚</li><li>å•ä¾‹æ¨¡å¼ â€” åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„ Bean é»˜è®¤ä¸ºå•ä¾‹æ¨¡å¼ã€‚</li><li>æ¨¡æ¿æ–¹æ³• â€” ç”¨æ¥è§£å†³ä»£ç é‡å¤çš„é—®é¢˜ã€‚æ¯”å¦‚ <a href="http://howtodoinjava.com/2015/02/20/spring-restful-client-resttemplate-example/">RestTemplate</a>ã€JmsTemplateã€JdbcTemplate ã€‚</li><li>å·¥å‚æ¨¡å¼ â€” BeanFactory ç”¨æ¥åˆ›å»ºå¯¹è±¡çš„å®ä¾‹ã€‚</li></ul><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><ul><li>IOC ï¼Œä¾§é‡åœ¨äºå®¹å™¨ã€‚</li><li>Bean ï¼Œä¾§é‡åœ¨äºè¢«å®¹å™¨ç®¡ç†çš„ Bean ã€‚</li></ul><p><strong>å®¹å™¨åˆ›å»º Bean å¯¹è±¡ï¼Œå°†å®ƒä»¬è£…é…åœ¨ä¸€èµ·ï¼Œé…ç½®å®ƒä»¬å¹¶ç®¡ç†å®ƒä»¬çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸã€‚</strong></p><p>ä¾èµ–æ³¨å…¥ ï¼ˆDI)</p><p>åœ¨ä¾èµ–æ³¨å…¥ä¸­ï¼Œä½ ä¸å¿…ä¸»åŠ¨ã€æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡ï¼Œä½†å¿…é¡»æè¿°å¦‚ä½•åˆ›å»ºå®ƒä»¬ã€‚</p><ul><li>ä½ ä¸æ˜¯ç›´æ¥åœ¨ä»£ç ä¸­å°†ç»„ä»¶å’ŒæœåŠ¡è¿æ¥åœ¨ä¸€èµ·ï¼Œè€Œæ˜¯æè¿°é…ç½®æ–‡ä»¶ä¸­å“ªäº›ç»„ä»¶éœ€è¦å“ªäº›æœåŠ¡ã€‚</li><li>ç„¶åï¼Œå†ç”± IoC å®¹å™¨å°†å®ƒä»¬è£…é…åœ¨ä¸€èµ·ã€‚</li></ul><p><strong>æ³¨å…¥æ–¹å¼</strong></p><ul><li><del>æ¥å£æ³¨å…¥</del></li><li>æ„é€ å‡½æ•°æ³¨å…¥</li><li><strong>setter æ³¨å…¥</strong></li></ul><p>Spring æä¾›äº†ä¸¤ç§( ä¸æ˜¯â€œä¸ªâ€ ) IoC å®¹å™¨ï¼Œåˆ†åˆ«æ˜¯ BeanFactoryã€ApplicationContext ã€‚</p><ul><li><strong>BeanFactory</strong></li></ul><p>BeanFactory åœ¨ <code>spring-beans</code> é¡¹ç›®æä¾›ã€‚</p><p>BeanFactory ï¼Œå°±åƒä¸€ä¸ªåŒ…å« Bean é›†åˆçš„å·¥å‚ç±»ã€‚å®ƒä¼šåœ¨å®¢æˆ·ç«¯è¦æ±‚æ—¶å®ä¾‹åŒ– Bean å¯¹è±¡ã€‚</p><ul><li><strong>ApplicationContext</strong></li></ul><p>ApplicationContext åœ¨ <code>spring-context</code> é¡¹ç›®æä¾›ã€‚</p><p>ApplicationContext æ¥å£æ‰©å±•äº† BeanFactory æ¥å£ï¼Œå®ƒåœ¨ BeanFactory åŸºç¡€ä¸Šæä¾›äº†ä¸€äº›é¢å¤–çš„åŠŸèƒ½</p><p><strong>Spring Bean æ”¯æŒ 5 ç§ Scope</strong></p><ul><li><strong>Singleton - æ¯ä¸ª Spring IoC å®¹å™¨ä»…æœ‰ä¸€ä¸ªå• Bean å®ä¾‹ã€‚é»˜è®¤</strong></li><li><strong>Prototype - æ¯æ¬¡è¯·æ±‚éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚</strong></li><li>Request - æ¯ä¸€æ¬¡ HTTP è¯·æ±‚éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ Bean å®ä¾‹ï¼Œå¹¶ä¸”è¯¥ Bean ä»…åœ¨å½“å‰ HTTP è¯·æ±‚å†…æœ‰æ•ˆã€‚</li><li>Session - æ¯ä¸€ä¸ªçš„ Session éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ Bean å®ä¾‹ï¼ŒåŒæ—¶è¯¥ Bean ä»…åœ¨å½“å‰ HTTP Session å†…æœ‰æ•ˆã€‚</li><li>Application - æ¯ä¸€ä¸ª Web Application éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ Bean ï¼ŒåŒæ—¶è¯¥ Bean ä»…åœ¨å½“å‰ Web Application å†…æœ‰æ•ˆã€‚</li></ul><p><strong>Spring Bean åœ¨å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸ</strong></p><p>Spring Bean çš„<strong>åˆå§‹åŒ–</strong>æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>å®ä¾‹åŒ– Bean å¯¹è±¡</li><li>Aware ç›¸å…³çš„å±æ€§ï¼Œæ³¨å…¥åˆ° Bean å¯¹è±¡</li><li>è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ï¼Œè¿›ä¸€æ­¥åˆå§‹åŒ– Bean å¯¹è±¡</li></ul><p><a href="http://static.iocoder.cn/images/Spring/2018-12-24/08.png"><img src="http://static.iocoder.cn/images/Spring/2018-12-24/08.png" alt="æµç¨‹å›¾"></a></p><p><strong>å®ä¾‹åŒ–-&gt;è®¾ç½®å±æ€§-&gt;åˆå§‹åŒ–Beanå¯¹è±¡-&gt;é”€æ¯</strong></p><p><strong>ä»€ä¹ˆæ˜¯ Spring è£…é…</strong></p><p>å½“ Bean åœ¨ Spring å®¹å™¨ä¸­ç»„åˆåœ¨ä¸€èµ·æ—¶ï¼Œå®ƒè¢«ç§°ä¸º<strong>è£…é…</strong>æˆ– <strong>Bean è£…é…</strong></p><p>è£…é…ï¼Œå’Œ <strong>DI ä¾èµ–</strong>æ³¨å…¥ï¼Œå®é™…æ˜¯ä¸€ä¸ªä¸œè¥¿ã€‚</p><ul><li>no - è¿™æ˜¯é»˜è®¤è®¾ç½®ï¼Œè¡¨ç¤ºæ²¡æœ‰è‡ªåŠ¨è£…é…ã€‚åº”ä½¿ç”¨æ˜¾å¼ Bean å¼•ç”¨è¿›è¡Œè£…é…ã€‚</li><li>byName - å®ƒæ ¹æ® Bean çš„åç§°æ³¨å…¥å¯¹è±¡ä¾èµ–é¡¹ã€‚å®ƒåŒ¹é…å¹¶è£…é…å…¶å±æ€§ä¸ XML æ–‡ä»¶ä¸­ç”±ç›¸åŒåç§°å®šä¹‰çš„ Bean ã€‚</li><li>ã€æœ€å¸¸ç”¨ã€‘<strong>byType</strong> - å®ƒæ ¹æ®ç±»å‹æ³¨å…¥å¯¹è±¡ä¾èµ–é¡¹ã€‚å¦‚æœå±æ€§çš„ç±»å‹ä¸ XML æ–‡ä»¶ä¸­çš„ä¸€ä¸ª Bean ç±»å‹åŒ¹é…ï¼Œåˆ™åŒ¹é…å¹¶è£…é…å±æ€§ã€‚</li></ul><p>å»¶è¿ŸåŠ è½½ åœ¨Bean ä¸­è®¾ç½® <code>lzay-init = &quot;true&quot;</code></p><p>Spring çš„å•ä¾‹ Bean æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p><strong>å¾ªç¯ä¾èµ–</strong>çš„é—®é¢˜è§<a href="https://hankz.cc/2021/03/07/%E4%BB%80%E4%B9%88%E6%98%AFspring%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">https://hankz.cc/2021/03/07/%E4%BB%80%E4%B9%88%E6%98%AFspring%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/</a></p><p><strong>AOP(Aspect-Oriented Programming)ï¼Œå³é¢å‘åˆ‡é¢ç¼–ç¨‹</strong></p><ul><li>åœ¨ OOP ä¸­ï¼Œä»¥ç±»( Class )ä½œä¸ºåŸºæœ¬å•å…ƒ</li><li>åœ¨ AOP ä¸­ï¼Œä»¥**åˆ‡é¢( Aspect )**ä½œä¸ºåŸºæœ¬å•å…ƒã€‚</li></ul><p>å®ç° AOP çš„æŠ€æœ¯ï¼Œä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p><p>â‘  <strong>é™æ€ä»£ç†</strong> - æŒ‡ä½¿ç”¨ AOP æ¡†æ¶æä¾›çš„å‘½ä»¤è¿›è¡Œç¼–è¯‘ï¼Œä»è€Œåœ¨ç¼–è¯‘é˜¶æ®µå°±å¯ç”Ÿæˆ AOP ä»£ç†ç±»ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºç¼–è¯‘æ—¶å¢å¼ºã€‚</p><p>â‘¡ <strong>åŠ¨æ€ä»£ç†</strong> - åœ¨è¿è¡Œæ—¶åœ¨å†…å­˜ä¸­â€œä¸´æ—¶â€ç”Ÿæˆ AOP åŠ¨æ€ä»£ç†ç±»ï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºè¿è¡Œæ—¶å¢å¼ºã€‚ç›®å‰ Spring ä¸­ä½¿ç”¨äº†ä¸¤ç§åŠ¨æ€ä»£ç†åº“ï¼š</p><ul><li><p>JDK åŠ¨æ€ä»£ç†</p><p> JDK åŠ¨æ€ä»£ç†é€šè¿‡åå°„æ¥æ¥æ”¶è¢«ä»£ç†çš„ç±»ï¼Œå¹¶ä¸”è¦æ±‚è¢«ä»£ç†çš„ç±»å¿…é¡»å®ç°ä¸€ä¸ªæ¥å£ã€‚JDKåŠ¨æ€ä»£ç†çš„æ ¸å¿ƒæ˜¯ InvocationHandler æ¥å£å’Œ Proxy ç±»ã€‚</p></li><li><p>CGLIB</p><p> å¦‚æœç›®æ ‡ç±»æ²¡æœ‰å®ç°æ¥å£ï¼Œé‚£ä¹ˆ Spring AOP ä¼šé€‰æ‹©ä½¿ç”¨ CGLIB æ¥åŠ¨æ€ä»£ç†ç›®æ ‡ç±»ã€‚å½“ç„¶ï¼ŒSpring ä¹Ÿæ”¯æŒé…ç½®ï¼Œ<strong>å¼ºåˆ¶</strong>ä½¿ç”¨ CGLIB åŠ¨æ€ä»£ç†ã€‚</p></li></ul><p><strong>Spring Transaction</strong></p><p>äº‹åŠ¡å°±æ˜¯å¯¹ä¸€ç³»åˆ—çš„æ•°æ®åº“æ“ä½œï¼ˆæ¯”å¦‚æ’å…¥å¤šæ¡æ•°æ®ï¼‰è¿›è¡Œç»Ÿä¸€çš„æäº¤æˆ–å›æ»šæ“ä½œï¼Œå¦‚æœæ’å…¥æˆåŠŸï¼Œé‚£ä¹ˆä¸€èµ·æˆåŠŸï¼Œå¦‚æœä¸­é—´æœ‰ä¸€æ¡å‡ºç°å¼‚å¸¸ï¼Œé‚£ä¹ˆå›æ»šä¹‹å‰çš„æ‰€æœ‰æ“ä½œã€‚</p><p>äº‹åŠ¡çš„ç‰¹æ€§<strong>ACID</strong></p><ol><li><strong>åŸå­æ€§</strong> Atomicity ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œæˆ–è€…å…¨éƒ¨å®Œæˆï¼Œæˆ–è€…å…¨éƒ¨ä¸å®Œæˆï¼Œä¸ä¼šç»“æŸåœ¨ä¸­é—´æŸä¸ªç¯èŠ‚ã€‚</li><li><strong>ä¸€è‡´æ€§</strong> Consistency ï¼šåœ¨äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä»¥åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§æ²¡æœ‰è¢«ç ´åã€‚</li><li><strong>éš”ç¦»æ€§</strong> Isolation ï¼šæ•°æ®åº“å…è®¸å¤šä¸ªå¹¶å‘äº‹åŠ¡åŒæ—¶å¯¹å…¶æ•°æ®è¿›è¡Œè¯»å†™å’Œä¿®æ”¹çš„èƒ½åŠ›ï¼Œéš”ç¦»æ€§å¯ä»¥é˜²æ­¢å¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ç”±äºäº¤å‰æ‰§è¡Œè€Œå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚äº‹åŠ¡éš”ç¦»åˆ†ä¸ºä¸åŒçº§åˆ«ï¼ŒåŒ…æ‹¬è¯»æœªæäº¤ï¼ˆRead uncommittedï¼‰ã€è¯»æäº¤ï¼ˆread committedï¼‰ã€å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ã€‚</li><li><strong>æŒä¹…æ€§</strong> Durability ï¼šäº‹åŠ¡å¤„ç†ç»“æŸåï¼Œå¯¹æ•°æ®çš„ä¿®æ”¹å°±æ˜¯æ°¸ä¹…çš„ï¼Œå³ä¾¿ç³»ç»Ÿæ•…éšœä¹Ÿä¸ä¼šä¸¢å¤±</li></ol><p><strong>äº‹åŠ¡ç®¡ç†</strong></p><ul><li><strong>å£°æ˜å¼</strong>äº‹åŠ¡ï¼šé€šè¿‡ä½¿ç”¨æ³¨è§£æˆ–åŸºäº XML çš„é…ç½®äº‹åŠ¡</li><li><strong>ç¼–ç¨‹å¼</strong>äº‹åŠ¡ï¼šé€šè¿‡ç¼–ç çš„æ–¹å¼å®ç°äº‹åŠ¡ç®¡ç†ï¼Œéœ€è¦åœ¨ä»£ç ä¸­æ˜¾å¼çš„è°ƒç”¨äº‹åŠ¡çš„è·å¾—ã€æäº¤ã€å›æ»šã€‚</li></ul><p>ä¸€èˆ¬ä½¿ç”¨ Spring Boot + æ³¨è§£çš„<strong>å£°æ˜å¼</strong>äº‹åŠ¡</p><p><strong>äº‹åŠ¡éš”ç¦»çº§åˆ«</strong></p><ul><li><a href="https://zhuanlan.zhihu.com/p/25419593">ã€Šæ•°æ®åº“å››å¤§ç‰¹æ€§ä»¥åŠäº‹åŠ¡éš”ç¦»çº§åˆ«ã€‹</a></li><li><a href="https://www.jianshu.com/p/4e3edbedb9a8">ã€Šäº”åˆ†é’Ÿææ¸…æ¥š MySQL äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‹</a></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">&#x2F;&#x2F; TransactionDefinition.java</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * ã€Spring ç‹¬æœ‰ã€‘ä½¿ç”¨åç«¯æ•°æ®åº“é»˜è®¤çš„éš”ç¦»çº§åˆ«</span><br><span class="line"> *</span><br><span class="line"> * MySQL é»˜è®¤é‡‡ç”¨çš„ REPEATABLE_READéš”ç¦»çº§åˆ«</span><br><span class="line"> * Oracle é»˜è®¤é‡‡ç”¨çš„ READ_COMMITTEDéš”ç¦»çº§åˆ«</span><br><span class="line"> *&#x2F;</span><br><span class="line">int ISOLATION_DEFAULT &#x3D; -1;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * æœ€ä½çš„éš”ç¦»çº§åˆ«ï¼Œå…è®¸è¯»å–å°šæœªæäº¤çš„æ•°æ®å˜æ›´ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„è¯»ã€å¹»è¯»æˆ–ä¸å¯é‡å¤è¯»</span><br><span class="line"> *&#x2F;</span><br><span class="line">int ISOLATION_READ_UNCOMMITTED &#x3D; Connection.TRANSACTION_READ_UNCOMMITTED;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * å…è®¸è¯»å–å¹¶å‘äº‹åŠ¡å·²ç»æäº¤çš„æ•°æ®ï¼Œå¯ä»¥é˜»æ­¢è„è¯»ï¼Œä½†æ˜¯å¹»è¯»æˆ–ä¸å¯é‡å¤è¯»ä»æœ‰å¯èƒ½å‘ç”Ÿ</span><br><span class="line"> *&#x2F;</span><br><span class="line">int ISOLATION_READ_COMMITTED &#x3D; Connection.TRANSACTION_READ_COMMITTED;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * å¯¹åŒä¸€å­—æ®µçš„å¤šæ¬¡è¯»å–ç»“æœéƒ½æ˜¯ä¸€è‡´çš„ï¼Œé™¤éæ•°æ®æ˜¯è¢«æœ¬èº«äº‹åŠ¡è‡ªå·±æ‰€ä¿®æ”¹ï¼Œå¯ä»¥é˜»æ­¢è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œä½†å¹»è¯»ä»æœ‰å¯èƒ½å‘ç”Ÿã€‚</span><br><span class="line"> *&#x2F;</span><br><span class="line">int ISOLATION_REPEATABLE_READ &#x3D; Connection.TRANSACTION_REPEATABLE_READ;</span><br><span class="line">&#x2F;**</span><br><span class="line"> * æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå®Œå…¨æœä»ACIDçš„éš”ç¦»çº§åˆ«ã€‚æ‰€æœ‰çš„äº‹åŠ¡ä¾æ¬¡é€ä¸ªæ‰§è¡Œï¼Œè¿™æ ·äº‹åŠ¡ä¹‹é—´å°±å®Œå…¨ä¸å¯èƒ½äº§ç”Ÿå¹²æ‰°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥çº§åˆ«å¯ä»¥é˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ä»¥åŠå¹»è¯»ã€‚</span><br><span class="line"> *</span><br><span class="line"> * ä½†æ˜¯è¿™å°†ä¸¥é‡å½±å“ç¨‹åºçš„æ€§èƒ½ã€‚é€šå¸¸æƒ…å†µä¸‹ä¹Ÿä¸ä¼šç”¨åˆ°è¯¥çº§åˆ«ã€‚</span><br><span class="line"> *&#x2F;</span><br><span class="line">int ISOLATION_SERIALIZABLE &#x3D; Connection.TRANSACTION_SERIALIZABLE;</span><br></pre></td></tr></table></figure><hr><h3 id="IOC"><a href="#IOC" class="headerlink" title="IOC"></a>IOC</h3><h4 id="ç†è®º"><a href="#ç†è®º" class="headerlink" title="ç†è®º"></a>ç†è®º</h4><p>IoC å…¨ç§°ä¸º <code>Inversion of Control</code>ï¼Œç¿»è¯‘ä¸º â€œæ§åˆ¶åè½¬â€(DI)</p><ol><li><strong>è°æ§åˆ¶è°</strong>ï¼šåœ¨ä¼ ç»Ÿçš„å¼€å‘æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯é‡‡ç”¨ç›´æ¥ new ä¸€ä¸ªå¯¹è±¡çš„æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ ä¾èµ–çš„å¯¹è±¡ç›´æ¥ç”±ä½ è‡ªå·±æ§åˆ¶ï¼Œä½†æ˜¯æœ‰äº† IoC å®¹å™¨åï¼Œåˆ™ç›´æ¥ç”± IoC å®¹å™¨æ¥æ§åˆ¶ã€‚æ‰€ä»¥â€œè°æ§åˆ¶è°â€ï¼Œå½“ç„¶æ˜¯ IoC å®¹å™¨æ§åˆ¶å¯¹è±¡</li><li><strong>æ§åˆ¶ä»€ä¹ˆ</strong>ï¼šæ§åˆ¶å¯¹è±¡ã€‚</li><li><strong>ä¸ºä½•æ˜¯åè½¬</strong>ï¼šæ²¡æœ‰ IoC çš„æ—¶å€™æˆ‘ä»¬éƒ½æ˜¯åœ¨è‡ªå·±å¯¹è±¡ä¸­ä¸»åŠ¨å»åˆ›å»ºè¢«ä¾èµ–çš„å¯¹è±¡ï¼Œè¿™æ˜¯æ­£è½¬ã€‚ä½†æ˜¯æœ‰äº† IoC åï¼Œæ‰€ä¾èµ–çš„å¯¹è±¡ç›´æ¥ç”± IoC å®¹å™¨åˆ›å»ºåæ³¨å…¥åˆ°è¢«æ³¨å…¥çš„å¯¹è±¡ä¸­ï¼Œä¾èµ–çš„å¯¹è±¡ç”±åŸæ¥çš„ä¸»åŠ¨è·å–å˜æˆè¢«åŠ¨æ¥å—ï¼Œæ‰€ä»¥æ˜¯åè½¬ã€‚</li><li><strong>å“ªäº›æ–¹é¢åè½¬äº†</strong>ï¼šæ‰€ä¾èµ–å¯¹è±¡çš„è·å–è¢«åè½¬äº†ã€‚</li></ol><ul><li>Resource ä½“ç³»</li><li>ResourceLoader ä½“ç³»</li><li><strong>BeanFactory ä½“ç³»</strong></li><li>BeanDefinition ä½“ç³»</li><li><strong>ApplicationContext ä½“ç³»</strong></li><li>BeanDefinitionReader ä½“ç³»</li></ul><h4 id="BeanDefinition-è§£æ"><a href="#BeanDefinition-è§£æ" class="headerlink" title="BeanDefinition è§£æ"></a>BeanDefinition è§£æ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">ClassPathResource resource &#x3D; new ClassPathResource(&quot;bean.xml&quot;); &#x2F;&#x2F; &lt;1&gt;</span><br><span class="line">DefaultListableBeanFactory factory &#x3D; new DefaultListableBeanFactory(); &#x2F;&#x2F; &lt;2&gt;</span><br><span class="line">XmlBeanDefinitionReader reader &#x3D; new XmlBeanDefinitionReader(factory); &#x2F;&#x2F; &lt;3&gt;</span><br><span class="line">reader.loadBeanDefinitions(resource); &#x2F;&#x2F; &lt;4&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç æ˜¯ Spring ä¸­ç¼–ç¨‹å¼ä½¿ç”¨ IoC å®¹å™¨</p><ol><li>è·å–èµ„æº</li><li>è·å– BeanFactory</li><li>æ ¹æ®æ–°å»ºçš„ BeanFactory åˆ›å»ºä¸€ä¸ª BeanDefinitionReader å¯¹è±¡ï¼Œè¯¥ Reader å¯¹è±¡ä¸ºèµ„æºçš„<strong>è§£æå™¨</strong></li><li>è£…è½½èµ„æº</li></ol><p>èµ„æºå®šä½ã€è£…è½½ã€æ³¨å†Œ</p><p>DTD ä¸ XSD çš„åŒºåˆ«</p><p>DTD(Document Type Definition)ï¼Œå³æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Œä¸º XML æ–‡ä»¶çš„éªŒè¯æœºåˆ¶ï¼Œå±äº XML æ–‡ä»¶ä¸­ç»„æˆçš„ä¸€éƒ¨åˆ†ã€‚DTD æ˜¯ä¸€ç§ä¿è¯ XML æ–‡æ¡£æ ¼å¼æ­£ç¡®çš„æœ‰æ•ˆéªŒè¯æ–¹å¼ï¼Œå®ƒå®šä¹‰äº†ç›¸å…³ XML æ–‡æ¡£çš„å…ƒç´ ã€å±æ€§ã€æ’åˆ—æ–¹å¼ã€å…ƒç´ çš„å†…å®¹ç±»å‹ä»¥åŠå…ƒç´ çš„å±‚æ¬¡ç»“æ„ã€‚</p><p>XSDï¼ˆXML Schemas Definitionï¼‰å³ XML Schema è¯­è¨€ã€‚XML Schema æœ¬èº«å°±æ˜¯ä¸€ä¸ª XMLæ–‡æ¡£ï¼Œä½¿ç”¨çš„æ˜¯ XML è¯­æ³•ï¼Œå› æ­¤å¯ä»¥å¾ˆæ–¹ä¾¿çš„è§£æ XSD æ–‡æ¡£ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">org.springframework.beans.factory.xml.XmlBeanDefinitionReader#doLoadBeanDefinitions</span><br></pre></td></tr></table></figure><ol><li>è°ƒç”¨ <code>#getValidationModeForResource(Resource resource)</code> æ–¹æ³•ï¼Œè·å–æŒ‡å®šèµ„æºï¼ˆxmlï¼‰çš„<strong>éªŒè¯æ¨¡å¼</strong>ã€‚</li><li>è°ƒç”¨ <code>DocumentLoader#loadDocument(InputSource inputSource, EntityResolver entityResolver,ErrorHandler errorHandler, int validationMode, boolean namespaceAware)</code> æ–¹æ³•ï¼Œè·å– XML Document å®ä¾‹ã€‚</li><li>è°ƒç”¨ <code>#registerBeanDefinitions(Document doc, Resource resource)</code> æ–¹æ³•ï¼Œæ ¹æ®è·å–çš„ Document å®ä¾‹ï¼Œæ³¨å†Œ Bean ä¿¡æ¯ã€‚</li></ol><p><strong>BeanDefinition çš„è§£æè¿‡ç¨‹</strong></p><p><a href="http://static.iocoder.cn/images/Spring/2019-02-16/01.jpg"><img src="http://static.iocoder.cn/images/Spring/2019-02-16/01.jpg" alt="æ—¶åºå›¾"></a></p><h3 id="Bean"><a href="#Bean" class="headerlink" title="Bean"></a>Bean</h3><h4 id="Beanè§£æ"><a href="#Beanè§£æ" class="headerlink" title="Beanè§£æ"></a><strong>Beanè§£æ</strong></h4><p>Spring ä¸­æœ‰ä¸¤ç§è§£æ Bean çš„æ–¹å¼ï¼š</p><ul><li>å¦‚æœæ ¹èŠ‚ç‚¹æˆ–è€…å­èŠ‚ç‚¹é‡‡ç”¨é»˜è®¤å‘½åç©ºé—´çš„è¯ï¼Œåˆ™è°ƒç”¨ <code>#parseDefaultElement(...)</code> æ–¹æ³•ï¼Œè¿›è¡Œ<strong>é»˜è®¤</strong>æ ‡ç­¾è§£æ</li><li>å¦åˆ™ï¼Œè°ƒç”¨ <code>BeanDefinitionParserDelegate#parseCustomElement(...)</code> æ–¹æ³•ï¼Œè¿›è¡Œ<strong>è‡ªå®šä¹‰</strong>è§£æã€‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">&#x2F;&#x2F;DefaultBeanDefinitionDocumentReader.java</span><br><span class="line"></span><br><span class="line">protected void parseBeanDefinitions(Element root, BeanDefinitionParserDelegate delegate) &#123;</span><br><span class="line">     if (delegate.isDefaultNamespace(root)) &#123;</span><br><span class="line">         NodeList nl &#x3D; root.getChildNodes();</span><br><span class="line"></span><br><span class="line">         for(int i &#x3D; 0; i &lt; nl.getLength(); ++i) &#123;</span><br><span class="line">             Node node &#x3D; nl.item(i);</span><br><span class="line">             if (node instanceof Element) &#123;</span><br><span class="line">                 Element ele &#x3D; (Element)node;</span><br><span class="line">                 if (delegate.isDefaultNamespace(ele)) &#123;</span><br><span class="line">                     this.parseDefaultElement(ele, delegate);</span><br><span class="line">                 &#125; else &#123;</span><br><span class="line">                     delegate.parseCustomElement(ele);</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125; else &#123;</span><br><span class="line">         delegate.parseCustomElement(root);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h4 id="BeanåŠ è½½"><a href="#BeanåŠ è½½" class="headerlink" title="BeanåŠ è½½"></a>BeanåŠ è½½</h4><p>å½“æˆ‘ä»¬æ˜¾ç¤ºæˆ–è€…éšå¼åœ°è°ƒç”¨ <code>BeanFactory#getBean(String name)</code> æ–¹æ³•æ—¶ï¼Œåˆ™ä¼šè§¦å‘åŠ è½½ Bean é˜¶æ®µ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">&#x2F;&#x2F;AbstractBeanFactory.java</span><br><span class="line">@Override</span><br><span class="line">public Object getBean(String name) throws BeansException &#123;</span><br><span class="line">return doGetBean(name, null, null, false);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†…éƒ¨è°ƒç”¨ <code>doGetBean(String name, final Class&lt;T&gt; requiredType, Object[] args, boolean typeCheckOnly)</code> æ–¹æ³•ï¼Œå…¶æ¥å—å››ä¸ªæ–¹æ³•å‚æ•°ï¼š</p><ul><li><code>name</code> ï¼šè¦è·å– Bean çš„åå­—</li><li><code>requiredType</code> ï¼šè¦è·å– bean çš„ç±»å‹</li><li><code>args</code> ï¼šåˆ›å»º Bean æ—¶ä¼ é€’çš„å‚æ•°ã€‚è¿™ä¸ªå‚æ•°ä»…é™äºåˆ›å»º Bean æ—¶ä½¿ç”¨ã€‚</li><li><code>typeCheckOnly</code> ï¼šæ˜¯å¦ä¸ºç±»å‹æ£€æŸ¥ã€‚</li></ul><p><strong>Spring Bean åŠ è½½è¿‡ç¨‹çš„ä¸€ä¸ªæ¦‚è§ˆ</strong></p><ol><li>åˆ†æä»ç¼“å­˜ä¸­è·å–å•ä¾‹ Bean ï¼Œä»¥åŠå¯¹ Bean çš„å®ä¾‹ä¸­è·å–å¯¹è±¡ã€‚</li><li>å¦‚æœä»å•ä¾‹ç¼“å­˜ä¸­è·å– Bean ï¼ŒSpring æ˜¯æ€ä¹ˆåŠ è½½çš„å‘¢ï¼Ÿæ‰€ä»¥ç¬¬äºŒéƒ¨åˆ†æ˜¯åˆ†æ Bean åŠ è½½ï¼Œä»¥åŠ Bean çš„ä¾èµ–å¤„ç†ã€‚</li><li>Bean å·²ç»åŠ è½½äº†ï¼Œä¾èµ–ä¹Ÿå¤„ç†å®Œæ¯•äº†ï¼Œç¬¬ä¸‰éƒ¨åˆ†åˆ™åˆ†æå„ä¸ªä½œç”¨åŸŸçš„ Bean åˆå§‹åŒ–è¿‡ç¨‹ã€‚</li></ol><p><strong>æºç </strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">protected &lt;T&gt; T doGetBean(</span><br><span class="line">String name, @Nullable Class&lt;T&gt; requiredType, @Nullable Object[] args, boolean typeCheckOnly)</span><br><span class="line">throws BeansException &#123;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; å¦‚æœ name æ˜¯ alias ï¼Œåˆ™è·å–å¯¹åº”æ˜ å°„çš„ beanName ã€‚</span><br><span class="line">String beanName &#x3D; transformedBeanName(name);</span><br><span class="line">Object beanInstance;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ä»ç¼“å­˜ä¸­æˆ–è€…å®ä¾‹å·¥å‚ä¸­è·å– Bean å¯¹è±¡</span><br><span class="line">&#x2F;&#x2F; Eagerly check singleton cache for manually registered singletons.</span><br><span class="line">Object sharedInstance &#x3D; getSingleton(beanName);</span><br><span class="line">if (sharedInstance !&#x3D; null &amp;&amp; args &#x3D;&#x3D; null) &#123;</span><br><span class="line">if (logger.isTraceEnabled()) &#123;</span><br><span class="line">if (isSingletonCurrentlyInCreation(beanName)) &#123;</span><br><span class="line">logger.trace(&quot;Returning eagerly cached instance of singleton bean &#39;&quot; + beanName +</span><br><span class="line">&quot;&#39; that is not fully initialized yet - a consequence of a circular reference&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">logger.trace(&quot;Returning cached instance of singleton bean &#39;&quot; + beanName + &quot;&#39;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;å®Œæˆ FactoryBean çš„ç›¸å…³å¤„ç†ï¼Œå¹¶ç”¨æ¥è·å– FactoryBean çš„å¤„ç†ç»“æœ</span><br><span class="line">beanInstance &#x3D; getObjectForBeanInstance(sharedInstance, name, beanName, null);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else &#123;</span><br><span class="line">&#x2F;&#x2F; Fail if we&#39;re already creating this bean instance:</span><br><span class="line">&#x2F;&#x2F; We&#39;re assumably within a circular reference.</span><br><span class="line">&#x2F;&#x2F;å› ä¸º Spring åªè§£å†³å•ä¾‹æ¨¡å¼ä¸‹å¾—å¾ªç¯ä¾èµ–ï¼Œåœ¨åŸå‹æ¨¡å¼ä¸‹å¦‚æœå­˜åœ¨å¾ªç¯ä¾èµ–åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</span><br><span class="line">if (isPrototypeCurrentlyInCreation(beanName)) &#123;</span><br><span class="line">throw new BeanCurrentlyInCreationException(beanName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;å¦‚æœå®¹å™¨ä¸­æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä»çˆ¶ç±»å®¹å™¨ä¸­åŠ è½½</span><br><span class="line">&#x2F;&#x2F; Check if bean definition exists in this factory.</span><br><span class="line">BeanFactory parentBeanFactory &#x3D; getParentBeanFactory();</span><br><span class="line">if (parentBeanFactory !&#x3D; null &amp;&amp; !containsBeanDefinition(beanName)) &#123;</span><br><span class="line">&#x2F;&#x2F; Not found -&gt; check parent.</span><br><span class="line">String nameToLookup &#x3D; originalBeanName(name);</span><br><span class="line">if (parentBeanFactory instanceof AbstractBeanFactory) &#123;</span><br><span class="line">return ((AbstractBeanFactory) parentBeanFactory).doGetBean(</span><br><span class="line">nameToLookup, requiredType, args, typeCheckOnly);</span><br><span class="line">&#125;</span><br><span class="line">else if (args !&#x3D; null) &#123;</span><br><span class="line">&#x2F;&#x2F; Delegation to parent with explicit args.</span><br><span class="line">return (T) parentBeanFactory.getBean(nameToLookup, args);</span><br><span class="line">&#125;</span><br><span class="line">else if (requiredType !&#x3D; null) &#123;</span><br><span class="line">&#x2F;&#x2F; No args -&gt; delegate to standard getBean method.</span><br><span class="line">return parentBeanFactory.getBean(nameToLookup, requiredType);</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">return (T) parentBeanFactory.getBean(nameToLookup);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;å¦‚æœä¸æ˜¯ä»…ä»…åšç±»å‹æ£€æŸ¥åˆ™æ˜¯åˆ›å»ºbeanï¼Œè¿™é‡Œéœ€è¦è®°å½•</span><br><span class="line">if (!typeCheckOnly) &#123;</span><br><span class="line">markBeanAsCreated(beanName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">StartupStep beanCreation &#x3D; this.applicationStartup.start(&quot;spring.beans.instantiate&quot;)</span><br><span class="line">.tag(&quot;beanName&quot;, name);</span><br><span class="line">try &#123;</span><br><span class="line">if (requiredType !&#x3D; null) &#123;</span><br><span class="line">beanCreation.tag(&quot;beanType&quot;, requiredType::toString);</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;ä»å®¹å™¨ä¸­è·å– beanName ç›¸åº”çš„ GenericBeanDefinition å¯¹è±¡ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸º RootBeanDefinition å¯¹è±¡</span><br><span class="line">RootBeanDefinition mbd &#x3D; getMergedLocalBeanDefinition(beanName);</span><br><span class="line">&#x2F;&#x2F;æ£€æŸ¥ç»™å®šçš„åˆå¹¶çš„ BeanDefinition</span><br><span class="line">checkMergedBeanDefinition(mbd, beanName, args);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Guarantee initialization of beans that the current bean depends on.</span><br><span class="line">String[] dependsOn &#x3D; mbd.getDependsOn();</span><br><span class="line">if (dependsOn !&#x3D; null) &#123;</span><br><span class="line">for (String dep : dependsOn) &#123;</span><br><span class="line">if (isDependent(beanName, dep)) &#123;</span><br><span class="line">throw new BeanCreationException(mbd.getResourceDescription(), beanName,</span><br><span class="line">&quot;Circular depends-on relationship between &#39;&quot; + beanName + &quot;&#39; and &#39;&quot; + dep + &quot;&#39;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">registerDependentBean(dep, beanName);</span><br><span class="line">try &#123;</span><br><span class="line">getBean(dep);</span><br><span class="line">&#125;</span><br><span class="line">catch (NoSuchBeanDefinitionException ex) &#123;</span><br><span class="line">throw new BeanCreationException(mbd.getResourceDescription(), beanName,</span><br><span class="line">&quot;&#39;&quot; + beanName + &quot;&#39; depends on missing bean &#39;&quot; + dep + &quot;&#39;&quot;, ex);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Create bean instance.</span><br><span class="line">if (mbd.isSingleton()) &#123;</span><br><span class="line">sharedInstance &#x3D; getSingleton(beanName, () -&gt; &#123;</span><br><span class="line">try &#123;</span><br><span class="line">return createBean(beanName, mbd, args);</span><br><span class="line">&#125;</span><br><span class="line">catch (BeansException ex) &#123;</span><br><span class="line">&#x2F;&#x2F; Explicitly remove instance from singleton cache: It might have been put there</span><br><span class="line">&#x2F;&#x2F; eagerly by the creation process, to allow for circular reference resolution.</span><br><span class="line">&#x2F;&#x2F; Also remove any beans that received a temporary reference to the bean.</span><br><span class="line">destroySingleton(beanName);</span><br><span class="line">throw ex;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">beanInstance &#x3D; getObjectForBeanInstance(sharedInstance, name, beanName, mbd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else if (mbd.isPrototype()) &#123;</span><br><span class="line">&#x2F;&#x2F; It&#39;s a prototype -&gt; create a new instance.</span><br><span class="line">Object prototypeInstance &#x3D; null;</span><br><span class="line">try &#123;</span><br><span class="line">beforePrototypeCreation(beanName);</span><br><span class="line">prototypeInstance &#x3D; createBean(beanName, mbd, args);</span><br><span class="line">&#125;</span><br><span class="line">finally &#123;</span><br><span class="line">afterPrototypeCreation(beanName);</span><br><span class="line">&#125;</span><br><span class="line">beanInstance &#x3D; getObjectForBeanInstance(prototypeInstance, name, beanName, mbd);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else &#123;</span><br><span class="line">String scopeName &#x3D; mbd.getScope();</span><br><span class="line">if (!StringUtils.hasLength(scopeName)) &#123;</span><br><span class="line">throw new IllegalStateException(&quot;No scope name defined for bean Â´&quot; + beanName + &quot;&#39;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">Scope scope &#x3D; this.scopes.get(scopeName);</span><br><span class="line">if (scope &#x3D;&#x3D; null) &#123;</span><br><span class="line">throw new IllegalStateException(&quot;No Scope registered for scope name &#39;&quot; + scopeName + &quot;&#39;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">try &#123;</span><br><span class="line">Object scopedInstance &#x3D; scope.get(beanName, () -&gt; &#123;</span><br><span class="line">beforePrototypeCreation(beanName);</span><br><span class="line">try &#123;</span><br><span class="line">return createBean(beanName, mbd, args);</span><br><span class="line">&#125;</span><br><span class="line">finally &#123;</span><br><span class="line">afterPrototypeCreation(beanName);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">beanInstance &#x3D; getObjectForBeanInstance(scopedInstance, name, beanName, mbd);</span><br><span class="line">&#125;</span><br><span class="line">catch (IllegalStateException ex) &#123;</span><br><span class="line">throw new ScopeNotActiveException(beanName, scopeName, ex);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">catch (BeansException ex) &#123;</span><br><span class="line">beanCreation.tag(&quot;exception&quot;, ex.getClass().toString());</span><br><span class="line">beanCreation.tag(&quot;message&quot;, String.valueOf(ex.getMessage()));</span><br><span class="line">cleanupAfterBeanCreationFailure(beanName);</span><br><span class="line">throw ex;</span><br><span class="line">&#125;</span><br><span class="line">finally &#123;</span><br><span class="line">beanCreation.end();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return adaptBeanInstance(name, beanInstance, requiredType);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Spring bean çš„åŠ è½½è¿‡ç¨‹</p><ol><li>ä»ç¼“å­˜ä¸­è·å– bean</li><li>åˆ›å»º bean å®ä¾‹å¯¹è±¡</li><li>ä» bean å®ä¾‹ä¸­è·å–å¯¹è±¡</li></ol><h4 id="Bean-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Bean-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Bean çš„ç”Ÿå‘½å‘¨æœŸ"></a>Bean çš„ç”Ÿå‘½å‘¨æœŸ</h4><p>Spring Bean å®ä¾‹åŒ–è¿‡ç¨‹ä¸­æåˆ° Spring å¹¶ä¸æ˜¯ä¸€å¯åŠ¨å®¹å™¨å°±å¼€å¯ bean çš„å®ä¾‹åŒ–è¿›ç¨‹ï¼Œåªæœ‰å½“å®¢æˆ·ç«¯é€šè¿‡æ˜¾ç¤ºæˆ–è€…éšå¼çš„æ–¹å¼è°ƒç”¨ BeanFactory çš„ <code>#getBean(...)</code> æ–¹æ³•æ¥è¯·æ±‚æŸä¸ªå®ä¾‹å¯¹è±¡çš„æ—¶å€™ï¼Œå®ƒæ‰ä¼šè§¦å‘ç›¸åº” bean çš„å®ä¾‹åŒ–è¿›ç¨‹ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ç›´æ¥ä½¿ç”¨ ApplicationContext å®¹å™¨ï¼Œå› ä¸ºè¯¥å®¹å™¨å¯åŠ¨çš„æ—¶å€™ä¼šç«‹åˆ»è°ƒç”¨æ³¨å†Œåˆ°è¯¥å®¹å™¨æ‰€æœ‰ bean å®šä¹‰çš„å®ä¾‹åŒ–æ–¹æ³•ã€‚å½“ç„¶ï¼Œå¯¹äº BeanFactory å®¹å™¨è€Œè¨€ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ <code>#getBean(...)</code> æ–¹æ³•éƒ½ä¼šè§¦å‘å®ä¾‹åŒ–è¿›ç¨‹ï¼Œæ¯”å¦‚ singleton ç±»å‹çš„ beanï¼Œè¯¥ç±»å‹çš„ bean åªä¼šåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ <code>getBean()</code> çš„æ—¶å€™æ‰ä¼šè§¦å‘ï¼Œè€Œåç»­çš„è°ƒç”¨åˆ™ä¼šç›´æ¥è¿”å›å®¹å™¨ç¼“å­˜ä¸­çš„å®ä¾‹å¯¹è±¡ã€‚</p><p><code>#getBean(...)</code> æ–¹æ³•ï¼Œåªæ˜¯ bean å®ä¾‹åŒ–è¿›ç¨‹çš„å…¥å£ï¼ŒçœŸæ­£çš„å®ç°é€»è¾‘å…¶å®æ˜¯åœ¨ AbstractAutowireCapableBeanFactory çš„ <code>#doCreateBean(...)</code> ä¸­å®ç°</p><p><a href="http://static.iocoder.cn/2a90a57e3bb96cc6ffa2619babe72bc4"><img src="http://static.iocoder.cn/2a90a57e3bb96cc6ffa2619babe72bc4" alt="img"></a></p><p><strong>bean å®ä¾‹åŒ–</strong></p><p>åœ¨ <code>#doCreateBean(...)</code> æ–¹æ³•ä¸­ï¼Œé¦–å…ˆè¿›è¡Œ bean å®ä¾‹åŒ–å·¥ä½œ</p><p>è¿™ä¸ªæ—¶å€™çš„ Bean è¿˜ä¸èƒ½å¤Ÿè¢«æˆ‘ä»¬ä½¿ç”¨ï¼Œè¿æœ€åŸºæœ¬çš„å±æ€§éƒ½æ²¡æœ‰è®¾ç½®</p><p>åœ¨å®ä¾‹åŒ– bean è¿‡ç¨‹ä¸­ï¼ŒSpring é‡‡ç”¨â€œç­–ç•¥æ¨¡å¼â€æ¥å†³å®šé‡‡ç”¨å“ªç§æ–¹å¼æ¥å®ä¾‹åŒ– beanï¼Œä¸€èˆ¬æœ‰åå°„å’Œ CGLIB åŠ¨æ€å­—èŠ‚ç ä¸¤ç§æ–¹å¼ã€‚</p><p><strong>æ¿€æ´» Aware</strong></p><p>å®Œæˆ bean å¯¹è±¡å®ä¾‹åŒ–å¹¶ä¸”è®¾ç½®å®Œç›¸å…³å±æ€§å’Œä¾èµ–åï¼Œåˆ™ä¼šå¼€å§‹ bean çš„åˆå§‹åŒ–è¿›ç¨‹ï¼ˆ <code>#initializeBean(...)</code> ï¼‰ï¼Œåˆå§‹åŒ–ç¬¬ä¸€ä¸ªé˜¶æ®µæ˜¯æ£€æŸ¥å½“å‰ bean å¯¹è±¡æ˜¯å¦å®ç°äº†ä¸€ç³»åˆ—ä»¥ Aware ç»“å°¾çš„çš„æ¥å£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">private void invokeAwareMethods(String beanName, Object bean) &#123;</span><br><span class="line">if (bean instanceof Aware) &#123;</span><br><span class="line">if (bean instanceof BeanNameAware) &#123;</span><br><span class="line">((BeanNameAware) bean).setBeanName(beanName);</span><br><span class="line">&#125;</span><br><span class="line">if (bean instanceof BeanClassLoaderAware) &#123;</span><br><span class="line">ClassLoader bcl &#x3D; getBeanClassLoader();</span><br><span class="line">if (bcl !&#x3D; null) &#123;</span><br><span class="line">((BeanClassLoaderAware) bean).setBeanClassLoader(bcl);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">if (bean instanceof BeanFactoryAware) &#123;</span><br><span class="line">((BeanFactoryAware) bean).setBeanFactory(AbstractAutowireCapableBeanFactory.this);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>BeanPostProcessor</strong></p><p>å¯¹ Spring å®¹å™¨æä¾›çš„ bean å®ä¾‹å¯¹è±¡è¿›è¡Œæœ‰æ•ˆçš„æ‰©å±• å¢å¼ºå¤„ç†</p><p>å‰ç½®å¤„ç†å’Œåç½®å¤„ç†</p><p><strong>InitializingBean å’Œ init-method</strong></p><p>åœ¨ bean çš„åˆå§‹åŒ–è¿›ç¨‹ä¸­ä¼šåˆ¤æ–­å½“å‰ bean æ˜¯å¦å®ç°äº† InitializingBeanï¼Œå¦‚æœå®ç°äº†åˆ™è°ƒç”¨ <code>#afterPropertiesSet()</code> æ–¹æ³•ï¼Œè¿›è¡Œåˆå§‹åŒ–å·¥ä½œã€‚ç„¶åå†æ£€æŸ¥æ˜¯å¦ä¹ŸæŒ‡å®šäº† <code>init-method</code> ï¼Œå¦‚æœæŒ‡å®šäº†åˆ™é€šè¿‡åå°„æœºåˆ¶è°ƒç”¨æŒ‡å®šçš„ <code>init-method</code> æ–¹æ³•ã€‚</p><p><strong>DisposableBean å’Œ destroy-method</strong></p><p>ä¸ InitializingBean å’Œ <code>init-method</code> ç”¨äºå¯¹è±¡çš„è‡ªå®šä¹‰åˆå§‹åŒ–å·¥ä½œç›¸ä¼¼ï¼ŒDisposableBeanå’Œ <code>destroy-method</code> åˆ™ç”¨äºå¯¹è±¡çš„è‡ªå®šä¹‰é”€æ¯å·¥ä½œã€‚</p><p>å½“ä¸€ä¸ª bean å¯¹è±¡ç»å†äº†å®ä¾‹åŒ–ã€è®¾ç½®å±æ€§ã€åˆå§‹åŒ–é˜¶æ®µï¼Œé‚£ä¹ˆè¯¥ bean å¯¹è±¡å°±å¯ä»¥ä¾›å®¹å™¨ä½¿ç”¨äº†ï¼ˆè°ƒç”¨çš„è¿‡ç¨‹ï¼‰ã€‚å½“å®Œæˆè°ƒç”¨åï¼Œå¦‚æœæ˜¯ singleton ç±»å‹çš„ bean ï¼Œåˆ™ä¼šçœ‹å½“å‰ bean æ˜¯å¦åº”å®ç°äº† DisposableBean æ¥å£æˆ–è€…é…ç½®äº† <code>destroy-method</code> å±æ€§ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œåˆ™ä¼šä¸ºè¯¥å®ä¾‹æ³¨å†Œä¸€ä¸ªç”¨äºå¯¹è±¡é”€æ¯çš„å›è°ƒæ–¹æ³•ï¼Œä¾¿äºåœ¨è¿™äº› singleton ç±»å‹çš„ bean å¯¹è±¡é”€æ¯ä¹‹å‰æ‰§è¡Œé”€æ¯é€»è¾‘ã€‚</p><p>ä½†æ˜¯ï¼Œå¹¶ä¸æ˜¯å¯¹è±¡å®Œæˆè°ƒç”¨åå°±ä¼šç«‹åˆ»æ‰§è¡Œé”€æ¯æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™ Spring å®¹å™¨è¿˜å¤„äºè¿è¡Œé˜¶æ®µï¼Œåªæœ‰å½“ Spring å®¹å™¨å…³é—­çš„æ—¶å€™æ‰ä¼šå»è°ƒç”¨ã€‚ä½†æ˜¯ï¼Œ Spring å®¹å™¨ä¸ä¼šè¿™ä¹ˆèªæ˜ä¼šè‡ªåŠ¨å»è°ƒç”¨è¿™äº›é”€æ¯æ–¹æ³•ï¼Œè€Œæ˜¯éœ€è¦æˆ‘ä»¬ä¸»åŠ¨å»å‘ŠçŸ¥ Spring å®¹å™¨ã€‚</p><ul><li>å¯¹äº BeanFactory å®¹å™¨è€Œè¨€ï¼Œæˆ‘ä»¬éœ€è¦ä¸»åŠ¨è°ƒç”¨ <code>#destroySingletons()</code> æ–¹æ³•ï¼Œé€šçŸ¥ BeanFactory å®¹å™¨å»æ‰§è¡Œç›¸åº”çš„é”€æ¯æ–¹æ³•ã€‚</li><li>å¯¹äº ApplicationContext å®¹å™¨è€Œè¨€ï¼Œè°ƒç”¨ <code>#registerShutdownHook()</code> æ–¹æ³•ã€‚</li></ul><h4 id="ApplicationContext-æ¶æ„"><a href="#ApplicationContext-æ¶æ„" class="headerlink" title="ApplicationContext æ¶æ„"></a>ApplicationContext æ¶æ„</h4><p><a href="http://static.iocoder.cn/3a0321713096156d42661f2df11a93c2"><img src="http://static.iocoder.cn/3a0321713096156d42661f2df11a93c2" alt="ApplicationContext ç»“æ„ç±»å›¾"></a></p><ol><li>ç»§æ‰¿ MessageSourceï¼Œæä¾›å›½é™…åŒ–çš„æ ‡å‡†è®¿é—®ç­–ç•¥ã€‚</li><li>ç»§æ‰¿ ApplicationEventPublisher ï¼Œæä¾›å¼ºå¤§çš„äº‹ä»¶æœºåˆ¶ã€‚</li><li>æ‰©å±• ResourceLoaderï¼Œå¯ä»¥ç”¨æ¥åŠ è½½å¤šä¸ª Resourceï¼Œå¯ä»¥çµæ´»è®¿é—®ä¸åŒçš„èµ„æºã€‚</li><li>å¯¹ Web åº”ç”¨çš„æ”¯æŒã€‚</li></ol><p><strong>ApplicationContextå­æ¥å£</strong></p><p>WebApplicationContext</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">&#x2F;&#x2F; WebApplicationContext.java</span><br><span class="line"></span><br><span class="line">public interface WebApplicationContext extends ApplicationContext &#123;</span><br><span class="line"></span><br><span class="line">    ServletContext getServletContext();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ¥å£åªæœ‰ä¸€ä¸ª <code>#getServletContext()</code> æ–¹æ³•ï¼Œç”¨äºç»™ Servlet æä¾›ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p><p>ConfigurableApplicationContext</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">&#x2F;&#x2F; ConfigurableApplicationContext.java</span><br><span class="line"></span><br><span class="line">public interface ConfigurableApplicationContext extends ApplicationContext, Lifecycle, Closeable &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; ä¸º ApplicationContext è®¾ç½®å”¯ä¸€ ID</span><br><span class="line">    void setId(String id);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; ä¸º ApplicationContext è®¾ç½® parent</span><br><span class="line">    &#x2F;&#x2F; çˆ¶ç±»ä¸åº”è¯¥è¢«ä¿®æ”¹ï¼šå¦‚æœåˆ›å»ºçš„å¯¹è±¡ä¸å¯ç”¨æ—¶ï¼Œåˆ™åº”è¯¥åœ¨æ„é€ å‡½æ•°å¤–éƒ¨è®¾ç½®å®ƒ</span><br><span class="line">    void setParent(@Nullable ApplicationContext parent);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; è®¾ç½® Environment</span><br><span class="line">    void setEnvironment(ConfigurableEnvironment environment);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; è·å– Environment</span><br><span class="line">    @Override</span><br><span class="line">    ConfigurableEnvironment getEnvironment();</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; æ·»åŠ  BeanFactoryPostProcessor</span><br><span class="line">    void addBeanFactoryPostProcessor(BeanFactoryPostProcessor postProcessor);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; æ·»åŠ  ApplicationListener</span><br><span class="line">    void addApplicationListener(ApplicationListener&lt;?&gt; listener);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; æ·»åŠ  ProtocolResolver</span><br><span class="line">    void addProtocolResolver(ProtocolResolver resolver);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; åŠ è½½æˆ–è€…åˆ·æ–°é…ç½®</span><br><span class="line">    &#x2F;&#x2F; è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ–¹æ³•</span><br><span class="line">    void refresh() throws BeansException, IllegalStateException;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; æ³¨å†Œ shutdown hook</span><br><span class="line">    void registerShutdownHook();</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; å…³é—­ ApplicationContext</span><br><span class="line">    @Override</span><br><span class="line">    void close();</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; ApplicationContext æ˜¯å¦å¤„äºæ¿€æ´»çŠ¶æ€</span><br><span class="line">    boolean isActive();</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; è·å–å½“å‰ä¸Šä¸‹æ–‡çš„ BeanFactory</span><br><span class="line">    ConfigurableListableBeanFactory getBeanFactory() throws IllegalStateException;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ConfigurableApplicationContext æ¥å£æä¾›çš„æ–¹æ³•éƒ½æ˜¯å¯¹ ApplicationContext è¿›è¡Œé…ç½®çš„</p><p>ConfigurableWebApplicationContext</p><p>è¯¥æ¥å£å°†è¿™ä¸¤ä¸ªæ¥å£è¿›è¡Œåˆå¹¶</p><p><strong>ClassPathXmlApplicationContext</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">&#x2F;&#x2F; ç¤ºä¾‹</span><br><span class="line">ApplicationContext ac &#x3D; new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);</span><br><span class="line">StudentService studentService &#x3D; (StudentService)ac.getBean(&quot;studentService&quot;);</span><br><span class="line">CODE</span><br><span class="line">org.springframework.context.support.AbstractApplicationContext</span><br><span class="line">      org.springframework.context.support.AbstractRefreshableApplicationContext</span><br><span class="line">            org.springframework.context.support.AbstractRefreshableConfigApplicationContext</span><br><span class="line">                  org.springframework.context.support.AbstractXmlApplicationContext</span><br><span class="line">                        org.springframework.context.support.ClassPathXmlApplicationContext</span><br></pre></td></tr></table></figure><p>è¿™ç§è®¾è®¡æ˜¯æ¨¡æ¿æ–¹æ³•æ¨¡å¼å…¸å‹çš„åº”ç”¨ï¼ŒAbstractApplicationContext å®ç°äº† ConfigurableApplicationContext è¿™ä¸ªå…¨å®¶æ¡¶æ¥å£ï¼Œå…¶å­ç±» AbstractRefreshableConfigApplicationContext åˆå®ç°äº† BeanNameAware å’Œ InitializingBean æ¥å£ã€‚æ‰€ä»¥ ClassPathXmlApplicationContext è®¾è®¡çš„é¡¶çº§æ¥å£æœ‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">BeanFactoryï¼šSpring å®¹å™¨ Bean çš„ç®¡ç†</span><br><span class="line">MessageSourceï¼šç®¡ç† message ï¼Œå®ç°å›½é™…åŒ–ç­‰åŠŸèƒ½</span><br><span class="line">ApplicationEventPublisherï¼šäº‹ä»¶å‘å¸ƒ</span><br><span class="line">ResourcePatternResolverï¼šèµ„æºåŠ è½½</span><br><span class="line">EnvironmentCapableï¼šç³»ç»Ÿ Environmentï¼ˆprofile + Propertiesï¼‰ ç›¸å…³</span><br><span class="line">Lifecycleï¼šç®¡ç†ç”Ÿå‘½å‘¨æœŸ</span><br><span class="line">Closableï¼šå…³é—­ï¼Œé‡Šæ”¾èµ„æº</span><br><span class="line">InitializingBeanï¼šè‡ªå®šä¹‰åˆå§‹åŒ–</span><br><span class="line">BeanNameAwareï¼šè®¾ç½® beanName çš„ Aware æ¥å£</span><br></pre></td></tr></table></figure><p>Spring çœŸçš„æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„æ¡†æ¶ï¼Œå…·æœ‰è‰¯å¥½çš„ç»“æ„è®¾è®¡å’Œæ¥å£æŠ½è±¡ï¼Œå®ƒçš„æ¯ä¸€ä¸ªæ¥å£èŒèƒ½å•ä¸€ï¼Œä¸”éƒ½æ˜¯å…·ä½“åŠŸèƒ½åˆ°å„ä¸ªæ¨¡å—çš„é«˜åº¦æŠ½è±¡ï¼Œä¸”å‡ ä¹æ¯å¥—æ¥å£éƒ½æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„å®ç°ï¼ˆdefaultXXXï¼‰ã€‚</p><p>å¯¹äº ApplicationContext ä½“ç³»è€Œè¨€ï¼Œä»–ç»§æ‰¿ Spring ä¸­ä¼—å¤šçš„æ ¸å¿ƒæ¥å£ï¼Œèƒ½å¤Ÿä¸ºå®¢æˆ·ç«¯æä¾›ä¸€ä¸ªç›¸å¯¹å®Œæ•´çš„ Spring å®¹å™¨ï¼Œæ¥å£ ConfigurableApplicationContext å¯¹ ApplicationContext æ¥å£å†æ¬¡è¿›è¡Œæ‰©å±•ï¼Œæä¾›äº†ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†åŠŸèƒ½ã€‚<br>æŠ½è±¡ç±» ApplicationContext å¯¹æ•´å¥—æ¥å£æä¾›äº†å¤§éƒ¨åˆ†çš„é»˜è®¤å®ç°ï¼Œå°†å…¶ä¸­â€œä¸æ˜“å˜åŠ¨â€çš„éƒ¨åˆ†è¿›è¡Œäº†å°è£…ï¼Œé€šè¿‡â€œç»„åˆâ€çš„æ–¹å¼å°†â€œå®¹æ˜“å˜åŠ¨â€çš„åŠŸèƒ½å§”æ‰˜ç»™å…¶ä»–ç±»æ¥å®ç°ï¼ŒåŒæ—¶åˆ©ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼å°†ä¸€äº›æ–¹æ³•çš„å®ç°å¼€æ”¾å‡ºå»ç”±å­ç±»å®ç°ï¼Œä»è€Œå®ç°â€œ<strong>å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­</strong>â€çš„è®¾è®¡åŸåˆ™ã€‚</p><h3 id=""><a href="#" class="headerlink" title=""></a><a href="http://static.iocoder.cn/dde0bf4ae9014ec73c80f4c45045850a"><img src="http://static.iocoder.cn/dde0bf4ae9014ec73c80f4c45045850a" alt="ClassPathXmlApplicationContext çš„ç±»å›¾"></a></h3><p><strong>ApplicationContext çš„ refresh()æ–¹æ³•</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">void refresh() throws BeansException, IllegalStateException;</span><br></pre></td></tr></table></figure><p><strong>åˆ·æ–° Spring çš„åº”ç”¨ä¸Šä¸‹æ–‡</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">&#x2F;&#x2F; AbstractApplicationContext.java</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void refresh() throws BeansException, IllegalStateException &#123;</span><br><span class="line">synchronized (this.startupShutdownMonitor) &#123;</span><br><span class="line">&#x2F;&#x2F; å‡†å¤‡åˆ·æ–°ä¸Šä¸‹æ–‡ç¯å¢ƒ</span><br><span class="line">prepareRefresh();</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; åˆ›å»ºå¹¶åˆå§‹åŒ– BeanFactory</span><br><span class="line">ConfigurableListableBeanFactory beanFactory &#x3D; obtainFreshBeanFactory();</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; å¡«å……BeanFactoryåŠŸèƒ½</span><br><span class="line">prepareBeanFactory(beanFactory);</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line">&#x2F;&#x2F; æä¾›å­ç±»è¦†ç›–çš„é¢å¤–å¤„ç†ï¼Œå³å­ç±»å¤„ç†è‡ªå®šä¹‰çš„BeanFactoryPostProcess</span><br><span class="line">postProcessBeanFactory(beanFactory);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æ¿€æ´»å„ç§BeanFactoryå¤„ç†å™¨</span><br><span class="line">invokeBeanFactoryPostProcessors(beanFactory);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æ³¨å†Œæ‹¦æˆªBeanåˆ›å»ºçš„Beanå¤„ç†å™¨ï¼Œå³æ³¨å†Œ BeanPostProcessor</span><br><span class="line">registerBeanPostProcessors(beanFactory);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; åˆå§‹åŒ–ä¸Šä¸‹æ–‡ä¸­çš„èµ„æºæ–‡ä»¶ï¼Œå¦‚å›½é™…åŒ–æ–‡ä»¶çš„å¤„ç†ç­‰</span><br><span class="line">initMessageSource();</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; åˆå§‹åŒ–ä¸Šä¸‹æ–‡äº‹ä»¶å¹¿æ’­å™¨</span><br><span class="line">initApplicationEventMulticaster();</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ç»™å­ç±»æ‰©å±•åˆå§‹åŒ–å…¶ä»–Bean</span><br><span class="line">onRefresh();</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; åœ¨æ‰€æœ‰beanä¸­æŸ¥æ‰¾listener beanï¼Œç„¶åæ³¨å†Œåˆ°å¹¿æ’­å™¨ä¸­</span><br><span class="line">registerListeners();</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; åˆå§‹åŒ–å‰©ä¸‹çš„å•ä¾‹Bean(éå»¶è¿ŸåŠ è½½çš„)</span><br><span class="line">finishBeanFactoryInitialization(beanFactory);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; å®Œæˆåˆ·æ–°è¿‡ç¨‹,é€šçŸ¥ç”Ÿå‘½å‘¨æœŸå¤„ç†å™¨lifecycleProcessoråˆ·æ–°è¿‡ç¨‹,åŒæ—¶å‘å‡ºContextRefreshEventé€šçŸ¥åˆ«äºº</span><br><span class="line">finishRefresh();</span><br><span class="line">&#125; catch (BeansException ex) &#123;</span><br><span class="line">if (logger.isWarnEnabled()) &#123;</span><br><span class="line">logger.warn(&quot;Exception encountered during context initialization - &quot; +</span><br><span class="line">&quot;cancelling refresh attempt: &quot; + ex);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;  é”€æ¯å·²ç»åˆ›å»ºçš„Bean</span><br><span class="line">destroyBeans();</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; é‡ç½®å®¹å™¨æ¿€æ´»æ ‡ç­¾</span><br><span class="line">cancelRefresh(ex);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; æŠ›å‡ºå¼‚å¸¸</span><br><span class="line">throw ex;</span><br><span class="line">&#125; finally &#123;</span><br><span class="line">&#x2F;&#x2F; Reset common introspection caches in Spring&#39;s core, since we</span><br><span class="line">&#x2F;&#x2F; might not ever need metadata for singleton beans anymore...</span><br><span class="line">resetCommonCaches();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h3><p>â€¦</p><h3 id="Transaction"><a href="#Transaction" class="headerlink" title="Transaction"></a>Transaction</h3><p>â€¦</p><h3 id="IOCæµç¨‹å›¾"><a href="#IOCæµç¨‹å›¾" class="headerlink" title="IOCæµç¨‹å›¾"></a>IOCæµç¨‹å›¾</h3><ol><li>Bean çš„è½¬æ¢è¿‡ç¨‹</li></ol><p>ä¸‹é¢è¿™å¼ å›¾æ¼”ç¤ºäº†ä¸€ä¸ªå¯ç”¨çš„ bean æ˜¯å¦‚ä½•ä» xml é…ç½®æ–‡ä»¶ä¸­æ¼”å˜è¿‡æ¥çš„ã€‚</p><p><a href="http://static.iocoder.cn/365d4142eb23822dcaddba6d1f59ccbc"><img src="http://static.iocoder.cn/365d4142eb23822dcaddba6d1f59ccbc" alt="img"></a></p><ol><li>ApplicationContext çš„æ¶æ„å›¾</li></ol><p><a href="http://static.iocoder.cn/dde0bf4ae9014ec73c80f4c45045850a"><img src="http://static.iocoder.cn/dde0bf4ae9014ec73c80f4c45045850a" alt="img"></a></p><ol><li>load BeanDefinition çš„å…¨æµç¨‹</li></ol><p><a href="http://static.iocoder.cn/38419d23d29c83a4758f73f85281e076"><img src="http://static.iocoder.cn/38419d23d29c83a4758f73f85281e076" alt="img"></a></p><ol><li>get Bean çš„å…¨æµç¨‹</li></ol><p><a href="http://static.iocoder.cn/3a5b28a2d3bd435ca94ea5c8752609d5"><img src="http://static.iocoder.cn/3a5b28a2d3bd435ca94ea5c8752609d5" alt="img"></a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;æ¶æ„&quot;&gt;&lt;a href=&quot;#æ¶æ„&quot; class=&quot;headerlink&quot; title=&quot;æ¶æ„&quot;&gt;&lt;/a&gt;æ¶æ„&lt;/h3&gt;&lt;p&gt;Spring Framework&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://static.iocoder.cn/images/Sprin</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Docker</title>
    <link href="http://example.com/2021/12/01/Docker/"/>
    <id>http://example.com/2021/12/01/Docker/</id>
    <published>2021-11-30T16:02:17.000Z</published>
    <updated>2021-12-06T15:23:18.464Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1ã€ç®€ä»‹"><a href="#1ã€ç®€ä»‹" class="headerlink" title="1ã€ç®€ä»‹"></a>1ã€ç®€ä»‹</h2><p>Dockeræ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼›æ˜¯ä¸€ä¸ªè½»é‡çº§å®¹å™¨æŠ€æœ¯ï¼›</p><p>Dockeræ”¯æŒå°†è½¯ä»¶ç¼–è¯‘æˆä¸€ä¸ªé•œåƒï¼›ç„¶ååœ¨é•œåƒä¸­å„ç§è½¯ä»¶åšå¥½é…ç½®ï¼Œå°†é•œåƒå‘å¸ƒå‡ºå»ï¼Œå…¶ä»–ä½¿ç”¨è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ªé•œåƒï¼›</p><p>è¿è¡Œä¸­çš„è¿™ä¸ªé•œåƒç§°ä¸ºå®¹å™¨ï¼Œå®¹å™¨å¯åŠ¨æ˜¯éå¸¸å¿«é€Ÿçš„ã€‚</p><h2 id="2ã€æ ¸å¿ƒæ¦‚å¿µ"><a href="#2ã€æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="2ã€æ ¸å¿ƒæ¦‚å¿µ"></a>2ã€æ ¸å¿ƒæ¦‚å¿µ</h2><p>dockerä¸»æœº(Host)ï¼šå®‰è£…äº†Dockerç¨‹åºçš„æœºå™¨ï¼ˆDockerç›´æ¥å®‰è£…åœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šï¼‰ï¼›</p><p>dockerå®¢æˆ·ç«¯(Client)ï¼šè¿æ¥dockerä¸»æœºè¿›è¡Œæ“ä½œï¼›</p><p>dockerä»“åº“(Registry)ï¼šç”¨æ¥ä¿å­˜å„ç§æ‰“åŒ…å¥½çš„è½¯ä»¶é•œåƒï¼›</p><p>dockeré•œåƒ(Images)ï¼šè½¯ä»¶æ‰“åŒ…å¥½çš„é•œåƒï¼›æ”¾åœ¨dockerä»“åº“ä¸­ï¼›</p><p>dockerå®¹å™¨(Container)ï¼šé•œåƒå¯åŠ¨åçš„å®ä¾‹ç§°ä¸ºä¸€ä¸ªå®¹å™¨ï¼›å®¹å™¨æ˜¯ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨</p><p>ä½¿ç”¨Dockerçš„æ­¥éª¤ï¼š</p><p>1ï¼‰ã€å®‰è£…Docker</p><p>2ï¼‰ã€å»Dockerä»“åº“æ‰¾åˆ°è¿™ä¸ªè½¯ä»¶å¯¹åº”çš„é•œåƒï¼›</p><p>3ï¼‰ã€ä½¿ç”¨Dockerè¿è¡Œè¿™ä¸ªé•œåƒï¼Œè¿™ä¸ªé•œåƒå°±ä¼šç”Ÿæˆä¸€ä¸ªDockerå®¹å™¨ï¼›</p><p>4ï¼‰ã€å¯¹å®¹å™¨çš„å¯åŠ¨åœæ­¢å°±æ˜¯å¯¹è½¯ä»¶çš„å¯åŠ¨åœæ­¢ï¼›</p><h2 id="3ã€å®‰è£…Docker"><a href="#3ã€å®‰è£…Docker" class="headerlink" title="3ã€å®‰è£…Docker"></a>3ã€å®‰è£…Docker</h2><h4 id="1ï¼‰ã€å®‰è£…linuxè™šæ‹Ÿæœº"><a href="#1ï¼‰ã€å®‰è£…linuxè™šæ‹Ÿæœº" class="headerlink" title="1ï¼‰ã€å®‰è£…linuxè™šæ‹Ÿæœº"></a>1ï¼‰ã€å®‰è£…linuxè™šæ‹Ÿæœº</h4><p> 1ï¼‰ã€VMWareã€VirtualBoxï¼ˆå®‰è£…ï¼‰ï¼›</p><p> 2ï¼‰ã€å¯¼å…¥è™šæ‹Ÿæœºæ–‡ä»¶centos7-atguigu.ovaï¼›</p><p> 3ï¼‰ã€åŒå‡»å¯åŠ¨linuxè™šæ‹Ÿæœº;ä½¿ç”¨ root/ 123456ç™»é™†</p><p> 4ï¼‰ã€ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥linuxæœåŠ¡å™¨è¿›è¡Œå‘½ä»¤æ“ä½œï¼›</p><p> 5ï¼‰ã€è®¾ç½®è™šæ‹Ÿæœºç½‘ç»œï¼›</p><p> æ¡¥æ¥ç½‘ç»œ===é€‰å¥½ç½‘å¡====æ¥å…¥ç½‘çº¿ï¼›</p><p> 6ï¼‰ã€è®¾ç½®å¥½ç½‘ç»œä»¥åä½¿ç”¨å‘½ä»¤é‡å¯è™šæ‹Ÿæœºçš„ç½‘ç»œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHELL</span><br><span class="line">service network restart</span><br></pre></td></tr></table></figure><p> 7ï¼‰ã€æŸ¥çœ‹linuxçš„ipåœ°å€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHELL</span><br><span class="line">ip addr</span><br></pre></td></tr></table></figure><p> 8ï¼‰ã€ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥linuxï¼›</p><h4 id="2ï¼‰ã€åœ¨linuxè™šæ‹Ÿæœºä¸Šå®‰è£…docker"><a href="#2ï¼‰ã€åœ¨linuxè™šæ‹Ÿæœºä¸Šå®‰è£…docker" class="headerlink" title="2ï¼‰ã€åœ¨linuxè™šæ‹Ÿæœºä¸Šå®‰è£…docker"></a>2ï¼‰ã€åœ¨linuxè™šæ‹Ÿæœºä¸Šå®‰è£…docker</h4><p>æ­¥éª¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">SHELL</span><br><span class="line">1ã€æ£€æŸ¥å†…æ ¸ç‰ˆæœ¬ï¼Œå¿…é¡»æ˜¯3.10åŠä»¥ä¸Š</span><br><span class="line">uname -r</span><br><span class="line">2ã€å®‰è£…docker</span><br><span class="line">yum install docker</span><br><span class="line">3ã€è¾“å…¥yç¡®è®¤å®‰è£…</span><br><span class="line">4ã€å¯åŠ¨docker</span><br><span class="line">[root@localhost ~]# systemctl start docker</span><br><span class="line">[root@localhost ~]# docker -v</span><br><span class="line">Docker version 1.12.6, build 3e8e77d&#x2F;1.12.6</span><br><span class="line">5ã€å¼€æœºå¯åŠ¨docker</span><br><span class="line">[root@localhost ~]# systemctl enable docker</span><br><span class="line">Created symlink from &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;multi-user.target.wants&#x2F;docker.service to &#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;docker.service.</span><br><span class="line">6ã€åœæ­¢docker</span><br><span class="line">systemctl stop docker</span><br></pre></td></tr></table></figure><h2 id="4ã€Dockerå¸¸ç”¨å‘½ä»¤-amp-æ“ä½œ"><a href="#4ã€Dockerå¸¸ç”¨å‘½ä»¤-amp-æ“ä½œ" class="headerlink" title="4ã€Dockerå¸¸ç”¨å‘½ä»¤&amp;æ“ä½œ"></a>4ã€Dockerå¸¸ç”¨å‘½ä»¤&amp;æ“ä½œ</h2><h3 id="1ï¼‰ã€é•œåƒæ“ä½œ"><a href="#1ï¼‰ã€é•œåƒæ“ä½œ" class="headerlink" title="1ï¼‰ã€é•œåƒæ“ä½œ"></a>1ï¼‰ã€é•œåƒæ“ä½œ</h3><table><thead><tr><th>æ“ä½œ</th><th>å‘½ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æ£€ç´¢</td><td>docker search å…³é”®å­— egï¼šdocker search redis</td><td>æˆ‘ä»¬ç»å¸¸å»docker hubä¸Šæ£€ç´¢é•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚é•œåƒçš„TAGã€‚</td></tr><tr><td>æ‹‰å–</td><td>docker pull é•œåƒå:tag</td><td>:tagæ˜¯å¯é€‰çš„ï¼Œtagè¡¨ç¤ºæ ‡ç­¾ï¼Œå¤šä¸ºè½¯ä»¶çš„ç‰ˆæœ¬ï¼Œé»˜è®¤æ˜¯latest</td></tr><tr><td>åˆ—è¡¨</td><td>docker images</td><td>æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°é•œåƒ</td></tr><tr><td>åˆ é™¤</td><td>docker rmi image-id</td><td>åˆ é™¤æŒ‡å®šçš„æœ¬åœ°é•œåƒ</td></tr></tbody></table><p><a href="https://hub.docker.com/">https://hub.docker.com/</a></p><h3 id="2ï¼‰ã€å®¹å™¨æ“ä½œ"><a href="#2ï¼‰ã€å®¹å™¨æ“ä½œ" class="headerlink" title="2ï¼‰ã€å®¹å™¨æ“ä½œ"></a>2ï¼‰ã€å®¹å™¨æ“ä½œ</h3><p>è½¯ä»¶é•œåƒï¼ˆQQå®‰è£…ç¨‹åºï¼‰â€”-è¿è¡Œé•œåƒâ€”-äº§ç”Ÿä¸€ä¸ªå®¹å™¨ï¼ˆæ­£åœ¨è¿è¡Œçš„è½¯ä»¶ï¼Œè¿è¡Œçš„QQï¼‰ï¼›</p><p>æ­¥éª¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">SHELL</span><br><span class="line">1ã€æœç´¢é•œåƒ</span><br><span class="line">[root@localhost ~]# docker search tomcat</span><br><span class="line">2ã€æ‹‰å–é•œåƒ</span><br><span class="line">[root@localhost ~]# docker pull tomcat</span><br><span class="line">3ã€æ ¹æ®é•œåƒå¯åŠ¨å®¹å™¨</span><br><span class="line">docker run --name mytomcat -d tomcat:latest</span><br><span class="line">4ã€docker ps  </span><br><span class="line">æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨</span><br><span class="line">5ã€ åœæ­¢è¿è¡Œä¸­çš„å®¹å™¨</span><br><span class="line">docker stop  å®¹å™¨çš„id</span><br><span class="line">6ã€æŸ¥çœ‹æ‰€æœ‰çš„å®¹å™¨</span><br><span class="line">docker ps -a</span><br><span class="line">7ã€å¯åŠ¨å®¹å™¨</span><br><span class="line">docker start å®¹å™¨id</span><br><span class="line">8ã€åˆ é™¤ä¸€ä¸ªå®¹å™¨</span><br><span class="line"> docker rm å®¹å™¨id</span><br><span class="line">9ã€å¯åŠ¨ä¸€ä¸ªåšäº†ç«¯å£æ˜ å°„çš„tomcat</span><br><span class="line">[root@localhost ~]# docker run -d -p 8888:8080 tomcat</span><br><span class="line">-dï¼šåå°è¿è¡Œ</span><br><span class="line">-p: å°†ä¸»æœºçš„ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„ä¸€ä¸ªç«¯å£    ä¸»æœºç«¯å£:å®¹å™¨å†…éƒ¨çš„ç«¯å£</span><br><span class="line"></span><br><span class="line">10ã€ä¸ºäº†æ¼”ç¤ºç®€å•å…³é—­äº†linuxçš„é˜²ç«å¢™</span><br><span class="line">service firewalld status ï¼›æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</span><br><span class="line">service firewalld stopï¼šå…³é—­é˜²ç«å¢™</span><br><span class="line">11ã€æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿—</span><br><span class="line">docker logs container-name&#x2F;container-id</span><br><span class="line"></span><br><span class="line">æ›´å¤šå‘½ä»¤å‚çœ‹</span><br><span class="line">https:&#x2F;&#x2F;docs.docker.com&#x2F;engine&#x2F;reference&#x2F;commandline&#x2F;docker&#x2F;</span><br><span class="line">å¯ä»¥å‚è€ƒæ¯ä¸€ä¸ªé•œåƒçš„æ–‡æ¡£</span><br><span class="line">dockerå¯åŠ¨</span><br><span class="line">service docker start</span><br><span class="line">é‡å¯dockeræœåŠ¡</span><br><span class="line">service docker restart</span><br><span class="line">æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸ</span><br><span class="line">docker ps -a</span><br><span class="line">å¯åŠ¨mysqlç­‰å®¹å™¨</span><br><span class="line">docker start mysql</span><br></pre></td></tr></table></figure><h3 id="3ï¼‰ã€å®‰è£…MySQLç¤ºä¾‹"><a href="#3ï¼‰ã€å®‰è£…MySQLç¤ºä¾‹" class="headerlink" title="3ï¼‰ã€å®‰è£…MySQLç¤ºä¾‹"></a>3ï¼‰ã€å®‰è£…MySQLç¤ºä¾‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHELL</span><br><span class="line">docker pull mysql</span><br></pre></td></tr></table></figure><p>é”™è¯¯çš„å¯åŠ¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">SHELL</span><br><span class="line">[root@localhost ~]# docker run --name mysql01 -d mysql</span><br><span class="line">42f09819908bb72dd99ae19e792e0a5d03c48638421fa64cce5f8ba0f40f5846</span><br><span class="line"></span><br><span class="line">mysqlé€€å‡ºäº†</span><br><span class="line">[root@localhost ~]# docker ps -a</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                           PORTS               NAMES</span><br><span class="line">42f09819908b        mysql               &quot;docker-entrypoint.sh&quot;   34 seconds ago      Exited (1) 33 seconds ago                            mysql01</span><br><span class="line">538bde63e500        tomcat              &quot;catalina.sh run&quot;        About an hour ago   Exited (143) About an hour ago                       compassionate_</span><br><span class="line">goldstine</span><br><span class="line">c4f1ac60b3fc        tomcat              &quot;catalina.sh run&quot;        About an hour ago   Exited (143) About an hour ago                       lonely_fermi</span><br><span class="line">81ec743a5271        tomcat              &quot;catalina.sh run&quot;        About an hour ago   Exited (143) About an hour ago                       sick_ramanujan</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;é”™è¯¯æ—¥å¿—</span><br><span class="line">[root@localhost ~]# docker logs 42f09819908b</span><br><span class="line">error: database is uninitialized and password option is not specified </span><br><span class="line">  You need to specify one of MYSQL_ROOT_PASSWORD, MYSQL_ALLOW_EMPTY_PASSWORD and MYSQL_RANDOM_ROOT_PASSWORDï¼›è¿™ä¸ªä¸‰ä¸ªå‚æ•°å¿…é¡»æŒ‡å®šä¸€ä¸ª</span><br></pre></td></tr></table></figure><p>æ­£ç¡®çš„å¯åŠ¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SHELL</span><br><span class="line">[root@localhost ~]# docker run --name mysql01 -e MYSQL_ROOT_PASSWORD&#x3D;123456 -d mysql</span><br><span class="line">b874c56bec49fb43024b3805ab51e9097da779f2f572c22c695305dedd684c5f</span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES</span><br><span class="line">b874c56bec49        mysql               &quot;docker-entrypoint.sh&quot;   4 seconds ago       Up 3 seconds        3306&#x2F;tcp            mysql01</span><br></pre></td></tr></table></figure><p>åšäº†ç«¯å£æ˜ å°„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SHELL</span><br><span class="line">[root@localhost ~]# docker run -p 3306:3306 --name mysql02 -e MYSQL_ROOT_PASSWORD&#x3D;123456 -d mysql</span><br><span class="line">ad10e4bc5c6a0f61cbad43898de71d366117d120e39db651844c0e73863b9434</span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES</span><br><span class="line">ad10e4bc5c6a        mysql               &quot;docker-entrypoint.sh&quot;   4 seconds ago       Up 2 seconds        0.0.0.0:3306-&gt;3306&#x2F;tcp   mysql02</span><br></pre></td></tr></table></figure><p>å‡ ä¸ªå…¶ä»–çš„é«˜çº§æ“ä½œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CODE</span><br><span class="line">docker run --name mysql03 -v &#x2F;conf&#x2F;mysql:&#x2F;etc&#x2F;mysql&#x2F;conf.d -e MYSQL_ROOT_PASSWORD&#x3D;my-secret-pw -d mysql:tag</span><br><span class="line">æŠŠä¸»æœºçš„&#x2F;conf&#x2F;mysqlæ–‡ä»¶å¤¹æŒ‚è½½åˆ° mysqldockerå®¹å™¨çš„&#x2F;etc&#x2F;mysql&#x2F;conf.dæ–‡ä»¶å¤¹é‡Œé¢</span><br><span class="line">æ”¹mysqlçš„é…ç½®æ–‡ä»¶å°±åªéœ€è¦æŠŠmysqlé…ç½®æ–‡ä»¶æ”¾åœ¨è‡ªå®šä¹‰çš„æ–‡ä»¶å¤¹ä¸‹ï¼ˆ&#x2F;conf&#x2F;mysqlï¼‰</span><br><span class="line"></span><br><span class="line">docker run --name some-mysql -e MYSQL_ROOT_PASSWORD&#x3D;my-secret-pw -d mysql:tag --character-set-server&#x3D;utf8mb4 --collation-server&#x3D;utf8mb4_unicode_ci</span><br><span class="line">æŒ‡å®šmysqlçš„ä¸€äº›é…ç½®å‚æ•°</span><br></pre></td></tr></table></figure><hr><h2 id="æ’é”™"><a href="#æ’é”™" class="headerlink" title="æ’é”™"></a>æ’é”™</h2><p>ç”¨dockerå®‰è£…nginxçš„æ—¶å€™æŠ¥äº†å¦‚ä¸‹é”™è¯¯ï¼š<br>å°è¯•äº†å¸è½½dockeré‡è£…ï¼Œåˆ é™¤nginxï¼Œåˆ é™¤nginxé•œåƒæ–‡ä»¶éƒ½æ²¡æœ‰ç”¨ï¼Œæœ€åå‘ç°è¿˜æ˜¯Linuxå’Œdockerç‰ˆæœ¬å…¼å®¹é—®é¢˜ã€‚</p><p>1ã€æŸ¥çœ‹ä½ å½“å‰çš„å†…æ ¸ç‰ˆæœ¬</p><p>uname -r<br>1<br>2ã€æ›´æ–°yumåŒ…</p><p>sudo yum update<br>1<br>3ã€å¸è½½å·²å®‰è£…çš„dockerï¼ˆå¦‚æœå®‰è£…è¿‡çš„è¯ï¼‰</p><p>yum remove docker docker-common docker-selinux docker-engine<br>1<br>4ã€å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…</p><p>sudo yum install -y yum-utils device-mapper-persistent-data lvm2<br>1<br>5ã€è®¾ç½®yumæº</p><p>sudo yum-config-manager â€“add-repo <a href="https://download.docker.com/linux/centos/docker-ce.repo">https://download.docker.com/linux/centos/docker-ce.repo</a><br>1<br>6ã€å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ä»“åº“ä¸­æ‰€æœ‰dockerç‰ˆæœ¬ï¼Œå¹¶é€‰æ‹©ç‰¹å®šç‰ˆæœ¬å®‰è£…</p><p>yum list docker-ce â€“showduplicates | sort -r<br>1<br>7ã€é‡æ–°å®‰è£…docker</p><p>sudo yum install docker-ce<br>1<br>8ã€å¯åŠ¨docker</p><p>sudo systemctl start docker<br>1<br>9ã€éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ</p><p>docker virsion //æŸ¥çœ‹dockerçš„ç‰ˆæœ¬<br>docker ps //æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨<br>1<br>2<br>10ã€åˆ é™¤åŸæœ¬è£…å¥½çš„nginxå®¹å™¨ï¼ˆå¦‚æœå®‰è£…è¿‡ï¼‰</p><p>docker rm nginx(å®¹å™¨åå­—æˆ–è€…id)<br>1<br>11ã€åˆ é™¤nginxé•œåƒæ–‡ä»¶</p><p>docker images //æŸ¥çœ‹é•œåƒæ–‡ä»¶<br>docker rmi nginx //åˆ é™¤nginxé•œåƒ<br>docker rmi -f nginx å¼ºåˆ¶åˆ é™¤nginxé•œåƒ<br>1<br>2<br>3<br>12ã€é‡è£…å¹¶å¯åŠ¨nginx</p><p>docker run â€“name nginx -d -p 80:80 nginx<br>1<br>13ã€å®‰è£…æˆåŠŸï¼Œæµ‹è¯•æˆåŠŸ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;1ã€ç®€ä»‹&quot;&gt;&lt;a href=&quot;#1ã€ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;1ã€ç®€ä»‹&quot;&gt;&lt;/a&gt;1ã€ç®€ä»‹&lt;/h2&gt;&lt;p&gt;Dockeræ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼›æ˜¯ä¸€ä¸ªè½»é‡çº§å®¹å™¨æŠ€æœ¯ï¼›&lt;/p&gt;
&lt;p&gt;Dockeræ”¯æŒå°†è½¯ä»¶ç¼–è¯‘æˆä¸€ä¸ªé•œåƒï¼›ç„¶ååœ¨é•œåƒ</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ElasticSearchåŸºæœ¬æ“ä½œ</title>
    <link href="http://example.com/2021/04/15/ElasticSearch%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
    <id>http://example.com/2021/04/15/ElasticSearch%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</id>
    <published>2021-04-15T14:33:54.000Z</published>
    <updated>2021-04-16T14:07:33.238Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ElasticSearchåŸºæœ¬æ“ä½œ"><a href="#ElasticSearchåŸºæœ¬æ“ä½œ" class="headerlink" title="ElasticSearchåŸºæœ¬æ“ä½œ"></a>ElasticSearchåŸºæœ¬æ“ä½œ</h1><hr><h2 id="ä¸€ã€åŸºæœ¬ä»‹ç»"><a href="#ä¸€ã€åŸºæœ¬ä»‹ç»" class="headerlink" title="ä¸€ã€åŸºæœ¬ä»‹ç»"></a>ä¸€ã€åŸºæœ¬ä»‹ç»</h2><h3 id="1-1ã€ESæ ¸å¿ƒæ¦‚å¿µä»‹ç»"><a href="#1-1ã€ESæ ¸å¿ƒæ¦‚å¿µä»‹ç»" class="headerlink" title="1.1ã€ESæ ¸å¿ƒæ¦‚å¿µä»‹ç»"></a>1.1ã€ESæ ¸å¿ƒæ¦‚å¿µä»‹ç»</h3><p>åˆå­¦è€…å»ºè®®æŠŠeså½“åšæ•°æ®åº“å­¦ä¹ ï¼Œesä¸­ä¸»è¦æœ‰ç´¢å¼•ï¼Œç±»å‹ï¼Œæ–‡æ¡£ï¼Œå±æ€§çš„æ¦‚å¿µï¼Œå¯¹åº”æ•°æ®åº“å¦‚ä¸‹ï¼š</p><table><thead><tr><th>DB</th><th>Elasticsearch</th></tr></thead><tbody><tr><td>æ•°æ®åº“(database)</td><td>ç´¢å¼•(indices)</td></tr><tr><td>è¡¨(tables)</td><td>ç±»å‹(types)</td></tr><tr><td>è¡Œ(rows)</td><td>æ–‡æ¡£(documents)</td></tr><tr><td>å­—æ®µ(columns)</td><td>å±æ€§(fields)</td></tr></tbody></table><h3 id="1-2ã€åˆ†è¯å™¨ä»‹ç»"><a href="#1-2ã€åˆ†è¯å™¨ä»‹ç»" class="headerlink" title="1.2ã€åˆ†è¯å™¨ä»‹ç»"></a>1.2ã€åˆ†è¯å™¨ä»‹ç»</h3><p>ElasticSeaché»˜è®¤åˆ†è¯å™¨ï¼škeyword(ç²¾ç¡®)ï¼Œstandard(æ‹†åˆ†)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET _analyze</span><br><span class="line">&#123;</span><br><span class="line">&quot;analyzer&quot;: &quot;keyword&quot;,</span><br><span class="line">&quot;text&quot;: &quot;æˆ‘æ˜¯ä¸­å›½äºº&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GET _analyze</span><br><span class="line">&#123;</span><br><span class="line">&quot;analyzer&quot;: &quot;standard&quot;,</span><br><span class="line">&quot;text&quot;: &quot;æˆ‘æ˜¯ä¸­å›½äºº&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ikåˆ†è¯å™¨(éœ€è¦å¼•å…¥æ’ä»¶)ï¼šik_smart (ç²—ç²’åº¦)å’Œ ik_max_word(ç»†ç²’åº¦)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET _analyze</span><br><span class="line">&#123;</span><br><span class="line">&quot;analyzer&quot;: &quot;ik_smart&quot;,</span><br><span class="line">&quot;text&quot;: &quot;æˆ‘æ˜¯ä¸­å›½äºº&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GET _analyze</span><br><span class="line">&#123;</span><br><span class="line">&quot;analyzer&quot;: &quot;ik_max_word&quot;,</span><br><span class="line">&quot;text&quot;: &quot;æˆ‘æ˜¯ä¸­å›½äºº&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å»ºè®®ï¼šç´¢å¼•æ—¶ç”¨ik_max_wordå°½å¯èƒ½å¤šçš„åˆ†è¯ï¼Œè€Œæœç´¢æ—¶ç”¨ik_smartå°½å¯èƒ½æé«˜åŒ¹é…å‡†åº¦</strong></p><p><strong>æ‰©å±•ï¼šè‡ªå®šä¹‰åˆ†è¯å™¨è¯å…¸</strong></p><p>**åœ¨ikåˆ†è¯å™¨configç›®å½•ä¸‹æ·»åŠ è‡ªå®šä¹‰è¯å…¸ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ IKAnalyzer.cfg.xml **</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ --&gt;</span><br><span class="line">&lt;entry key&#x3D;&quot;ext_dict&quot;&gt;yu.dic&lt;&#x2F;entry&gt;</span><br></pre></td></tr></table></figure><h3 id="1-3ã€Resté£æ ¼ä»‹ç»"><a href="#1-3ã€Resté£æ ¼ä»‹ç»" class="headerlink" title="1.3ã€Resté£æ ¼ä»‹ç»"></a>1.3ã€Resté£æ ¼ä»‹ç»</h3><p>ESæ¨èç”¨æˆ·ä½¿ç”¨Restfulé£æ ¼</p><p>åŸºæœ¬Restå‘½ä»¤è¯´æ˜ï¼š</p><table><thead><tr><th>method</th><th>urlåœ°å€</th><th>æè¿°</th></tr></thead><tbody><tr><td>PUT</td><td>localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id</td><td>åˆ›å»ºæ–‡æ¡£ï¼ˆæŒ‡å®šæ–‡æ¡£idï¼‰</td></tr><tr><td>POST</td><td>localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°</td><td>åˆ›å»ºæ–‡æ¡£ï¼ˆéšæœºæ–‡æ¡£idï¼‰</td></tr><tr><td>POST</td><td>localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id/_update</td><td>ä¿®æ”¹æ–‡æ¡£</td></tr><tr><td>DELETE</td><td>localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id</td><td>åˆ é™¤æ–‡æ¡£</td></tr><tr><td>GET</td><td>localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id</td><td>æŸ¥è¯¢æ–‡æ¡£é€šè¿‡æ–‡æ¡£id</td></tr><tr><td>POST</td><td>localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/_search</td><td>æŸ¥è¯¢æ‰€æœ‰æ•°æ®</td></tr></tbody></table><hr><h2 id="äºŒã€ç´¢å¼•æ“ä½œ"><a href="#äºŒã€ç´¢å¼•æ“ä½œ" class="headerlink" title="äºŒã€ç´¢å¼•æ“ä½œ"></a>äºŒã€ç´¢å¼•æ“ä½œ</h2><h3 id="2-1ã€åˆ›å»ºç´¢å¼•"><a href="#2-1ã€åˆ›å»ºç´¢å¼•" class="headerlink" title="2.1ã€åˆ›å»ºç´¢å¼•"></a>2.1ã€åˆ›å»ºç´¢å¼•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PUT test</span><br></pre></td></tr></table></figure><h3 id="2-2ã€åˆ›å»ºæŒ‡å®šç±»å‹ç´¢å¼•"><a href="#2-2ã€åˆ›å»ºæŒ‡å®šç±»å‹ç´¢å¼•" class="headerlink" title="2.2ã€åˆ›å»ºæŒ‡å®šç±»å‹ç´¢å¼•"></a>2.2ã€åˆ›å»ºæŒ‡å®šç±»å‹ç´¢å¼•</h3><p>esçš„åŸºæœ¬ç±»å‹æœ‰ï¼š</p><ul><li>å­—ç¬¦ä¸²ç±»å‹<br>text ã€ keyword</li><li>æ•°å€¼ç±»å‹<br>long, integer, short, byte, double, float, half_float, scaled_float</li><li>æ—¥æœŸç±»å‹<br>date</li><li>å¸ƒå°”å€¼ç±»å‹<br>boolean</li><li>äºŒè¿›åˆ¶ç±»å‹<br>binary  </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PUT test2</span><br><span class="line">&#123;</span><br><span class="line">  &quot;mappings&quot;: &#123;</span><br><span class="line">    &quot;properties&quot;: &#123;</span><br><span class="line">      &quot;name&quot;:&#123;</span><br><span class="line">        &quot;type&quot;: &quot;text&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;age&quot;:&#123;</span><br><span class="line">        &quot;type&quot;: &quot;long&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;birthday&quot;:&#123;</span><br><span class="line">        &quot;type&quot;: &quot;date&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-3ã€æŸ¥è¯¢ç´¢å¼•"><a href="#2-3ã€æŸ¥è¯¢ç´¢å¼•" class="headerlink" title="2.3ã€æŸ¥è¯¢ç´¢å¼•"></a>2.3ã€æŸ¥è¯¢ç´¢å¼•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET test</span><br></pre></td></tr></table></figure><h3 id="2-4ã€åˆ é™¤ç´¢å¼•"><a href="#2-4ã€åˆ é™¤ç´¢å¼•" class="headerlink" title="2.4ã€åˆ é™¤ç´¢å¼•"></a>2.4ã€åˆ é™¤ç´¢å¼•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE test</span><br></pre></td></tr></table></figure><hr><h2 id="ä¸‰ã€æ–‡æ¡£æ“ä½œ"><a href="#ä¸‰ã€æ–‡æ¡£æ“ä½œ" class="headerlink" title="ä¸‰ã€æ–‡æ¡£æ“ä½œ"></a>ä¸‰ã€æ–‡æ¡£æ“ä½œ</h2><h3 id="3-1ã€åˆ›å»ºæ–‡æ¡£"><a href="#3-1ã€åˆ›å»ºæ–‡æ¡£" class="headerlink" title="3.1ã€åˆ›å»ºæ–‡æ¡£"></a>3.1ã€åˆ›å»ºæ–‡æ¡£</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">POST yu&#x2F;user&#x2F;1</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;:&quot;å°å¼ &quot;,</span><br><span class="line">  &quot;age&quot;:3,</span><br><span class="line">  &quot;tags&quot;:[&quot;æŠ€æœ¯å®…&quot;,&quot;æ—…æ¸¸&quot;,&quot;å¸…&quot;]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">POST yu&#x2F;user&#x2F;2</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;:&quot;å¼ ä¸‰&quot;,</span><br><span class="line">  &quot;age&quot;:20,</span><br><span class="line">  &quot;tags&quot;:[&quot;æŠ€æœ¯å®…&quot;,&quot;æ—…æ¸¸&quot;,&quot;å¸…&quot;]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">POST yu&#x2F;user&#x2F;3</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;:&quot;æå››&quot;,</span><br><span class="line">  &quot;age&quot;:30,</span><br><span class="line">  &quot;tags&quot;:[&quot;æŠ€æœ¯å®…&quot;,&quot;æ—…æ¸¸&quot;,&quot;å”±æ­Œ&quot;]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">POST yu&#x2F;user&#x2F;4</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;:&quot;ç‹äº”&quot;,</span><br><span class="line">  &quot;age&quot;:40,</span><br><span class="line">  &quot;tags&quot;:[&quot;æŠ€æœ¯å®…&quot;,&quot;æ—…æ¸¸&quot;,&quot;è·³èˆ&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2ã€æŸ¥è¯¢æ–‡æ¡£"><a href="#3-2ã€æŸ¥è¯¢æ–‡æ¡£" class="headerlink" title="3.2ã€æŸ¥è¯¢æ–‡æ¡£"></a>3.2ã€æŸ¥è¯¢æ–‡æ¡£</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET yu&#x2F;user&#x2F;1</span><br></pre></td></tr></table></figure><h3 id="3-3ã€ä¿®æ”¹æ–‡æ¡£"><a href="#3-3ã€ä¿®æ”¹æ–‡æ¡£" class="headerlink" title="3.3ã€ä¿®æ”¹æ–‡æ¡£"></a>3.3ã€ä¿®æ”¹æ–‡æ¡£</h3><p>ä¿®æ”¹ä¸€å·ç”¨æˆ·å¹´é¾„ä¸º5å²</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#PUTä¿®æ”¹</span><br><span class="line">PUT yu&#x2F;user&#x2F;1</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;:&quot;å°å¼ &quot;,</span><br><span class="line">  &quot;age&quot;:5,</span><br><span class="line">  &quot;tags&quot;:[&quot;æŠ€æœ¯å®…&quot;,&quot;æ—…æ¸¸&quot;,&quot;å¸…&quot;]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#POSTä¿®æ”¹</span><br><span class="line">POST yu&#x2F;user&#x2F;1&#x2F;_update</span><br><span class="line">&#123;</span><br><span class="line">  &quot;doc&quot;:&#123;</span><br><span class="line">    &quot;age&quot;:5</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>PUTä¿®æ”¹å’ŒPOSTä¿®æ”¹åŒºåˆ«ï¼šPUTä¼šå°†jsonæ•°æ®éƒ½è¿›è¡Œæ›¿æ¢, è€ŒPOSTåªä¼šæ›´æ–°ä¿®æ”¹å­—æ®µçš„å€¼ï¼ŒPOSTæ›´åŠ çµæ´»ï¼Œä¸€èˆ¬æ¨èPOST</strong></p><h3 id="3-4ã€åˆ é™¤æ–‡æ¡£"><a href="#3-4ã€åˆ é™¤æ–‡æ¡£" class="headerlink" title="3.4ã€åˆ é™¤æ–‡æ¡£"></a>3.4ã€åˆ é™¤æ–‡æ¡£</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE yu&#x2F;user&#x2F;1</span><br></pre></td></tr></table></figure><hr><p>**æ‰©å±•ï¼š é€šè¿‡GET _cat/ å¯ä»¥è·å¾—esçš„å½“å‰çš„å¾ˆå¤šä¿¡æ¯ï¼ é€šè¿‡GET _cat/indiceså‘½ä»¤ æŸ¥çœ‹elasticsearch ç´¢å¼•æƒ…å†µï¼  **</p><hr><h3 id="3-5ã€å¤æ‚æŸ¥è¯¢-é‡ç‚¹"><a href="#3-5ã€å¤æ‚æŸ¥è¯¢-é‡ç‚¹" class="headerlink" title="3.5ã€å¤æ‚æŸ¥è¯¢(é‡ç‚¹)"></a>3.5ã€å¤æ‚æŸ¥è¯¢(é‡ç‚¹)</h3><h4 id="3-5-1-ã€æ¡ä»¶åŒ¹é…æŸ¥è¯¢"><a href="#3-5-1-ã€æ¡ä»¶åŒ¹é…æŸ¥è¯¢" class="headerlink" title="3.5.1 ã€æ¡ä»¶åŒ¹é…æŸ¥è¯¢"></a>3.5.1 ã€æ¡ä»¶åŒ¹é…æŸ¥è¯¢</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">GET yu&#x2F;user&#x2F;_search?q&#x3D;name:å¼ ä¸‰</span><br><span class="line"></span><br><span class="line">#æŸ¥è¯¢ä¸€ä¸ªæ¡ä»¶ä¸€ä¸ªå€¼å»åŒ¹é…</span><br><span class="line">GET yu&#x2F;user&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;å¼ ä¸‰&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#æŸ¥è¯¢ä¸€ä¸ªæ¡ä»¶å¤šä¸ªå€¼å»åŒ¹é…</span><br><span class="line">GET yu&#x2F;user&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;å¼ ä¸‰ æå››&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-5-2ã€è‡ªå®šä¹‰æŸ¥è¯¢è¾“å‡ºç»“æœ"><a href="#3-5-2ã€è‡ªå®šä¹‰æŸ¥è¯¢è¾“å‡ºç»“æœ" class="headerlink" title="3.5.2ã€è‡ªå®šä¹‰æŸ¥è¯¢è¾“å‡ºç»“æœ"></a>3.5.2ã€è‡ªå®šä¹‰æŸ¥è¯¢è¾“å‡ºç»“æœ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET yu&#x2F;user&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;å¼ ä¸‰&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;_source&quot;: [&quot;name&quot;, &quot;age&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-5-3ã€æ’åº"><a href="#3-5-3ã€æ’åº" class="headerlink" title="3.5.3ã€æ’åº"></a>3.5.3ã€æ’åº</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">GET yu&#x2F;user&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;å¼ ä¸‰&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;_source&quot;: [&quot;name&quot;, &quot;age&quot;],</span><br><span class="line">  &quot;sort&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;age&quot;: &#123;</span><br><span class="line">        &quot;order&quot;: &quot;asc&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-5-4ã€åˆ†é¡µ"><a href="#3-5-4ã€åˆ†é¡µ" class="headerlink" title="3.5.4ã€åˆ†é¡µ"></a>3.5.4ã€åˆ†é¡µ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GET yu&#x2F;user&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;å¼ ä¸‰&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;_source&quot;: [&quot;name&quot;, &quot;age&quot;],</span><br><span class="line">  &quot;sort&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;age&quot;: &#123;</span><br><span class="line">        &quot;order&quot;: &quot;asc&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  &quot;from&quot;: 0,</span><br><span class="line">  &quot;size&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-5-4ã€å¤šæ¡ä»¶åŒ¹é…æŸ¥è¯¢"><a href="#3-5-4ã€å¤šæ¡ä»¶åŒ¹é…æŸ¥è¯¢" class="headerlink" title="3.5.4ã€å¤šæ¡ä»¶åŒ¹é…æŸ¥è¯¢"></a>3.5.4ã€å¤šæ¡ä»¶åŒ¹é…æŸ¥è¯¢</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">#andæŸ¥è¯¢ï¼Œmustç›¸å½“äºand</span><br><span class="line">GET yu&#x2F;user&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;bool&quot;: &#123;</span><br><span class="line">      &quot;must&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;match&quot;: &#123;</span><br><span class="line">            &quot;name&quot;: &quot;å¼ ä¸‰&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;match&quot;: &#123;</span><br><span class="line">            &quot;age&quot;: 5</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#oræŸ¥è¯¢ï¼Œshouldç›¸å½“äºor</span><br><span class="line">GET yu&#x2F;user&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;bool&quot;: &#123;</span><br><span class="line">      &quot;should&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;match&quot;: &#123;</span><br><span class="line">            &quot;name&quot;: &quot;å¼ ä¸‰&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;match&quot;: &#123;</span><br><span class="line">            &quot;age&quot;: 30</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#notæŸ¥è¯¢ï¼Œmust_notç›¸å½“äºnot</span><br><span class="line">GET yu&#x2F;user&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;bool&quot;: &#123;</span><br><span class="line">      &quot;must_not&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;match&quot;: &#123;</span><br><span class="line">            &quot;age&quot;: 30</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-5-5ã€è¿‡æ»¤æŸ¥è¯¢"><a href="#3-5-5ã€è¿‡æ»¤æŸ¥è¯¢" class="headerlink" title="3.5.5ã€è¿‡æ»¤æŸ¥è¯¢"></a>3.5.5ã€è¿‡æ»¤æŸ¥è¯¢</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">GET yu&#x2F;user&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;: &#123;</span><br><span class="line">    &quot;bool&quot;: &#123;</span><br><span class="line">      &quot;must&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;match&quot;: &#123;</span><br><span class="line">            &quot;name&quot;: &quot;å¼ ä¸‰&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      &quot;filter&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;range&quot;: &#123;</span><br><span class="line">            &quot;age&quot;: &#123;</span><br><span class="line">              &quot;gte&quot;: 10,</span><br><span class="line">              &quot;lte&quot;: 20</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-5-6ã€ç²¾ç¡®æŸ¥è¯¢-term"><a href="#3-5-6ã€ç²¾ç¡®æŸ¥è¯¢-term" class="headerlink" title="3.5.6ã€ç²¾ç¡®æŸ¥è¯¢(term)"></a>3.5.6ã€ç²¾ç¡®æŸ¥è¯¢(term)</h4><p><strong>term æŸ¥è¯¢æ˜¯ç›´æ¥é€šè¿‡å€’æ’ç´¢å¼•æŒ‡å®šçš„è¯æ¡è¿›ç¨‹ç²¾ç¡®æŸ¥æ‰¾çš„  !</strong></p><p><strong>textç±»å‹ä¼šè¢«æ‹†åˆ†ï¼Œè€Œkeywordç±»å‹ä¸ä¼š</strong></p><p> å‡†å¤‡æ•°æ®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#åˆ›å»ºç´¢å¼•</span><br><span class="line">PUT termdb</span><br><span class="line">&#123;</span><br><span class="line">  &quot;mappings&quot;: &#123;</span><br><span class="line">    &quot;properties&quot;: &#123;</span><br><span class="line">      &quot;name&quot;:&#123;</span><br><span class="line">        &quot;type&quot;:&quot;keyword&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;birth&quot;:&#123;</span><br><span class="line">        &quot;type&quot;: &quot;text&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#åˆ›å»ºæ–‡æ¡£</span><br><span class="line">PUT termdb&#x2F;_doc&#x2F;1</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;:&quot;å°å¼ &quot;,</span><br><span class="line">  &quot;birth&quot;:&quot;1997-09-14&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#åˆ›å»ºæ–‡æ¡£</span><br><span class="line">PUT termdb&#x2F;_doc&#x2F;2</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;:&quot;å¼ ä¸‰&quot;,</span><br><span class="line">  &quot;birth&quot;:&quot;1997-10-15&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#æŸ¥è¯¢keywordç±»å‹çš„ï¼šåªä¼šæŸ¥å‡ºæ¥ä¸€æ¡</span><br><span class="line">GET termdb&#x2F;_doc&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;:&#123;</span><br><span class="line">    &quot;term&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;å¼ ä¸‰&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#æŸ¥è¯¢textç±»å‹çš„ï¼šä¼šæŸ¥å‡ºæ¥å¤šæ¡</span><br><span class="line">GET termdb&#x2F;_doc&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;:&#123;</span><br><span class="line">    &quot;term&quot;: &#123;</span><br><span class="line">      &quot;birth&quot;: &quot;1997&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šå½“ç”¨termæŸ¥è¯¢ä¸€ä¸ªtextç±»å‹æ—¶ï¼Œtermæ— æ³•å¯¹å…¶ç²¾ç¡®åŒ¹é…çš„ ï¼ŒæŸ¥è¯¢æ¡ä»¶ç¼©å°(å€¼ä¸ºï¼šå¼ ä¸‰ï¼ŒæŸ¥è¯¢æ¡ä»¶ï¼šå¼ )ä¼šåˆ†è¯æŸ¥è¯¢</strong></p><h4 id="3-5-7ã€é«˜äº®æŸ¥è¯¢"><a href="#3-5-7ã€é«˜äº®æŸ¥è¯¢" class="headerlink" title="3.5.7ã€é«˜äº®æŸ¥è¯¢"></a>3.5.7ã€é«˜äº®æŸ¥è¯¢</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GET yu&#x2F;user&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;:&#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;å¼ ä¸‰&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;highlight&quot;: &#123;</span><br><span class="line">    &quot;fields&quot;: &#123;</span><br><span class="line">      &quot;name&quot;:&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šåˆ¶é«˜äº®å±æ€§</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GET yu&#x2F;user&#x2F;_search</span><br><span class="line">&#123;</span><br><span class="line">  &quot;query&quot;:&#123;</span><br><span class="line">    &quot;match&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &quot;å¼ ä¸‰&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;highlight&quot;:&#123;</span><br><span class="line">    &quot;pre_tags&quot;: &quot;&lt;p style&#x3D;&#39;color:red&#39;&gt;&quot;,</span><br><span class="line">    &quot;post_tags&quot;: &quot;&lt;&#x2F;p&gt;&quot;, </span><br><span class="line">    &quot;fields&quot;: &#123;</span><br><span class="line">      &quot;name&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="å››ã€Springbootæ•´åˆElasticSearch"><a href="#å››ã€Springbootæ•´åˆElasticSearch" class="headerlink" title="å››ã€Springbootæ•´åˆElasticSearch"></a>å››ã€Springbootæ•´åˆElasticSearch</h2><p>å¯å‚è€ƒelasticSearchå®˜ç½‘ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html">https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html</a></p><h3 id="4-1ã€æ·»åŠ ä¾èµ–"><a href="#4-1ã€æ·»åŠ ä¾èµ–" class="headerlink" title="4.1ã€æ·»åŠ ä¾èµ–"></a>4.1ã€æ·»åŠ ä¾èµ–</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure><p>è‹¥esæœ¬åœ°ç‰ˆæœ¬å’Œspringbooté»˜è®¤esç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œéœ€è¦è‡ªå®šä¹‰ç‰ˆæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">    &lt;!--è‡ªå®šä¹‰elasticSearchç‰ˆæœ¬--&gt;</span><br><span class="line">&lt;elasticsearch.version&gt;7.12.0&lt;&#x2F;elasticsearch.version&gt;</span><br><span class="line">&lt;&#x2F;properties&gt;</span><br></pre></td></tr></table></figure><h3 id="4-2ã€æ³¨å†ŒRestHighLevelClient-å¯¹è±¡"><a href="#4-2ã€æ³¨å†ŒRestHighLevelClient-å¯¹è±¡" class="headerlink" title="4.2ã€æ³¨å†ŒRestHighLevelClient å¯¹è±¡"></a>4.2ã€æ³¨å†ŒRestHighLevelClient å¯¹è±¡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Configuration</span><br><span class="line">public class ElasticSearchConfig &#123;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    public RestHighLevelClient restHighLevelClient() &#123;</span><br><span class="line">        RestHighLevelClient client &#x3D; new RestHighLevelClient(</span><br><span class="line">                RestClient.builder(new HttpHost(&quot;localhost&quot;, 9200, &quot;http&quot;)));</span><br><span class="line">        return client;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-3ã€RestHighLevelClientå¯¹è±¡æ“ä½œç´¢å¼•"><a href="#4-3ã€RestHighLevelClientå¯¹è±¡æ“ä½œç´¢å¼•" class="headerlink" title="4.3ã€RestHighLevelClientå¯¹è±¡æ“ä½œç´¢å¼•"></a>4.3ã€RestHighLevelClientå¯¹è±¡æ“ä½œç´¢å¼•</h3><p>å…ˆæ³¨å…¥RestHighLevelClientå¯¹è±¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line">RestHighLevelClient restHighLevelClient;</span><br></pre></td></tr></table></figure><h4 id="4-3-1ã€åˆ›å»ºç´¢å¼•"><a href="#4-3-1ã€åˆ›å»ºç´¢å¼•" class="headerlink" title="4.3.1ã€åˆ›å»ºç´¢å¼•"></a>4.3.1ã€åˆ›å»ºç´¢å¼•</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">void createIndices() throws IOException &#123;</span><br><span class="line">    &#x2F;&#x2F;åˆ›å»ºç´¢å¼•è¯·æ±‚</span><br><span class="line">    CreateIndexRequest createIndexRequest &#x3D; new CreateIndexRequest(&quot;java_indices&quot;);</span><br><span class="line">    &#x2F;&#x2F;å®¢æˆ·ç«¯æ‰§è¡Œè¯·æ±‚</span><br><span class="line">    CreateIndexResponse response &#x3D; restHighLevelClient.indices().create(createIndexRequest, RequestOptions.DEFAULT);</span><br><span class="line">    System.out.println(response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-3-2ã€æŸ¥è¯¢ç´¢å¼•"><a href="#4-3-2ã€æŸ¥è¯¢ç´¢å¼•" class="headerlink" title="4.3.2ã€æŸ¥è¯¢ç´¢å¼•"></a>4.3.2ã€æŸ¥è¯¢ç´¢å¼•</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;åˆ¤æ–­ç´¢å¼•æ˜¯å¦å­˜åœ¨</span><br><span class="line">@Test</span><br><span class="line">void isExistIndices() throws IOException &#123;</span><br><span class="line">    GetIndexRequest getIndexRequest &#x3D; new GetIndexRequest(&quot;java_indices&quot;);</span><br><span class="line">    boolean exists &#x3D; restHighLevelClient.indices().exists(getIndexRequest, RequestOptions.DEFAULT);</span><br><span class="line">    System.out.println(exists);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-3-3ã€åˆ é™¤ç´¢å¼•"><a href="#4-3-3ã€åˆ é™¤ç´¢å¼•" class="headerlink" title="4.3.3ã€åˆ é™¤ç´¢å¼•"></a>4.3.3ã€åˆ é™¤ç´¢å¼•</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">void deleteIndices() throws IOException &#123;</span><br><span class="line">    DeleteIndexRequest deleteIndexRequest &#x3D; new DeleteIndexRequest(&quot;java_indices&quot;);</span><br><span class="line">    AcknowledgedResponse acknowledgedResponse &#x3D; restHighLevelClient.indices().delete(deleteIndexRequest, RequestOptions.DEFAULT);</span><br><span class="line">    System.out.println(acknowledgedResponse.isAcknowledged());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="4-4ã€RestHighLevelClientå¯¹è±¡æ“ä½œæ–‡æ¡£"><a href="#4-4ã€RestHighLevelClientå¯¹è±¡æ“ä½œæ–‡æ¡£" class="headerlink" title="4.4ã€RestHighLevelClientå¯¹è±¡æ“ä½œæ–‡æ¡£"></a>4.4ã€RestHighLevelClientå¯¹è±¡æ“ä½œæ–‡æ¡£</h3><h4 id="4-4-1ã€åˆ›å»ºæ–‡æ¡£"><a href="#4-4-1ã€åˆ›å»ºæ–‡æ¡£" class="headerlink" title="4.4.1ã€åˆ›å»ºæ–‡æ¡£"></a>4.4.1ã€åˆ›å»ºæ–‡æ¡£</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">void createDocument() throws IOException &#123;</span><br><span class="line">    &#x2F;&#x2F;åˆ›å»ºè¯·æ±‚å¹¶æŒ‡å®šç´¢å¼•</span><br><span class="line">    IndexRequest request &#x3D; new IndexRequest(&quot;java_indices&quot;);</span><br><span class="line">    request.id(&quot;1&quot;); &#x2F;&#x2F; è®¾ç½®ID</span><br><span class="line">    request.timeout(&quot;1s&quot;); &#x2F;&#x2F; è®¾ç½®è¶…æ—¶æ—¶é—´</span><br><span class="line">    request.source(JSON.toJSONString(new User(&quot;å¼ ä¸‰&quot;, 20)), XContentType.JSON); &#x2F;&#x2F;è®¾ç½®æ•°æ®</span><br><span class="line">    &#x2F;&#x2F;å®¢æˆ·ç«¯å‘é€è¯·æ±‚</span><br><span class="line">    IndexResponse response &#x3D; restHighLevelClient.index(request, RequestOptions.DEFAULT);</span><br><span class="line">    System.out.println(response.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4-2ã€æŸ¥è¯¢æ–‡æ¡£"><a href="#4-4-2ã€æŸ¥è¯¢æ–‡æ¡£" class="headerlink" title="4.4.2ã€æŸ¥è¯¢æ–‡æ¡£"></a>4.4.2ã€æŸ¥è¯¢æ–‡æ¡£</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;æ ¹æ®IDè·å–æŒ‡å®šç´¢å¼•çš„æ–‡æ¡£ä¿¡æ¯ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨</span><br><span class="line">@Test</span><br><span class="line">void getDocument() throws IOException &#123;</span><br><span class="line">    GetRequest request &#x3D; new GetRequest(&quot;java_indices&quot;, &quot;1&quot;);</span><br><span class="line">    &#x2F;&#x2F;request.id(&quot;1&quot;);</span><br><span class="line">    &#x2F;&#x2F;åˆ¤æ–­æŒ‡å®šçš„ç´¢å¼•å’Œidæ˜¯å¦å­˜åœ¨</span><br><span class="line">    boolean exists &#x3D; restHighLevelClient.exists(request, RequestOptions.DEFAULT);</span><br><span class="line">    System.out.println(exists);</span><br><span class="line">    &#x2F;&#x2F;è·å–æŒ‡å®šçš„idä¿¡æ¯</span><br><span class="line">    GetResponse response &#x3D; restHighLevelClient.get(request, RequestOptions.DEFAULT);</span><br><span class="line">    System.out.println(response.getSourceAsString());</span><br><span class="line">    &#x2F;&#x2F;System.out.println(response.isExists());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4-3ã€æ›´æ–°æ–‡æ¡£"><a href="#4-4-3ã€æ›´æ–°æ–‡æ¡£" class="headerlink" title="4.4.3ã€æ›´æ–°æ–‡æ¡£"></a>4.4.3ã€æ›´æ–°æ–‡æ¡£</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;æ›´æ–°æ–‡æ¡£(Update)ï¼Œé‡æ–°æ’å…¥åŒä¸€ä¸ªidçš„æ•°æ®ä¹Ÿæ˜¯æ›´æ–°(PUTæ“ä½œ)</span><br><span class="line">@Test</span><br><span class="line">void updateDocument() throws IOException &#123;</span><br><span class="line">    UpdateRequest request &#x3D; new UpdateRequest(&quot;java_indices&quot;, &quot;1&quot;);</span><br><span class="line">    request.timeout(&quot;1s&quot;);</span><br><span class="line">    &#x2F;&#x2F;å°è£…éœ€è¦æ›´æ–°çš„æ–‡æ¡£ä¿¡æ¯</span><br><span class="line">    request.doc(JSON.toJSONString(new User(&quot;å°å¼ &quot;, 10)), XContentType.JSON);</span><br><span class="line">    UpdateResponse response &#x3D; restHighLevelClient.update(request, RequestOptions.DEFAULT);</span><br><span class="line">    System.out.println(response.getResult());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4-4ã€åˆ é™¤æ–‡æ¡£"><a href="#4-4-4ã€åˆ é™¤æ–‡æ¡£" class="headerlink" title="4.4.4ã€åˆ é™¤æ–‡æ¡£"></a>4.4.4ã€åˆ é™¤æ–‡æ¡£</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">void deleteDocument() throws IOException &#123;</span><br><span class="line">    DeleteRequest request &#x3D; new DeleteRequest(&quot;java_indices&quot;, &quot;1&quot;);</span><br><span class="line">    request.timeout(&quot;1s&quot;);</span><br><span class="line">    DeleteResponse response &#x3D; restHighLevelClient.delete(request, RequestOptions.DEFAULT);</span><br><span class="line">    System.out.println(response.getResult());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4-5ã€æ‰¹é‡æ’å…¥æ–‡æ¡£"><a href="#4-4-5ã€æ‰¹é‡æ’å…¥æ–‡æ¡£" class="headerlink" title="4.4.5ã€æ‰¹é‡æ’å…¥æ–‡æ¡£"></a>4.4.5ã€æ‰¹é‡æ’å…¥æ–‡æ¡£</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">void batchCreateDocument() throws IOException &#123;</span><br><span class="line">    &#x2F;&#x2F;åˆ›å»ºæ‰¹é‡çš„è¯·æ±‚</span><br><span class="line">    BulkRequest bulkRequest &#x3D; new BulkRequest();</span><br><span class="line">    bulkRequest.timeout(&quot;10s&quot;);</span><br><span class="line">    List&lt;User&gt; list &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">    for (int i &#x3D; 0; i &lt; 10; i++) &#123;</span><br><span class="line">        User user &#x3D; new User(&quot;å¼ ä¸‰&quot; + i, 20 + i);</span><br><span class="line">        list.add(user);</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;éå†listï¼ŒæŠŠå¤šæ¡æ•°æ®æ”¾åˆ°BulkRequestä¸­</span><br><span class="line">    for (int i &#x3D; 0; i &lt; list.size(); i++) &#123;</span><br><span class="line">        IndexRequest indexRequest &#x3D; new IndexRequest(&quot;java_indices&quot;);</span><br><span class="line">        indexRequest.id(&quot;&quot; + i);</span><br><span class="line">        indexRequest.source(JSON.toJSONString(list.get(i)), XContentType.JSON);</span><br><span class="line">        bulkRequest.add(indexRequest);</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;å®¢æˆ·ç«¯æ‰§è¡Œæ‰¹é‡æ“ä½œ</span><br><span class="line">    BulkResponse responses &#x3D; restHighLevelClient.bulk(bulkRequest, RequestOptions.DEFAULT);</span><br><span class="line">    System.out.println(responses.hasFailures()); &#x2F;&#x2F;æ˜¯å¦å¤±è´¥ï¼Œå¦‚æœfalseåˆ™è¡¨ç¤ºå…¨éƒ¨æˆåŠŸ</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4-6ã€æ–‡æ¡£å¤æ‚æŸ¥è¯¢å’Œé«˜äº®"><a href="#4-4-6ã€æ–‡æ¡£å¤æ‚æŸ¥è¯¢å’Œé«˜äº®" class="headerlink" title="4.4.6ã€æ–‡æ¡£å¤æ‚æŸ¥è¯¢å’Œé«˜äº®"></a>4.4.6ã€æ–‡æ¡£å¤æ‚æŸ¥è¯¢å’Œé«˜äº®</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">void searchDocument() throws IOException &#123;</span><br><span class="line">    &#x2F;&#x2F;åˆ›å»ºæ‰¹é‡æœç´¢è¯·æ±‚</span><br><span class="line">    SearchRequest request &#x3D; new SearchRequest(&quot;java_indices&quot;);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;æ„å»ºæœç´¢æ¡ä»¶</span><br><span class="line">    SearchSourceBuilder searchSourceBuilder &#x3D; new SearchSourceBuilder();</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;æŸ¥è¯¢æ¡ä»¶ï¼Œå¯ä»¥é€šè¿‡ QueryBuilders å·¥å…·æ¥å®ç°</span><br><span class="line">    &#x2F;&#x2F;å½“ä¸­æ–‡æŸ¥è¯¢æ—¶ï¼Œå¦‚æœä½¿ç”¨ikåˆ†è¯å™¨ä¼šæŸ¥è¯¢ä¸åˆ°æ•°æ®ï¼Œå±æ€§éœ€è¦ä½¿ç”¨xxx.keywordæ‰èƒ½æŸ¥è¯¢åˆ°æ•°æ®</span><br><span class="line">    &#x2F;&#x2F;TermQueryBuilder termQuery &#x3D; QueryBuilders.termQuery(&quot;name.keyword&quot;, &quot;å¼ ä¸‰1&quot;);&#x2F;&#x2F;ç²¾ç¡®æŸ¥è¯¢</span><br><span class="line">    MatchQueryBuilder matchQuery &#x3D; QueryBuilders.matchQuery(&quot;name&quot;, &quot;å¼ ä¸‰&quot;); &#x2F;&#x2F;æ¨¡ç³ŠæŸ¥è¯¢</span><br><span class="line">    &#x2F;&#x2F;BoolQueryBuilder boolQuery &#x3D; QueryBuilders.boolQuery().must(QueryBuilders.matchQuery(&quot;name&quot;, &quot;å¼ ä¸‰&quot;)); &#x2F;&#x2F;å¤šæ¡ä»¶æŸ¥è¯¢</span><br><span class="line"></span><br><span class="line">    searchSourceBuilder.query(matchQuery); &#x2F;&#x2F;æŸ¥è¯¢</span><br><span class="line">    searchSourceBuilder.sort(&quot;age&quot;, SortOrder.ASC); &#x2F;&#x2F;æ’åº</span><br><span class="line">    searchSourceBuilder.from(0); &#x2F;&#x2F;åˆ†é¡µèµ·å§‹</span><br><span class="line">    searchSourceBuilder.size(5); &#x2F;&#x2F;åˆ†é¡µä¸€é¡µæ˜¾ç¤ºçš„æ•°é‡</span><br><span class="line">    searchSourceBuilder.timeout(TimeValue.timeValueSeconds(1)); &#x2F;&#x2F;è®¾ç½®è¶…æ—¶æ—¶é—´</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;åˆ›å»ºé«˜äº®ç”Ÿæˆå™¨</span><br><span class="line">    HighlightBuilder highlightBuilder &#x3D; new HighlightBuilder();</span><br><span class="line">    highlightBuilder.field(&quot;name&quot;);</span><br><span class="line">    highlightBuilder.preTags(&quot;&lt;p style&#x3D;&#39;color:red&#39;&gt;&quot;);</span><br><span class="line">    highlightBuilder.postTags(&quot;&lt;&#x2F;p&gt;&quot;);</span><br><span class="line">    &#x2F;&#x2F;è®¾ç½®é«˜äº®</span><br><span class="line">    searchSourceBuilder.highlighter(highlightBuilder);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;å°†æŸ¥è¯¢æ¡ä»¶æ”¾å…¥æœç´¢è¯·æ±‚requestä¸­</span><br><span class="line">    request.source(searchSourceBuilder);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;å®¢æˆ·ç«¯æ‰§è¡Œè¯·æ±‚</span><br><span class="line">    SearchResponse response &#x3D; restHighLevelClient.search(request, RequestOptions.DEFAULT);</span><br><span class="line">    System.out.println(JSON.toJSONString(response.getHits()));</span><br><span class="line">    &#x2F;&#x2F;éå†Hits</span><br><span class="line">    for (SearchHit hit : response.getHits()) &#123;</span><br><span class="line">        System.out.println(hit.getSourceAsMap());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ElasticSearchåŸºæœ¬æ“ä½œ&quot;&gt;&lt;a href=&quot;#ElasticSearchåŸºæœ¬æ“ä½œ&quot; class=&quot;headerlink&quot; title=&quot;ElasticSearchåŸºæœ¬æ“ä½œ&quot;&gt;&lt;/a&gt;ElasticSearchåŸºæœ¬æ“ä½œ&lt;/h1&gt;&lt;hr&gt;
&lt;h2 id=&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>JSONå¯¹è±¡è½¬åŒ–</title>
    <link href="http://example.com/2021/03/10/JSON%E5%AF%B9%E8%B1%A1%E8%BD%AC%E5%8C%96/"/>
    <id>http://example.com/2021/03/10/JSON%E5%AF%B9%E8%B1%A1%E8%BD%AC%E5%8C%96/</id>
    <published>2021-03-10T14:10:23.000Z</published>
    <updated>2021-04-16T14:07:30.294Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JSONå¯¹è±¡è½¬åŒ–"><a href="#JSONå¯¹è±¡è½¬åŒ–" class="headerlink" title="JSONå¯¹è±¡è½¬åŒ–"></a>JSONå¯¹è±¡è½¬åŒ–</h1><hr><p>åœ¨JSONå¯¹è±¡è½¬åŒ–é—®é¢˜ï¼Œä¸€èˆ¬ç”¨çš„è¾ƒå¤šçš„æ˜¯Jacksonå’Œfastjson</p><h2 id="ä¸€ï¼šJacksonç®€å•ç”¨æ³•"><a href="#ä¸€ï¼šJacksonç®€å•ç”¨æ³•" class="headerlink" title="ä¸€ï¼šJacksonç®€å•ç”¨æ³•"></a>ä¸€ï¼šJacksonç®€å•ç”¨æ³•</h2><p>Jacksonä¾èµ–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.fasterxml.jackson.core&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;jackson-databind&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.12.0&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure><h3 id="1ã€å¯¹è±¡è½¬json"><a href="#1ã€å¯¹è±¡è½¬json" class="headerlink" title="1ã€å¯¹è±¡è½¬json"></a>1ã€å¯¹è±¡è½¬json</h3><p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºJacksonçš„æ ¸å¿ƒå¯¹è±¡ ObjectMapper</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ObjectMapper mapper &#x3D; new ObjectMapper();</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼šä½¿ç”¨è½¬æ¢æ–¹æ³•</p><p>å¸¸ç”¨çš„æœ‰ï¼š</p><p>1ã€writeValue(å‚æ•°ä¸€ï¼Œå‚æ•°äºŒ)ï¼›</p><p>å‚æ•°ä¸€ï¼š</p><p>ã€€ã€€(1) Fileï¼šå°†objå¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œå¹¶ä¿å­˜åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­</p><p>ã€€ã€€(2) Writerï¼šå°†objå¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œå¹¶å°†jsonæ•°æ®å¡«å……åˆ°å­—ç¬¦è¾“å‡ºæµä¸­(é€šå¸¸å¯ä»¥ä½¿ç”¨responçš„getWrite()æ–¹æ³•ï¼Œè·å–è¯¥ç±»)</p><p>ã€€ã€€(3) OutputStreamï¼šå°†objå¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œå¹¶å°†jsonæ•°æ®å¡«å……åˆ°å­—èŠ‚è¾“å‡ºæµä¸­</p><p>å‚æ•°äºŒï¼š</p><p>ã€€ã€€è¦è½¬æ¢ä¸ºJSONçš„å¯¹è±¡ã€€</p><p>2ã€**writeValueAsString(Object obj)**ï¼šå°†å¯¹è±¡è½¬ä¸ºjsonå­—ç¬¦ä¸²</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User user &#x3D; new User(&quot;å¼ ä¸‰&quot;, &quot;ç”·&quot;, &quot;2000-01-01&quot;);</span><br><span class="line">String json &#x3D; mapper.writeValueAsString(user);</span><br></pre></td></tr></table></figure><h3 id="2ã€jsonè½¬å¯¹è±¡"><a href="#2ã€jsonè½¬å¯¹è±¡" class="headerlink" title="2ã€jsonè½¬å¯¹è±¡"></a>2ã€jsonè½¬å¯¹è±¡</h3><p><strong>readValue(å‚æ•°ä¸€ï¼Œå‚æ•°äºŒ)</strong></p><p>å‚æ•°ä¸€ï¼šä»é‚£è¯»å–å¯¹è±¡</p><p>å‚æ•°äºŒï¼šè¦è½¬æ¢ä¸ºçš„å¯¹è±¡ï¼šobjectç±»å‹ã€€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ObjectMapper mapper &#x3D; new ObjectMapper();</span><br><span class="line">&#x2F;&#x2F;1.JSONå­—ç¬¦ä¸²è½¬å¯¹è±¡</span><br><span class="line">String json &#x3D; &quot;&#123;\&quot;name\&quot;:\&quot;å¼ ä¸‰\&quot;,\&quot;sex\&quot;:\&quot;ç”·\&quot;,\&quot;birthday\&quot;:\&quot;2000-01-01\&quot;&#125;&quot;;</span><br><span class="line">User user &#x3D; mapper.readValue(json, User.class);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;2.jsonå­—ç¬¦ä¸²è½¬map</span><br><span class="line">Map map &#x3D; mapper.readValue(json, Map.class);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;3.ä»fileä¸­è¯»å–è½¬å¯¹è±¡</span><br><span class="line">File file &#x3D; new File(&quot;data&#x2F;user.json&quot;);</span><br><span class="line">User user &#x3D; mapper.readValue(file, user.class);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;4.ä»URLä¸­è¯»å–è½¬å¯¹è±¡</span><br><span class="line">URL url &#x3D; new URL(&quot;file:data&#x2F;user.json&quot;);</span><br><span class="line">User user &#x3D; mapper.readValue(url, user.class);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;5.ä»InputStreamè¯»å–è½¬å¯¹è±¡</span><br><span class="line">InputStream input &#x3D; new FileInputStream(&quot;data&#x2F;user.json&quot;);</span><br><span class="line">User user &#x3D; mapper.readValue(input, user.class);</span><br></pre></td></tr></table></figure><h3 id="3ã€JackSonçš„å¸¸ç”¨æ³¨è§£"><a href="#3ã€JackSonçš„å¸¸ç”¨æ³¨è§£" class="headerlink" title="3ã€JackSonçš„å¸¸ç”¨æ³¨è§£"></a>3ã€JackSonçš„å¸¸ç”¨æ³¨è§£</h3><p>JackSonæä¾›äº†ä¸€äº›çš„æ³¨è§£ï¼Œå¯ä»¥ç”¨åœ¨ç±»ä¸Šæˆ–è€…æ˜¯åœ¨å­—æ®µä¸Šã€‚é€šå¸¸æ˜¯æ•°æ®ç»‘å®šçš„æ—¶å€™ä½¿ç”¨ã€‚ä¸‹é¢å‡ ä¸ªæ˜¯æœ€å¸¸ç”¨çš„å‡ ä¸ª</p><p><strong>@JsonInclude(JsonInclude.Include.NON_EMPTY)</strong></p><p>ä»…åœ¨å±æ€§ä¸ä¸ºç©ºæ—¶åºåˆ—åŒ–æ­¤å­—æ®µï¼Œå¯¹äºå­—ç¬¦ä¸²ï¼Œå³nullæˆ–ç©ºå­—ç¬¦ä¸²</p><p><strong>@JsonIgnore</strong></p><p>åœ¨jsonåºåˆ—åŒ–æ—¶å°†java beanä¸­çš„ä¸€äº›å±æ€§å¿½ç•¥æ‰ï¼Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–éƒ½å—å½±å“ï¼Œä¸€èˆ¬æ ‡è®°åœ¨å±æ€§æˆ–è€…æ–¹æ³•ä¸Š</p><p><strong>@JsonProperty(value = â€œuser_nameâ€)</strong></p><p>æŒ‡å®šåºåˆ—åŒ–æ—¶çš„å­—æ®µå(æŠŠå±æ€§çš„åç§°åºåˆ—åŒ–æˆå¦å¤–ä¸€ä¸ªåç§°)ï¼Œé»˜è®¤ä½¿ç”¨å±æ€§åï¼Œä¸€èˆ¬ä½œç”¨äºå±æ€§ä¸Š</p><h2 id="äºŒï¼šfastJsonç®€å•ç”¨æ³•"><a href="#äºŒï¼šfastJsonç®€å•ç”¨æ³•" class="headerlink" title="äºŒï¼šfastJsonç®€å•ç”¨æ³•"></a>äºŒï¼šfastJsonç®€å•ç”¨æ³•</h2><p>fastjsonä¾èµ–ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.alibaba&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;fastjson&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.2.75&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure><p>fastJsonæºç ä¸­å¯ä»¥å‘ç°ä¸»è¦çš„3ä¸ªç±»ï¼ŒJSON,JSONArrayï¼ŒJSONObject</p><p>ä¸‰è€…ä¹‹é—´çš„å…³ç³»æ˜¯ï¼š<strong>JSONObjectå’ŒJSONArrayç»§æ‰¿JSON</strong>ï¼Œ</p><p>JSONObjectç›¸å½“äºMapï¼ŒJSONObjectçš„æ•°æ®æ˜¯ç”¨ {  } æ¥è¡¨ç¤ºçš„</p><p>JSONArrayç›¸å½“äºListï¼Œæ˜¯ç”±JSONObjectæ„æˆçš„æ•°ç»„ï¼Œç”¨  [ { } , { } , â€¦â€¦  , { } ]  æ¥è¡¨ç¤º</p><h3 id="1ã€jsonå­—ç¬¦ä¸²ä¸å¯¹è±¡ä¹‹é—´çš„è½¬æ¢"><a href="#1ã€jsonå­—ç¬¦ä¸²ä¸å¯¹è±¡ä¹‹é—´çš„è½¬æ¢" class="headerlink" title="1ã€jsonå­—ç¬¦ä¸²ä¸å¯¹è±¡ä¹‹é—´çš„è½¬æ¢"></a>1ã€jsonå­—ç¬¦ä¸²ä¸å¯¹è±¡ä¹‹é—´çš„è½¬æ¢</h3><p>ä¸»è¦æ–¹æ³•æ˜¯ <strong>JSON.toJSONString</strong> å’Œ <strong>JSON.parseObject</strong></p><ul><li>åºåˆ—åŒ–:<br>String jsonString = JSON.toJSONString(obj);</li><li>ååºåˆ—åŒ–:<br>VO vo = JSON.parseObject(â€œjsonStringâ€, VO.class);</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;å¯¹è±¡è½¬å­—ç¬¦ä¸²</span><br><span class="line">User user &#x3D; new User(&quot;å¼ ä¸‰&quot;, &quot;ç”·&quot;, &quot;2000-01-01&quot;);</span><br><span class="line">String jsonString &#x3D; JSON.toJSONString(user);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;å­—ç¬¦ä¸²è½¬å¯¹è±¡</span><br><span class="line">User user &#x3D; JSON.parseObject(jsonString, User.class);</span><br></pre></td></tr></table></figure><h3 id="2ã€jsonæ•°ç»„å­—ç¬¦ä¸²ä¸å¯¹è±¡æ•°ç»„ä¹‹é—´çš„è½¬æ¢"><a href="#2ã€jsonæ•°ç»„å­—ç¬¦ä¸²ä¸å¯¹è±¡æ•°ç»„ä¹‹é—´çš„è½¬æ¢" class="headerlink" title="2ã€jsonæ•°ç»„å­—ç¬¦ä¸²ä¸å¯¹è±¡æ•°ç»„ä¹‹é—´çš„è½¬æ¢"></a>2ã€jsonæ•°ç»„å­—ç¬¦ä¸²ä¸å¯¹è±¡æ•°ç»„ä¹‹é—´çš„è½¬æ¢</h3><p>ä¸»è¦æ–¹æ³•æ˜¯ <strong>JSON.toJSONString</strong> å’Œ <strong>JSON.parseArray</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;åˆ›å»ºå¯¹è±¡é›†åˆ</span><br><span class="line">List&lt;User&gt; list &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">for (int i &#x3D; 1; i &lt;&#x3D; 5; i++) &#123;</span><br><span class="line">list.add(new User(&quot;å¼ ä¸‰&quot;+ i +&quot;å·&quot;, &quot;ç”·&quot;, &quot;2000-01-01&quot;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;listè½¬json</span><br><span class="line">String jsonString &#x3D; JSONObject.toJSONString(list);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;jsonæ•°ç»„å­—ç¬¦ä¸²è½¬å¯¹è±¡é›†åˆ</span><br><span class="line">List&lt;User&gt; users &#x3D; JSONObject.parseArray(jsonString, User.class);</span><br></pre></td></tr></table></figure><h3 id="3ã€è·å–jsonå­—ç¬¦ä¸²ä¸­çš„æŸä¸ªå­—æ®µ"><a href="#3ã€è·å–jsonå­—ç¬¦ä¸²ä¸­çš„æŸä¸ªå­—æ®µ" class="headerlink" title="3ã€è·å–jsonå­—ç¬¦ä¸²ä¸­çš„æŸä¸ªå­—æ®µ"></a>3ã€è·å–jsonå­—ç¬¦ä¸²ä¸­çš„æŸä¸ªå­—æ®µ</h3><p>éœ€è¦å…ˆè½¬åŒ–ä¸º <strong>JSONObject</strong> å¯¹è±¡ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;å¯¹è±¡è½¬JSONObjectå¯¹è±¡</span><br><span class="line">User user &#x3D; new User(&quot;å¼ ä¸‰&quot;, &quot;ç”·&quot;, &quot;2000-01-01&quot;);</span><br><span class="line">JSONObject jsonObject &#x3D; (JSONObject) JSON.toJSON(user);</span><br><span class="line">&#x2F;&#x2F;æˆ–è€…</span><br><span class="line">JSONObject jsonObject &#x3D; (JSONObject) JSONObject.toJSON(user);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;å­—ç¬¦ä¸²è½¬JSONObjectå¯¹è±¡</span><br><span class="line">String json &#x3D; &quot;&#123;\&quot;birthday\&quot;:\&quot;2000-01-01\&quot;,\&quot;name\&quot;:\&quot;å¼ ä¸‰\&quot;,\&quot;sex\&quot;:\&quot;ç”·\&quot;,\&quot;grade\&quot;:80&#125;&quot;;</span><br><span class="line">JSONObject jsonObject &#x3D; JSON.parseObject(json);</span><br><span class="line">&#x2F;&#x2F;æˆ–è€…</span><br><span class="line">JSONObject jsonObject &#x3D; JSONObject.parseObject(json);</span><br></pre></td></tr></table></figure><p>å†ä½¿ç”¨ <strong>JSONObject</strong> å¯¹è±¡çš„ä¸€ç³»åˆ— <strong>get</strong> æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String name &#x3D; jsonObject.getString(&quot;name&quot;);</span><br><span class="line">Integer grade &#x3D; jsonObject.getInteger(&quot;grade&quot;);</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;JSONå¯¹è±¡è½¬åŒ–&quot;&gt;&lt;a href=&quot;#JSONå¯¹è±¡è½¬åŒ–&quot; class=&quot;headerlink&quot; title=&quot;JSONå¯¹è±¡è½¬åŒ–&quot;&gt;&lt;/a&gt;JSONå¯¹è±¡è½¬åŒ–&lt;/h1&gt;&lt;hr&gt;
&lt;p&gt;åœ¨JSONå¯¹è±¡è½¬åŒ–é—®é¢˜ï¼Œä¸€èˆ¬ç”¨çš„è¾ƒå¤šçš„æ˜¯Jacksonå’Œfastjson&lt;/p&gt;
</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Markdownå¸¸ç”¨è¯­æ³•</title>
    <link href="http://example.com/2021/01/01/Markdown%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95/"/>
    <id>http://example.com/2021/01/01/Markdown%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95/</id>
    <published>2021-01-01T08:00:00.000Z</published>
    <updated>2021-01-01T08:58:43.099Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Markdownå¸¸ç”¨è¯­æ³•"><a href="#Markdownå¸¸ç”¨è¯­æ³•" class="headerlink" title="Markdownå¸¸ç”¨è¯­æ³•"></a>Markdownå¸¸ç”¨è¯­æ³•</h1><hr><h2 id="ä¸€ã€æ ‡é¢˜"><a href="#ä¸€ã€æ ‡é¢˜" class="headerlink" title="ä¸€ã€æ ‡é¢˜"></a>ä¸€ã€æ ‡é¢˜</h2><h3 id="1-ä½¿ç”¨-è¡¨ç¤ºæ ‡é¢˜ï¼Œå…¶ä¸­-å·å¿…é¡»åœ¨è¡Œé¦–ï¼Œä¸­é—´å¿…é¡»ä¸€ä¸ªç©ºæ ¼ï¼Œ-ä¸ªæ•°è¡¨ç¤ºæ˜¯å‡ çº§æ ‡é¢˜ï¼Œä¾‹å¦‚ï¼š"><a href="#1-ä½¿ç”¨-è¡¨ç¤ºæ ‡é¢˜ï¼Œå…¶ä¸­-å·å¿…é¡»åœ¨è¡Œé¦–ï¼Œä¸­é—´å¿…é¡»ä¸€ä¸ªç©ºæ ¼ï¼Œ-ä¸ªæ•°è¡¨ç¤ºæ˜¯å‡ çº§æ ‡é¢˜ï¼Œä¾‹å¦‚ï¼š" class="headerlink" title="1. ä½¿ç”¨ # è¡¨ç¤ºæ ‡é¢˜ï¼Œå…¶ä¸­ # å·å¿…é¡»åœ¨è¡Œé¦–ï¼Œä¸­é—´å¿…é¡»ä¸€ä¸ªç©ºæ ¼ï¼Œ#ä¸ªæ•°è¡¨ç¤ºæ˜¯å‡ çº§æ ‡é¢˜ï¼Œä¾‹å¦‚ï¼š"></a>1. ä½¿ç”¨ <code>#</code> è¡¨ç¤ºæ ‡é¢˜ï¼Œå…¶ä¸­ <code>#</code> å·å¿…é¡»åœ¨è¡Œé¦–ï¼Œä¸­é—´å¿…é¡»ä¸€ä¸ªç©ºæ ¼ï¼Œ<code>#</code>ä¸ªæ•°è¡¨ç¤ºæ˜¯å‡ çº§æ ‡é¢˜ï¼Œä¾‹å¦‚ï¼š</h3><h1 id="ä¸€å·æ ‡é¢˜"><a href="#ä¸€å·æ ‡é¢˜" class="headerlink" title="ä¸€å·æ ‡é¢˜"></a>ä¸€å·æ ‡é¢˜</h1><h2 id="äºŒå·æ ‡é¢˜"><a href="#äºŒå·æ ‡é¢˜" class="headerlink" title="äºŒå·æ ‡é¢˜"></a>äºŒå·æ ‡é¢˜</h2><h3 id="ä¸‰å·æ ‡é¢˜"><a href="#ä¸‰å·æ ‡é¢˜" class="headerlink" title="ä¸‰å·æ ‡é¢˜"></a>ä¸‰å·æ ‡é¢˜</h3><h4 id="å››å·æ ‡é¢˜"><a href="#å››å·æ ‡é¢˜" class="headerlink" title="å››å·æ ‡é¢˜"></a>å››å·æ ‡é¢˜</h4><h5 id="äº”å·æ ‡é¢˜"><a href="#äº”å·æ ‡é¢˜" class="headerlink" title="äº”å·æ ‡é¢˜"></a>äº”å·æ ‡é¢˜</h5><h6 id="å…­å·æ ‡é¢˜"><a href="#å…­å·æ ‡é¢˜" class="headerlink" title="å…­å·æ ‡é¢˜"></a>å…­å·æ ‡é¢˜</h6><h3 id="2-åœ¨å­—æ®µä¸‹ä¸€è¡Œè¾“å…¥-è¡¨ç¤ºä¸€çº§æ ‡é¢˜ï¼Œ-è¡¨ç¤ºäºŒçº§æ ‡é¢˜ï¼Œä¾‹å¦‚ï¼š"><a href="#2-åœ¨å­—æ®µä¸‹ä¸€è¡Œè¾“å…¥-è¡¨ç¤ºä¸€çº§æ ‡é¢˜ï¼Œ-è¡¨ç¤ºäºŒçº§æ ‡é¢˜ï¼Œä¾‹å¦‚ï¼š" class="headerlink" title="2. åœ¨å­—æ®µä¸‹ä¸€è¡Œè¾“å…¥=== è¡¨ç¤ºä¸€çº§æ ‡é¢˜ï¼Œ--- è¡¨ç¤ºäºŒçº§æ ‡é¢˜ï¼Œä¾‹å¦‚ï¼š"></a>2. åœ¨å­—æ®µä¸‹ä¸€è¡Œè¾“å…¥<code>===</code> è¡¨ç¤ºä¸€çº§æ ‡é¢˜ï¼Œ<code>---</code> è¡¨ç¤ºäºŒçº§æ ‡é¢˜ï¼Œä¾‹å¦‚ï¼š</h3><h1 id="ä¸€çº§æ ‡é¢˜"><a href="#ä¸€çº§æ ‡é¢˜" class="headerlink" title="ä¸€çº§æ ‡é¢˜"></a>ä¸€çº§æ ‡é¢˜</h1><h2 id="äºŒçº§æ ‡é¢˜"><a href="#äºŒçº§æ ‡é¢˜" class="headerlink" title="äºŒçº§æ ‡é¢˜"></a>äºŒçº§æ ‡é¢˜</h2><h3 id="æ‰©å±•ï¼šåˆ†å‰²çº¿"><a href="#æ‰©å±•ï¼šåˆ†å‰²çº¿" class="headerlink" title="æ‰©å±•ï¼šåˆ†å‰²çº¿"></a>æ‰©å±•ï¼šåˆ†å‰²çº¿</h3><p>ä½¿ç”¨ä¸‰ä¸ªæˆ–ä»¥ä¸Šçš„ <code>-</code> æˆ–è€… <code>*</code> è¡¨ç¤ºï¼Œä¸”è¿™ä¸€è¡Œåªæœ‰ç¬¦å·ï¼Œ<strong>æ³¨æ„ä¸è¦è¢«è¯†åˆ«ä¸ºäºŒçº§æ ‡é¢˜å³å¯</strong>ï¼Œä¾‹å¦‚ä¸­é—´æˆ–è€…å‰é¢å¯ä»¥åŠ ç©ºæ ¼</p><hr><hr><h2 id="äºŒã€æ–œä½“å’Œç²—ä½“"><a href="#äºŒã€æ–œä½“å’Œç²—ä½“" class="headerlink" title="äºŒã€æ–œä½“å’Œç²—ä½“"></a>äºŒã€æ–œä½“å’Œç²—ä½“</h2><p>ä½¿ç”¨ <code>*</code> å’Œ <code>**</code> åˆ†åˆ«è¡¨ç¤ºæ–œä½“å’Œç²—ä½“ï¼Œä¾‹å¦‚</p><p><em>æ–œä½“</em> <strong>ç²—ä½“</strong> <strong><em>åˆæ–œåˆç²—</em></strong></p><h4 id="æ‰©å±•ï¼šåˆ é™¤çº¿ä½¿ç”¨ä¸¤ä¸ª-è¡¨ç¤ºï¼Œä¾‹å¦‚"><a href="#æ‰©å±•ï¼šåˆ é™¤çº¿ä½¿ç”¨ä¸¤ä¸ª-è¡¨ç¤ºï¼Œä¾‹å¦‚" class="headerlink" title="æ‰©å±•ï¼šåˆ é™¤çº¿ä½¿ç”¨ä¸¤ä¸ª ~ è¡¨ç¤ºï¼Œä¾‹å¦‚"></a><strong>æ‰©å±•ï¼š</strong>åˆ é™¤çº¿ä½¿ç”¨ä¸¤ä¸ª <code>~</code> è¡¨ç¤ºï¼Œä¾‹å¦‚</h4><p><del>æˆ‘æ˜¯è¦åˆ æ‰çš„æ–‡å­—</del></p><hr><h2 id="ä¸‰ã€è¶…é“¾æ¥å’Œå›¾ç‰‡"><a href="#ä¸‰ã€è¶…é“¾æ¥å’Œå›¾ç‰‡" class="headerlink" title="ä¸‰ã€è¶…é“¾æ¥å’Œå›¾ç‰‡"></a>ä¸‰ã€è¶…é“¾æ¥å’Œå›¾ç‰‡</h2><p>è¶…é“¾æ¥å’Œå›¾ç‰‡çš„å†™æ³•ç±»ä¼¼ï¼Œå›¾ç‰‡ä»…åœ¨è¶…é“¾æ¥å‰å¤šäº†ä¸€ä¸ª <code>!</code> ï¼Œè¶…é“¾æ¥æ˜¯ [æ–‡å­—æè¿°] (é“¾æ¥)ï¼Œå›¾ç‰‡æ˜¯![æ–‡å­—æè¿°] (å›¾ç‰‡è·¯å¾„)ï¼Œå¦‚ï¼š</p><p>è¶…é“¾æ¥ï¼š<a href="www.baidu.com">ç™¾åº¦</a></p><p>å›¾ç‰‡ï¼š<img src="//www.baidu.com/img/2020dong_36ab26b0975e2a69e81f707084a9e7e8.gif"></p><hr><h2 id="å››ã€è¡Œå†…ä»£ç å—"><a href="#å››ã€è¡Œå†…ä»£ç å—" class="headerlink" title="å››ã€è¡Œå†…ä»£ç å—"></a>å››ã€è¡Œå†…ä»£ç å—</h2><p>å…¶å®ä¸Šé¢å·²ç»ç”¨è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œå³ä½¿ç”¨ ``` è¡¨ç¤ºï¼Œä¾‹å¦‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¡Œå†…ä»£ç å—</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        System.out.println( <span class="string">&quot;Hello, World!&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ³¨æ„ï¼šå¾ˆå¤šå­—ç¬¦æ˜¯éœ€è¦è½¬ä¹‰ï¼Œä½¿ç”¨åæ–œæ -è¿›è¡Œè½¬ä¹‰"><a href="#æ³¨æ„ï¼šå¾ˆå¤šå­—ç¬¦æ˜¯éœ€è¦è½¬ä¹‰ï¼Œä½¿ç”¨åæ–œæ -è¿›è¡Œè½¬ä¹‰" class="headerlink" title="æ³¨æ„ï¼šå¾ˆå¤šå­—ç¬¦æ˜¯éœ€è¦è½¬ä¹‰ï¼Œä½¿ç”¨åæ–œæ  \ è¿›è¡Œè½¬ä¹‰"></a>æ³¨æ„ï¼šå¾ˆå¤šå­—ç¬¦æ˜¯éœ€è¦è½¬ä¹‰ï¼Œä½¿ç”¨åæ–œæ  <code>\</code> è¿›è¡Œè½¬ä¹‰</h3><hr><h2 id="äº”ã€æ— åºåˆ—è¡¨"><a href="#äº”ã€æ— åºåˆ—è¡¨" class="headerlink" title="äº”ã€æ— åºåˆ—è¡¨"></a>äº”ã€æ— åºåˆ—è¡¨</h2><p>ä½¿ç”¨ <code>-</code>ã€<code>+</code> å’Œ <code>*</code> (åé¢æœ‰ä¸ªç©ºæ ¼) è¡¨ç¤ºæ— åºåˆ—è¡¨ï¼Œå‰åç•™ä¸€è¡Œç©ºç™½ï¼Œå¯åµŒå¥—ï¼Œä¾‹å¦‚</p><p>æ— åºåˆ—è¡¨</p><ul><li>ä¸€å±‚<ul><li>äºŒå±‚</li><li>äºŒå±‚<ul><li>ä¸‰å±‚<ul><li>å››å±‚</li></ul></li></ul></li></ul></li><li>ä¸€å±‚</li></ul><hr><h2 id="å…­ã€æœ‰åºåˆ—è¡¨"><a href="#å…­ã€æœ‰åºåˆ—è¡¨" class="headerlink" title="å…­ã€æœ‰åºåˆ—è¡¨"></a>å…­ã€æœ‰åºåˆ—è¡¨</h2><p>ä½¿ç”¨ <code>æ•°å­—. </code>ï¼ˆç‚¹å·åé¢æœ‰ä¸ªç©ºæ ¼ï¼‰è¡¨ç¤ºæœ‰åºåˆ—è¡¨ï¼Œå¯åµŒå¥—ï¼Œä¾‹å¦‚</p><p>æœ‰åºåˆ—è¡¨</p><ol><li>ä¸€å±‚<ol><li>äºŒå±‚</li><li>äºŒå±‚</li></ol></li><li>ä¸€å±‚</li></ol><hr><h2 id="ä¸ƒã€æ–‡å­—å¼•ç”¨"><a href="#ä¸ƒã€æ–‡å­—å¼•ç”¨" class="headerlink" title="ä¸ƒã€æ–‡å­—å¼•ç”¨"></a>ä¸ƒã€æ–‡å­—å¼•ç”¨</h2><p>ä½¿ç”¨ <code>&gt;</code> (åé¢æœ‰ä¸ªç©ºæ ¼) è¡¨ç¤ºï¼Œå¯ä»¥æœ‰å¤šä¸ª <code>&gt;</code>ï¼Œè¡¨ç¤ºå±‚çº§æ›´æ·±ï¼Œä¾‹å¦‚</p><blockquote><p>ç¬¬ä¸€å±‚</p><blockquote><p>ç¬¬äºŒå±‚ è¿™æ ·æ˜¯è·³ä¸å‡ºå»çš„</p><blockquote><p>è¿˜å¯ä»¥æ›´æ·±</p></blockquote></blockquote></blockquote><blockquote><p>è¿™æ ·å°±è·³å‡ºå»äº†</p></blockquote><hr><h2 id="å…«ã€è¡¨æ ¼"><a href="#å…«ã€è¡¨æ ¼" class="headerlink" title="å…«ã€è¡¨æ ¼"></a>å…«ã€è¡¨æ ¼</h2><p>ç›´æ¥çœ‹ä¾‹å­å§ï¼Œç¬¬äºŒè¡Œçš„ <code>---:</code> è¡¨ç¤ºäº†å¯¹é½æ–¹å¼ï¼Œé»˜è®¤<strong>å·¦å¯¹é½</strong>ï¼Œè¿˜æœ‰<strong>å³å¯¹é½</strong>å’Œ<strong>å±…ä¸­</strong></p><table><thead><tr><th>å•†å“</th><th>æ•°é‡</th><th>å•ä»·</th></tr></thead><tbody><tr><td>æ‰‹æœº</td><td>1</td><td>$1000</td></tr><tr><td>ç”µè„‘</td><td>1</td><td>$1999</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Markdownå¸¸ç”¨è¯­æ³•&quot;&gt;&lt;a href=&quot;#Markdownå¸¸ç”¨è¯­æ³•&quot; class=&quot;headerlink&quot; title=&quot;Markdownå¸¸ç”¨è¯­æ³•&quot;&gt;&lt;/a&gt;Markdownå¸¸ç”¨è¯­æ³•&lt;/h1&gt;&lt;hr&gt;
&lt;h2 id=&quot;ä¸€ã€æ ‡é¢˜&quot;&gt;&lt;a href=&quot;#ä¸€ã€æ ‡é¢˜</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>hexoæ­å»º</title>
    <link href="http://example.com/2020/12/30/hexo%E6%90%AD%E5%BB%BA/"/>
    <id>http://example.com/2020/12/30/hexo%E6%90%AD%E5%BB%BA/</id>
    <published>2020-12-29T16:02:17.000Z</published>
    <updated>2020-12-30T12:00:19.615Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Hexoæ­å»º"><a href="#Hexoæ­å»º" class="headerlink" title="Hexoæ­å»º"></a>Hexoæ­å»º</h3><hr><h4 id="1ã€å®‰è£…Node-js"><a href="#1ã€å®‰è£…Node-js" class="headerlink" title="1ã€å®‰è£…Node.js"></a>1ã€å®‰è£…Node.js</h4><p>â€ƒå®˜ç½‘ï¼š<a href="https://nodejs.org/zh-cn/">https://nodejs.org/zh-cn/</a></p><h4 id="2ã€å®‰è£…hexo"><a href="#2ã€å®‰è£…hexo" class="headerlink" title="2ã€å®‰è£…hexo"></a>2ã€å®‰è£…hexo</h4><p>cmdè¾“å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><h4 id="3ã€åˆ›å»ºhexoé¡¹ç›®"><a href="#3ã€åˆ›å»ºhexoé¡¹ç›®" class="headerlink" title="3ã€åˆ›å»ºhexoé¡¹ç›®"></a>3ã€åˆ›å»ºhexoé¡¹ç›®</h4><p>æ–°å»ºhexoæ–‡ä»¶å¤¹ï¼Œæ‰“å¼€git bashï¼Œä¸€æ­¥æ­¥è¾“å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;åˆå§‹åŒ–</span><br><span class="line">hexo init</span><br><span class="line">&#x2F;&#x2F;å®‰è£…ä¾èµ–</span><br><span class="line">npm install</span><br><span class="line">&#x2F;&#x2F;ç”Ÿæˆæ–‡ä»¶</span><br><span class="line">hexo g</span><br><span class="line">&#x2F;&#x2F;å¼€å¯æœåŠ¡</span><br><span class="line">hexo s</span><br><span class="line">&#x2F;&#x2F;æœ¬åœ°å¯åŠ¨</span><br><span class="line">http:&#x2F;&#x2F;localhost:4000</span><br></pre></td></tr></table></figure><h4 id="4ã€GitHubåˆ›å»ºä»“åº“"><a href="#4ã€GitHubåˆ›å»ºä»“åº“" class="headerlink" title="4ã€GitHubåˆ›å»ºä»“åº“"></a>4ã€GitHubåˆ›å»ºä»“åº“</h4><p>åœ¨githubä¸Šåˆ›å»ºä¸€ä¸ªå’Œä½ ç”¨æˆ·åç›¸åŒçš„ä»“åº“ï¼Œ<a href="http://åé¢åŠ .github.io/">åé¢åŠ .github.io</a></p><h4 id="5ã€å°†hexoéƒ¨ç½²åˆ°GitHub"><a href="#5ã€å°†hexoéƒ¨ç½²åˆ°GitHub" class="headerlink" title="5ã€å°†hexoéƒ¨ç½²åˆ°GitHub"></a>5ã€å°†hexoéƒ¨ç½²åˆ°GitHub</h4><p>æ‰“å¼€é¡¹ç›®æ ¹ç›®å½•é…ç½®æ–‡ä»¶ <code>_config.yml</code>ï¼Œç¿»åˆ°æœ€åï¼Œä¿®æ”¹ä¸ºå¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https:&#x2F;&#x2F;github.com&#x2F;YourgithubName&#x2F;YourgithubName.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>éœ€è¦å…ˆå®‰è£…deploy-gitéƒ¨ç½²å‘½ä»¤ï¼Œæ‰å¯ä»¥ç”¨å‘½ä»¤éƒ¨ç½²åˆ°GitHub</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hexo clean </span><br><span class="line">hexo generate  æˆ–è€…  hexo g</span><br><span class="line">hexo deploy   æˆ–è€…  hexo d</span><br><span class="line">&#x2F;&#x2F;å¦‚æœéœ€è¦æœ¬åœ°æ‰§è¡Œ</span><br><span class="line">hexo server æˆ–è€… hexo s</span><br></pre></td></tr></table></figure><hr><h4 id="ç¼–å†™åšå®¢"><a href="#ç¼–å†™åšå®¢" class="headerlink" title="ç¼–å†™åšå®¢"></a>ç¼–å†™åšå®¢</h4><p>è¿›å…¥hexoæ–‡ä»¶å¤¹ï¼Œæ‰“å¼€git bashè¾“å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new post åšå®¢åç§°</span><br></pre></td></tr></table></figure><p>ä¼šåœ¨sourceæ–‡ä»¶ä¸­ç”ŸæˆXXX.mdï¼Œé€šè¿‡Typoraæ‰“å¼€ç¼–è¾‘</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo g </span><br><span class="line">hexo d</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆå¹¶å‘å¸ƒ</p><p>æœ¬åœ° ï¼š<a href="http://localhost:4000/">http://localhost:4000</a></p><p>å¤–ç½‘ ï¼šhttps://ä½ çš„githubåå­—.github.io/</p><hr><h4 id="é…ç½®ä¸»é¢˜"><a href="#é…ç½®ä¸»é¢˜" class="headerlink" title="é…ç½®ä¸»é¢˜"></a>é…ç½®ä¸»é¢˜</h4><p>ç”¨æˆ‘çš„ä¸»é¢˜ä¸ºä¾‹ï¼šbutterfly</p><p>è¿›å…¥é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰“å¼€git bash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone -b master https:&#x2F;&#x2F;github.com&#x2F;jerryc127&#x2F;hexo-theme-butterfly.git themes&#x2F;butterfly</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æ ¹ç›®å½•é…ç½®æ–‡ä»¶_config.ymlï¼ŒæŠŠä¸»é¢˜æ”¹ä¸ºbutterfly</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme:  butterfly</span><br></pre></td></tr></table></figure><p>é‡åˆ°çš„é—®é¢˜ï¼šextends includes/layout.pug block content #recent-posts.recent-posts include includes/recent-posts.pug include includes/pagination.pug </p><p>è§£å†³æ–¹æ³•ï¼šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-renderer-jade hexo-generator-feed hexo-generator-sitemap hexo-browsersync hexo-generator-archive</span><br></pre></td></tr></table></figure><p>ç„¶å</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;æ¸…é™¤ç¼“å­˜</span><br><span class="line">hexo clean</span><br><span class="line">&#x2F;&#x2F;é‡æ–°ç”Ÿæˆé™æ€æ–‡ä»¶</span><br><span class="line">hexo g</span><br><span class="line">&#x2F;&#x2F;å‘å¸ƒ</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>å®Œæˆï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;Hexoæ­å»º&quot;&gt;&lt;a href=&quot;#Hexoæ­å»º&quot; class=&quot;headerlink&quot; title=&quot;Hexoæ­å»º&quot;&gt;&lt;/a&gt;Hexoæ­å»º&lt;/h3&gt;&lt;hr&gt;
&lt;h4 id=&quot;1ã€å®‰è£…Node-js&quot;&gt;&lt;a href=&quot;#1ã€å®‰è£…Node-js&quot; class=&quot;h</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>gitå¤§å…¨</title>
    <link href="http://example.com/2020/12/29/git%E5%A4%A7%E5%85%A8/"/>
    <id>http://example.com/2020/12/29/git%E5%A4%A7%E5%85%A8/</id>
    <published>2020-12-29T14:33:54.000Z</published>
    <updated>2020-12-29T14:41:15.878Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GITå‘½ä»¤ä½¿ç”¨å¤§å…¨"><a href="#GITå‘½ä»¤ä½¿ç”¨å¤§å…¨" class="headerlink" title="GITå‘½ä»¤ä½¿ç”¨å¤§å…¨"></a>GITå‘½ä»¤ä½¿ç”¨å¤§å…¨</h1><p>æŸ¥çœ‹é…ç½®ï¼šgit config -l</p><p>æŸ¥çœ‹ç³»ç»Ÿé…ç½®ï¼šgit config â€“system â€“-list</p><p>æŸ¥çœ‹å½“å‰ç”¨æˆ·ï¼ˆglobalï¼‰é…ç½®ï¼šgit config â€“global  â€“list</p><p>é…ç½®è´¦å·ï¼š</p><p> git config â€“global user.name â€œyour nameâ€<br> git config â€“global user.email â€œ<a href="mailto:&#x79;&#111;&#117;&#x72;&#x5f;&#101;&#x6d;&#97;&#x69;&#108;&#64;&#x79;&#x6f;&#117;&#x72;&#101;&#109;&#97;&#x69;&#x6c;&#46;&#x63;&#x6f;&#x6d;">&#x79;&#111;&#117;&#x72;&#x5f;&#101;&#x6d;&#97;&#x69;&#108;&#64;&#x79;&#x6f;&#117;&#x72;&#101;&#109;&#97;&#x69;&#x6c;&#46;&#x63;&#x6f;&#x6d;</a>â€œ</p><p>é…ç½®SSHï¼š</p><p>1.å¦‚æœæ²¡æœ‰SSH Keyï¼Œåˆ™éœ€è¦å…ˆç”Ÿæˆä¸€ä¸‹ï¼šssh-keygen -t rsa -C â€œæ³¨å†Œgithubçš„é‚®ç®±â€</p><p>2.æ‰§è¡Œä¹‹åç»§ç»­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥è·å–SSH Keyï¼šcd ~/.ssh</p><p>3.å¤åˆ¶å…¬é’¥åœ¨githubä¸­è®¾ç½®</p><p>4.éªŒè¯ï¼šssh -T <a href="mailto:&#x67;&#x69;&#116;&#64;&#103;&#105;&#116;&#x68;&#x75;&#x62;&#x2e;&#x63;&#111;&#x6d;">&#x67;&#x69;&#116;&#64;&#103;&#105;&#116;&#x68;&#x75;&#x62;&#x2e;&#x63;&#111;&#x6d;</a>     //è¿è¡Œç»“æœå‡ºç°ç±»ä¼¼å¦‚ä¸‹Hi ygsit! Youâ€™ve successfully authenticated, but GitHub does not provide shell access.</p><p><strong>æäº¤ä»£ç ï¼š</strong></p><p>æŸ¥çœ‹æ–‡ä»¶çŠ¶æ€ï¼šgit status</p><p>å…‹éš†ï¼šgit clone url</p><p>git status                                 æŸ¥çœ‹çŠ¶æ€<br>git add .                               æ·»åŠ åˆ°æš‚å­˜åŒº<br>git commit -m â€œæäº¤å†…å®¹æè¿°â€                æäº¤ä»£ç <br>git pull origin åˆ†æ”¯å                      æ›´æ–°ä»£ç ï¼ˆå½“åªæœ‰ä¸€ä¸ªåˆ†æ”¯çš„æ—¶å€™å¯ä»¥ç›´æ¥git pull)<br>git push origin åˆ†æ”¯å                   æäº¤åˆ°è¿œç¨‹ï¼ˆå½“åªæœ‰ä¸€ä¸ªåˆ†æ”¯çš„æ—¶å€™å¯ä»¥ç›´æ¥git pushï¼‰</p><p>$ git reset [file]            è¿˜åŸæš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œå¹¶ä¿å­˜ä¿®æ”¹</p><p>$ git reset â€“hard        è¿˜åŸæš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œå¹¶æŠŠåŸæ¥ä¿®æ”¹çš„åˆ é™¤</p><p>git commit â€“amend                                    ä¿®æ”¹æäº¤çš„æè¿°å†…å®¹ï¼ˆvimä¿®æ”¹ï¼‰</p><p>git commit â€“amend -m â€œæ–°æäº¤ä¿¡æ¯â€         ç›´æ¥ä¿®æ”¹æäº¤æè¿°å†…å®¹</p><p>git reset â€“soft head^1      è¿˜åŸæäº¤çš„æ–‡ä»¶ï¼Œå¹¶ä¿å­˜ä¿®æ”¹</p><p>git reset â€“hard head^1     è¿˜åŸæäº¤çš„æ–‡ä»¶ï¼Œå¹¶æŠŠåŸæ¥ä¿®æ”¹çš„åˆ é™¤</p><p><strong>git clone å’Œ git pull åŒºåˆ«ï¼šï¼ˆcloneæ‹‰å–ä»£ç ï¼Œpullæ›´æ–°ä»£ç ï¼‰</strong></p><p>git cloneï¼šä»è¿œç¨‹æœåŠ¡å™¨å…‹éš†ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„ç‰ˆæœ¬åº“åˆ°æœ¬åœ°,å¤åˆ¶çš„æ˜¯æ•´ä¸ªç‰ˆæœ¬åº“ï¼Œå«åšclone.ï¼ˆæ˜¯å°†æ•´ä¸ªå·¥ç¨‹å¤åˆ¶ä¸‹æ¥æ‰€ä»¥ï¼Œä¸éœ€è¦æœ¬åœ°æ˜¯ä»“åº“ï¼ˆæ²¡æœ‰.gitæ–‡ä»¶å¤¹ï¼‰ï¼‰</p><p>git pullï¼šä»è¿œç¨‹æœåŠ¡å™¨è·å–åˆ°ä¸€ä¸ªbranchåˆ†æ”¯çš„æ›´æ–°åˆ°æœ¬åœ°ï¼Œå¹¶æ›´æ–°æœ¬åœ°åº“ï¼Œå«åšpull.ï¼ˆæœ¬åœ°æœ‰ä»£ç ä¼šæ›´æ–°ï¼Œæ²¡æœ‰éœ€è¦å…ˆåˆå§‹åŒ–æœ¬åœ°æ–‡ä»¶å¤¹æ–‡ä¸€ä¸ªä»“åº“ï¼ˆgit initï¼‰ï¼‰</p><p><strong>å›é€€ç‰ˆæœ¬</strong>ï¼š</p><p>åœ¨ä¸€ä¸ªåˆ†æ”¯ä¸­</p><p>git reset â€“soft head~1   å›é€€å¹¶ä¿å­˜ä¿®æ”¹</p><p>git reset â€“hard head~1   å›é€€ä¸ä¿å­˜ä¿®æ”¹</p><p>1è¡¨ç¤ºå›é€€1ä¸ªç‰ˆæœ¬</p><p>2è¡¨ç¤ºå›é€€2ä¸ªç‰ˆæœ¬</p><p>å›é€€åˆ°æŸä¸ªç‰ˆæœ¬</p><p>git reset â€“soft 4e60fa983f23ff1ed5ec99f2c0cd4c4e4bf1e1d1ï¼ˆversion codeï¼‰</p><p>git reset â€“hard 4e60fa983f23ff1ed5ec99f2c0cd4c4e4bf1e1d1ï¼ˆversion codeï¼‰</p><p><strong>åˆ†æ”¯å‘½ä»¤ï¼š</strong></p><p>æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°åˆ†æ”¯ï¼šgit branch </p><p>æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹åˆ†æ”¯ï¼šgit branch -r</p><p>æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯ï¼šgit branch -a</p><p>åˆ›å»ºåˆ†æ”¯ï¼šgit branch åˆ†æ”¯å  ï¼ˆå¤åˆ¶å½“å‰åˆ†æ”¯åˆ°æ–°åˆ›å»ºçš„åˆ†æ”¯ï¼‰</p><p>åˆ‡æ¢åˆ†æ”¯ï¼šgit checkout åˆ†æ”¯å</p><p>åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªåˆ†æ”¯ï¼šgit checkout -</p><p>åˆ›å»ºå¹¶åˆ‡æ¢åˆ†æ”¯ï¼šgit checkout -b åˆ†æ”¯å ï¼ˆç›¸å½“äºåˆ›å»ºåˆ†æ”¯å’Œåˆ‡æ¢åˆ†æ”¯çš„ç»„åˆå‘½ä»¤ï¼‰</p><p>æäº¤æœ¬åœ°åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼šgit push origin æœ¬åœ°åˆ†æ”¯å</p><p>åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯ï¼šgit merge åˆ†æ”¯å</p><p>åˆ é™¤æœ¬åœ°åˆ†æ”¯ï¼šgit branch -d æœ¬åœ°åˆ†æ”¯å ï¼ˆåˆ é™¤åˆ†æ”¯å¿…é¡»ä¸åœ¨æ­¤åˆ†æ”¯ä¸‹ï¼Œåˆ é™¤æœ¬åœ°åˆ†æ”¯åå†åˆ‡æ¢åˆ°è¯¥åˆ é™¤çš„åˆ†æ”¯ï¼Œä¼šä»è¿œç¨‹æ‹‰å–å¹¶è‡ªåŠ¨åˆ›å»ºæœ¬åœ°åˆ†æ”¯ï¼‰</p><p>åˆ é™¤è¿œç¨‹åˆ†æ”¯ï¼šgit push origin â€“delete è¿œç¨‹åˆ†æ”¯å</p><p><strong>å†²çª</strong>ï¼š</p><p>åˆ«äººåœ¨æ›´æ–°ä»£ç  pushå†²çªæ—¶  å…ˆpullä¸€ä¸‹</p><p>git pull å‡ºç°viç¼–è¾‘æ—¶ æŒ‰esc è·³åˆ°å‘½ä»¤æ¨¡å¼shift+ :wq!(ä¿å­˜å¼ºåˆ¶é€€å‡º) </p><p>å¦‚è¿‡mergeæˆåŠŸ gitç•Œé¢æ— å¼‚å¸¸   å¦è€…éœ€è¦è§£å†³å†²çª</p><p><strong>å…³è”è¿œç¨‹ä»“åº“</strong>ï¼š</p><p>git init</p><p>git add .</p><p>git commit -m â€œFirst commitâ€</p><p>git remote add origin è¿œç¨‹ä»“åº“è·¯å¾„(<a href="https://github.com/ygsit/test.git">https://github.com/ygsit/test.git</a>)</p><p>git push origin masteræˆ–è€…git push -u origin master(åŠ äº†-uï¼Œè¡¨ç¤ºåé¢æäº¤å¯ä»¥ç”¨git pushä»£æ›¿git push origin master)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;GITå‘½ä»¤ä½¿ç”¨å¤§å…¨&quot;&gt;&lt;a href=&quot;#GITå‘½ä»¤ä½¿ç”¨å¤§å…¨&quot; class=&quot;headerlink&quot; title=&quot;GITå‘½ä»¤ä½¿ç”¨å¤§å…¨&quot;&gt;&lt;/a&gt;GITå‘½ä»¤ä½¿ç”¨å¤§å…¨&lt;/h1&gt;&lt;p&gt;æŸ¥çœ‹é…ç½®ï¼šgit config -l&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ç³»ç»Ÿé…ç½®ï¼šgit confi</summary>
      
    
    
    
    
  </entry>
  
</feed>
